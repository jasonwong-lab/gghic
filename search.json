[{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://jasonwong-lab.github.io/gghic/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"vignette demonstrates analyze Hi-C pairs data find optimal genomic resolutions using gghic’s resolution depth functions. ’ll learn : Calculate contact depth different bin sizes Assess genome coverage across resolutions Find optimal resolution balances detail completeness Visualize tradeoffs resolution coverage","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"when-to-use-these-functions","dir":"Articles","previous_headings":"Overview","what":"When to Use These Functions","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"functions essential : Pore-C & long-read data: Determining best resolution long DNA-DNA interactions Hi-C QC: Assessing data quality sequencing depth Resource planning: Finding sweet spot expensive downstream analysis Publication standards: Communicating data completeness reviewers","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting Started","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Load required libraries:","code":"load_pkg <- function(pkgs) {   for (pkg in pkgs) suppressMessages(require(pkg, character.only = TRUE)) }  load_pkg(c(\"readr\", \"dplyr\", \"rappdirs\", \"gghic\")) #> Warning in library(package, lib.loc = lib.loc, character.only = TRUE, #> logical.return = TRUE, : there is no package called 'readr'"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"example-data","dir":"Articles","previous_headings":"Getting Started","what":"Example Data","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"’ll create synthetic pairs data demonstration. practice, load contact matrix file: Expected column format: read_name: Unique identifier interaction chrom1, chrom2: Chromosome names (e.g., “chr1”) pos1, pos2: Genomic positions base pairs Optional: strand, mapping quality, fragment ID (ignored analysis functions)","code":"# Create example pairs dataset set.seed(42) n_interactions <- 10000  pairs <- data.frame(   read_name = paste0(\"read_\", seq_len(n_interactions)),   chrom1 = sample(c(\"chr1\", \"chr2\", \"chr3\"), n_interactions, replace = TRUE),   pos1 = sample(1e6:10e6, n_interactions, replace = TRUE),   chrom2 = sample(c(\"chr1\", \"chr2\", \"chr3\"), n_interactions, replace = TRUE),   pos2 = sample(1e6:10e6, n_interactions, replace = TRUE) )  glimpse(pairs) #> Rows: 10,000 #> Columns: 5 #> $ read_name <chr> \"read_1\", \"read_2\", \"read_3\", \"read_4\", \"read_5\", \"read_6\", … #> $ chrom1    <chr> \"chr1\", \"chr1\", \"chr1\", \"chr1\", \"chr2\", \"chr2\", \"chr2\", \"chr… #> $ pos1      <int> 7501652, 9834771, 7511178, 9988046, 2376108, 8056778, 991689… #> $ chrom2    <chr> \"chr3\", \"chr1\", \"chr1\", \"chr2\", \"chr1\", \"chr2\", \"chr3\", \"chr… #> $ pos2      <int> 4068533, 1789229, 6896113, 6916211, 7349759, 9964631, 150451…"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"choosing-your-approach","dir":"Articles","previous_headings":"","what":"Choosing Your Approach","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"gghic package provides two complementary approaches analyzing pairs data: -Memory Processing (Smaller Files) - Load entire dataset memory - Single file read (fastest) - Typical memory: ~4 bytes per interaction - Best : Interactive exploration, visualization Chunked Streaming (Large Files) - Read file streaming fashion - Minimal memory footprint (~100 MB even 100 GB files) - C-accelerated file /O - Automatic gzip decompression - Best : Production pipelines, server environments, large datasets Decision Rule: file size > available RAM / 2, use chunked functions.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"step-1-calculate-resolution-depth","dir":"Articles","previous_headings":"","what":"Step 1: Calculate Resolution Depth","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"calculateResolutionDepth() function bins genomic positions counts unique interactions per bin: returns: chrom: Chromosome name bin: Bin number (position / bin_size, rounded ) count: Number unique interactions bin Interpreting results: High counts = well-sequenced regions Low counts = sparse unmappable regions Zero-count bins = gaps (excluded output)","code":"# Calculate depth at 10kb resolution depth_10kb <- calculateResolutionDepth(pairs, bin_size = 10000)  depth_10kb #> # A tibble: 2,699 × 3 #>    chrom   bin count #>    <chr> <int> <int> #>  1 chr1    845    12 #>  2 chr2    812     6 #>  3 chr3    779     7 #>  4 chr1    846     7 #>  5 chr2    813     6 #>  6 chr3    780     4 #>  7 chr1    847     7 #>  8 chr3    781     8 #>  9 chr2    814     6 #> 10 chr1    848     9 #> # ℹ 2,689 more rows # Summary statistics summary(depth_10kb$count) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>    1.00    5.00    7.00    7.41    9.00   19.00"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"step-2-assess-genome-coverage","dir":"Articles","previous_headings":"","what":"Step 2: Assess Genome Coverage","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"calculateGenomeCoverage() function determines fraction bins meet minimum contact threshold: Interpreting coverage: High coverage (>80%) small bins: Well-sequenced, good resolution potential Low coverage (<50%) large bins: Sparse data, may need deeper sequencing Coverage curve shape: Shows sequencing depth data quality","code":"# Calculate coverage at multiple resolutions resolutions <- c(5e3, 10e3, 25e3, 50e3, 100e3, 500e3)  coverage_df <- data.frame(   resolution_kb = resolutions / 1e3,   n_bins = NA,   coverage = NA )  for (i in seq_along(resolutions)) {   depth <- calculateResolutionDepth(pairs, resolutions[i])   coverage_df$n_bins[i] <- nrow(depth)   coverage_df$coverage[i] <- calculateGenomeCoverage(     pairs, resolutions[i],     min_contacts = 50   ) }  coverage_df$coverage_pct <- sprintf(\"%.1f%%\", coverage_df$coverage * 100)  coverage_df #>   resolution_kb n_bins   coverage coverage_pct #> 1             5   5273 0.00000000         0.0% #> 2            10   2699 0.00000000         0.0% #> 3            25   1080 0.00000000         0.0% #> 4            50    540 0.02777778         2.8% #> 5           100    270 0.99629630        99.6% #> 6           500     54 1.00000000       100.0%"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"step-3-find-optimal-resolution","dir":"Articles","previous_headings":"","what":"Step 3: Find Optimal Resolution","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Use binary search find smallest bin size achieving target coverage: works: Binary search across bin size range Tests candidate bin size Returns smallest bin meets target coverage Typically completes 10-15 iterations Pro tip: Start target_coverage = 0.8 (80%). Adjust based analysis needs.","code":"# Find resolution with ~80% coverage optimal_bin <- findOptimalResolution(   pairs,   min_bin = 1e3, # Start at 1 Kb   max_bin = 1e6, # Search up to 1 Mb   target_coverage = 0.8,   min_contacts = 50 ) #> Iteration 1: Testing bin size 500,500 bp: 98.18% coverage #> Iteration 2: Testing bin size 250,749 bp: 97.30% coverage #> Iteration 3: Testing bin size 125,874 bp: 97.72% coverage #> Iteration 4: Testing bin size 63,436 bp: 36.60% coverage #> Iteration 5: Testing bin size 94,655 bp: 97.92% coverage #> Iteration 6: Testing bin size 79,045 bp: 88.41% coverage #> Iteration 7: Testing bin size 71,240 bp: 64.83% coverage #> Iteration 8: Testing bin size 75,142 bp: 77.13% coverage #> Iteration 9: Testing bin size 77,093 bp: 83.85% coverage #> Iteration 10: Testing bin size 76,117 bp: 81.23% coverage #> Iteration 11: Testing bin size 75,629 bp: 78.61% coverage #> Iteration 12: Testing bin size 75,873 bp: 81.23% coverage #> Iteration 13: Testing bin size 75,751 bp: 79.55% coverage #> Iteration 14: Testing bin size 75,812 bp: 79.27% coverage #> Iteration 15: Testing bin size 75,842 bp: 80.67% coverage #> Iteration 16: Testing bin size 75,827 bp: 80.39% coverage #> Iteration 17: Testing bin size 75,819 bp: 79.83% coverage #> Iteration 18: Testing bin size 75,823 bp: 80.11% coverage #> Iteration 19: Testing bin size 75,821 bp: 79.55% coverage #> Iteration 20: Testing bin size 75,822 bp: 79.55% coverage  cat(sprintf(   \"Optimal bin size: %d bp (%.1f Kb)\\n\", optimal_bin, optimal_bin / 1000 )) #> Optimal bin size: 75823 bp (75.8 Kb)  # Verify the result actual_coverage <- calculateGenomeCoverage(   pairs, optimal_bin,   min_contacts = 50 ) cat(sprintf(\"Actual coverage: %.2f%%\\n\", actual_coverage * 100)) #> Actual coverage: 80.11%"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"step-4-visualize-coverage-distribution","dir":"Articles","previous_headings":"","what":"Step 4: Visualize Coverage Distribution","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Create boxplot showing contact counts vary across resolutions: Distribution contacts per bin different resolutions look : Widening boxes: Decreasing contacts larger bins (expected) Outliers (dots): Unusually enriched regions (e.g., centromeres, pericentromeres) Median position: Typical coverage resolution Whisker length: Range contact values (high whiskers = variable coverage)","code":"plotResolutionCoverage(   pairs,   bin_sizes = c(5e3, 10e3, 25e3, 50e3, 100e3, 500e3),   min_contacts = 50,   title = \"Contact Distribution by Resolution\" )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"step-5-plot-coverage-vs-resolution","dir":"Articles","previous_headings":"","what":"Step 5: Plot Coverage vs Resolution","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Create line plot showing coverage changes resolution: Genome coverage function bin size Curve interpretation: Sharp drop small bins: Limited sequencing depth Plateau region: additional bin size doesn’t improve coverage much “Knee” curve: optimal resolution sweet spot Steep regions: Good resolution potential bin size","code":"plotCoverageCurve(   pairs,   bin_sizes = c(5e3, 10e3, 25e3, 50e3, 100e3, 500e3, 1e6),   min_contacts = 50,   title = \"Coverage vs Resolution\" )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"processing-large-files-100-gb","dir":"Articles","previous_headings":"","what":"Processing Large Files (100 GB+)","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"⚠️ Note: code examples section provided reference executed vignette. files don’t fit R memory, use _chunked variants stream file C-level /O:","code":"# Download example file with caching cache_dir <- rappdirs::user_cache_dir(\"gghic\") dir.create(cache_dir, recursive = TRUE, showWarnings = FALSE)  pairs_file <- file.path(cache_dir, \"test.txt.gz\") download_url <- \"https://www.dropbox.com/scl/fi/yc4axg1mf2i9zylg3d0oe/test.txt.gz?rlkey=sdsdhsnixo01koo38d242y4c8&st=t4rn0js0&dl=1\"  if (!file.exists(pairs_file)) {   message(\"Downloading test data to cache directory...\")   download.file(     download_url, pairs_file,     method = \"auto\", quiet = TRUE   )   message(\"Downloaded to: \", pairs_file) } else {   message(\"Using cached file: \", pairs_file) }"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"approach-1-direct-file-reading-simple-but-slower","dir":"Articles","previous_headings":"Processing Large Files (100 GB+)","what":"Approach 1: Direct File Reading (Simple but Slower)","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Read file time function called: Problem: 10 GB file, ’re reading 10 GB three times (30 GB total /O)!","code":"# Each function reads the file independently opt_bin <- findOptResChunked(   pairs_file = pairs_file,   min_bin = 1e3,   max_bin = 5e4,   target_coverage = 0.8,   min_contacts = 1000 )  # Reads file again coverage <- calcGenomeCovChunked(   pairs_file = pairs_file,   bin_size = opt_bin,   min_contacts = 1000 )  # Reads file again depth <- calcResDepthChunked(   pairs_file = pairs_file,   bin_size = opt_bin )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"approach-2-cache-once-reuse-many-times-fastest","dir":"Articles","previous_headings":"Processing Large Files (100 GB+)","what":"Approach 2: Cache Once, Reuse Many Times (FASTEST!)","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Read file C memory, reuse cached data: Performance: 10 GB file: - Without cache: ~30 seconds × 3 operations = 90 seconds - cache: ~30 seconds () + ~0.1 seconds × operations = 30 seconds 3x faster! speedup increases operations.","code":"# 1. READ FILE INTO C MEMORY ONCE ---- # This takes time initially but creates a persistent cache cache <- readPairsCache(pairs_file) cat(\"File loaded into C memory cache\\n\")  # 2. FIND OPTIMAL RESOLUTION (using cache) ---- # This is now instant - no file I/O! opt_bin <- findOptResChunked(   cache = cache,   min_bin = 1e3,   max_bin = 5e4,   target_coverage = 0.8,   min_contacts = 1000 ) cat(\"Optimal resolution:\", opt_bin / 1e3, \"Kb\\n\")  # 3. CHECK COVERAGE (using cache) ---- # Also instant! coverage <- calcGenomeCovChunked(   cache = cache,   bin_size = opt_bin,   min_contacts = 1000 ) cat(\"Coverage:\", sprintf(\"%.1f%%\\n\", coverage * 100))  # 4. EXTRACT BINNED DEPTHS (using cache) ---- # Still instant! depth <- calcResDepthChunked(   cache = cache,   bin_size = opt_bin )  # 5. TRY DIFFERENT BIN SIZES (no additional I/O!) ---- depth_5kb <- calcResDepthChunked(cache = cache, bin_size = 5000) depth_10kb <- calcResDepthChunked(cache = cache, bin_size = 10000) depth_50kb <- calcResDepthChunked(cache = cache, bin_size = 50000)  # Cache is automatically freed when removed or R session ends rm(cache) gc()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"approach-3-get-cache-from-findoptreschunked","dir":"Articles","previous_headings":"Processing Large Files (100 GB+)","what":"Approach 3: Get Cache from findOptResChunked","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Let findOptResChunked() return cache subsequent use:","code":"# Find optimal resolution and get cache back result <- findOptResChunked(   pairs_file = pairs_file,   min_bin = 1e3,   max_bin = 5e4,   target_coverage = 0.8,   min_contacts = 1000,   return_cache = TRUE # Get the cache back! )  # Extract results opt_bin <- result$bin_size cache <- result$cache  cat(\"Optimal resolution:\", opt_bin / 1e3, \"Kb\\n\")  # Now reuse the cache for other operations coverage <- calcGenomeCovChunked(   cache = cache,   bin_size = opt_bin,   min_contacts = 1000 )  depth <- calcResDepthChunked(   cache = cache,   bin_size = opt_bin )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"when-to-use-each-approach","dir":"Articles","previous_headings":"Processing Large Files (100 GB+)","what":"When to Use Each Approach","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Rule thumb: ’ll call one chunked function, use cache!","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"what-the-coverage-curve-tells-you","dir":"Articles","previous_headings":"Interpreting Your Results","what":"What the Coverage Curve Tells You","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Sharp drop small bins - Data sparse high resolution - Limited sequencing depth short reads - Consider deeper sequencing larger bins Plateau region - Coverage maxes (can’t improve increasing bin size) - Indicates natural sequencing depth ceiling - Optimal resolution likely transition point High coverage large bins (>80%) - Well-sequenced dataset - Can use smaller bins safely - Good candidate publication-quality analysis Low coverage large bins (<50%) - Sparse data - May need additional sequencing - Consider quality filtering","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"choosing-target-coverage","dir":"Articles","previous_headings":"Interpreting Your Results","what":"Choosing Target Coverage","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Exploration: 50-60% (quick, uses fewer bins) Standard analysis: 75-85% (good balance) Publication: 85-90%+ (stringent) Higher coverage = higher confidence requires sequencing.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"’ve found optimal resolution, explore gghic functions visualization: geom_hic(): Create interaction scatter plots geom_loop(): Highlight chromatin loops geom_tad(): Show topologically associating domains geom_ideogram(): Add chromosome context theme_hic(): Specialized theme Hi-C plots See main gghic vignette complete examples.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"faq","dir":"Articles","previous_headings":"","what":"FAQ","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"Q: coverage decrease larger bins? : definition—larger bins aggregate positions contact counts don’t increase proportionally. Coverage measures fraction bins sufficient contacts. Q: use chunked functions small files? : , use -memory functions—’re simpler faster files fit RAM. Q: Can use functions non-Hi-C data? : Yes, “pairs” data (chrom, position) coordinates works: Pore-C, 4C, 5C, etc.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/depth.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Resolution Depth Analysis for Hi-C/-like Data","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] gghic_0.2.1    rappdirs_0.3.3 dplyr_1.1.4    #>  #> loaded via a namespace (and not attached): #>  [1] SummarizedExperiment_1.40.0 gtable_0.3.6                #>  [3] rjson_0.2.23                xfun_0.55                   #>  [5] bslib_0.9.0                 ggplot2_4.0.1               #>  [7] htmlwidgets_1.6.4           rhdf5_2.54.1                #>  [9] Biobase_2.70.0              lattice_0.22-7              #> [11] bitops_1.0-9                rhdf5filters_1.22.0         #> [13] vctrs_0.6.5                 tools_4.5.2                 #> [15] generics_0.1.4              parallel_4.5.2              #> [17] stats4_4.5.2                curl_7.0.0                  #> [19] tibble_3.3.0                pkgconfig_2.0.3             #> [21] Matrix_1.7-4                RColorBrewer_1.1-3          #> [23] cigarillo_1.0.0             S7_0.2.1                    #> [25] desc_1.4.3                  S4Vectors_0.48.0            #> [27] lifecycle_1.0.4             compiler_4.5.2              #> [29] farver_2.1.2                Rsamtools_2.26.0            #> [31] Biostrings_2.78.0           textshaping_1.0.4           #> [33] codetools_0.2-20            Seqinfo_1.0.0               #> [35] InteractionSet_1.38.0       htmltools_0.5.9             #> [37] sass_0.4.10                 RCurl_1.98-1.17             #> [39] yaml_2.3.12                 tidyr_1.3.2                 #> [41] crayon_1.5.3                pillar_1.11.1               #> [43] pkgdown_2.2.0               jquerylib_0.1.4             #> [45] BiocParallel_1.44.0         DelayedArray_0.36.0         #> [47] cachem_1.1.0                abind_1.4-8                 #> [49] tidyselect_1.2.1            digest_0.6.39               #> [51] purrr_1.2.0                 restfulr_0.0.16             #> [53] labeling_0.4.3              fastmap_1.2.0               #> [55] grid_4.5.2                  cli_3.6.5                   #> [57] SparseArray_1.10.8          magrittr_2.0.4              #> [59] S4Arrays_1.10.1             utf8_1.2.6                  #> [61] dichromat_2.0-0.1           XML_3.99-0.20               #> [63] withr_3.0.2                 scales_1.4.0                #> [65] rmarkdown_2.30              XVector_0.50.0              #> [67] httr_1.4.7                  matrixStats_1.5.0           #> [69] ragg_1.5.0                  evaluate_1.0.5              #> [71] knitr_1.51                  BiocIO_1.20.0               #> [73] GenomicRanges_1.62.1        IRanges_2.44.0              #> [75] rtracklayer_1.70.1          rlang_1.1.6                 #> [77] Rcpp_1.1.0                  glue_1.8.0                  #> [79] BiocGenerics_0.56.0         jsonlite_2.0.0              #> [81] R6_2.6.1                    Rhdf5lib_1.32.0             #> [83] GenomicAlignments_1.46.0    MatrixGenerics_1.22.0       #> [85] systemfonts_1.3.1           fs_1.6.6"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing 3D Genome Organization with gghic","text":"gghic R package creating publication-ready visualizations 3D genome organization data. seamlessly integrates Hi-C contact maps, topologically associating domains (TADs), chromatin loops, gene annotations, genomic tracks unified, customizable plots.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"why-gghic","dir":"Articles","previous_headings":"Introduction","what":"Why gghic?","title":"Visualizing 3D Genome Organization with gghic","text":"Easy use: Simple, intuitive syntax sensible defaults quick plotting Flexible: Choose high-level gghic() wrapper low-level geom_* layers fine control Memory efficient: Smart focus mechanism loads genomic regions need Publication-ready: High-quality figures minimal code Extensible: Built ggplot2 ecosystem—use standard ggplot2 functions customization","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"key-features","dir":"Articles","previous_headings":"Introduction","what":"Key Features","title":"Visualizing 3D Genome Organization with gghic","text":"ChromatinContacts S4 class: Robust object-oriented framework managing Hi-C/-like data Flexible focusing: Efficiently subset genomic regions loading data Feature integration: Seamlessly combine TADs, loops, genes, signal tracks Multiple visualization modes: Single chromosome, multi-chromosome, inter-chromosomal, multi-way contacts Hypergraph analysis: Specialized tools visualizing Pore-C/-like multi-way chromatin interactions Resources: arXiv preprint GitHub repository Depth resolution vignette Hi-C/-like data quality assessment Hypergraph vignette Pore-C/-like multi-way contact analysis","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"typical-workflow","dir":"Articles","previous_headings":"Introduction","what":"Typical Workflow","title":"Visualizing 3D Genome Organization with gghic","text":"Load data: Create ChromatinContacts object Cooler files Focus: Specify genomic regions interest (optional recommended) Import: Load interaction data memory Add features: Attach TADs, loops, genes, tracks (optional) Visualize: Use gghic() wrapper custom ggplot2 layers Customize: Refine standard ggplot2 functions themes","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"load-required-packages","dir":"Articles","previous_headings":"Getting Started","what":"Load Required Packages","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"load_pkg <- function(pkgs) {   for (pkg in pkgs) suppressMessages(require(pkg, character.only = TRUE)) }  load_pkg(   c(\"ggplot2\", \"dplyr\", \"GenomicRanges\", \"InteractionSet\", \"gghic\") )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"download-example-data","dir":"Articles","previous_headings":"Getting Started","what":"Download Example data","title":"Visualizing 3D Genome Organization with gghic","text":"example data files hosted gghic-data repository. function downloads files local cache:","code":"download_example_files <- function(cache_dir, check_exists = TRUE) {   if (!dir.exists(cache_dir)) dir.create(cache_dir, recursive = TRUE)    files <- list(     \"chr4_11-100kb.cool\" = \"cooler/chr4_11-100kb.cool\",     \"chr4_11-5kb.cool\" = \"cooler/chr4_11-5kb.cool\",     \"track1.bigWig\" = \"bigwig/track1.bigWig\",     \"track2.bigWig\" = \"bigwig/track2.bigWig\",     \"gencode-chr4_11.gtf.gz\" = \"gtf/gencode-chr4_11.gtf.gz\",     \"TADs_500kb-chr4_11.tsv\" = \"tad/TADs_500kb-chr4_11.tsv\",     \"loops-chr4_11.txt\" = \"loop/loops-chr4_11.txt\",     \"gis_hic.rds\" = \"multiway/gis_hic.rds\",     \"concatemers.rds\" = \"multiway/concatemers.rds\"   )    url_base <- \"https://raw.githubusercontent.com/mhjiang97/gghic-data/master/\"    for (file_name in names(files)) {     file_path <- file.path(cache_dir, file_name)     if (check_exists && file.exists(file_path)) next     message(\"Downloading \", file_name, \"...\")     download.file(       paste0(url_base, files[[file_name]]), file_path,       method = \"curl\", quiet = TRUE     )   } } # Define a cache directory and download the files dir_cache <- file.path(\"..\", \"data\") download_example_files(dir_cache)  # Set up paths to the downloaded files path_cf_100 <- file.path(dir_cache, \"chr4_11-100kb.cool\") path_cf_5 <- file.path(dir_cache, \"chr4_11-5kb.cool\") path_gtf <- file.path(dir_cache, \"gencode-chr4_11.gtf.gz\") paths_track <- file.path(dir_cache, paste0(\"track\", 1:2, \".bigWig\")) path_tad <- file.path(dir_cache, \"TADs_500kb-chr4_11.tsv\") path_loop <- file.path(dir_cache, \"loops-chr4_11.txt\") path_gis_hic <- file.path(dir_cache, \"gis_hic.rds\") path_concatemers <- file.path(dir_cache, \"concatemers.rds\")"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"understanding-chromatincontacts","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects","what":"Understanding ChromatinContacts","title":"Visualizing 3D Genome Organization with gghic","text":"ChromatinContacts object central data structure gghic. acts lightweight pointer Hi-C data (Cooler files), storing resolution sequence information without loading massive interaction matrix memory immediately. key feature focus argument. allows specify chromosomes regions interest importing data. use focus? Speed: reads relevant parts Hi-C matrix. Memory Efficiency: Prevents loading genome-wide matrices need specific locus.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"no-focus-genome-wide","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects","what":"No Focus (Genome-Wide)","title":"Visualizing 3D Genome Organization with gghic","text":"Without focus, object references entire genome:","code":"cc_100_all <- ChromatinContacts(cooler_path = path_cf_100) cc_100_all #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: genome-wide #> Interactions: not loaded (use import() to load) #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"focusing-on-specific-regions","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects","what":"Focusing on Specific Regions","title":"Visualizing 3D Genome Organization with gghic","text":"focus argument accepts flexible region specifications. recommended approach working large Hi-C datasets.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"single-region-or-chromosome","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects > Focusing on Specific Regions","what":"Single Region or Chromosome","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"# Focus on entire chromosome (includes all intra-chromosomal interactions) cc_chr11 <- ChromatinContacts(cooler_path = path_cf_100, focus = \"chr11\") cc_chr11 #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #> Interactions: not loaded (use import() to load) #> -------------------------------------------------- # Focus on specific 10 Mb region cc_chr11_region <- ChromatinContacts(   cooler_path = path_cf_100, focus = \"chr11:60000000-70000000\" ) cc_chr11_region #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:60,000,000:70,000,000 <-> chr11:60,000,000:70,000,000 #> Interactions: not loaded (use import() to load) #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"multiple-regions-with-operators","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects > Focusing on Specific Regions","what":"Multiple Regions with Operators","title":"Visualizing 3D Genome Organization with gghic","text":"Use | () multiple regions & () inter-regional interactions:","code":"# Multiple chromosomes # Returns: chr4-chr4, chr11-chr11, AND chr4-chr11 interactions cc_multi <- ChromatinContacts(   cooler_path = path_cf_100, focus = \"chr4 | chr11\" ) cc_multi #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: 3 regions #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #>   [2] chr11:1:135,006,516 <-> chr4:1:191,154,276 #>   [3] chr4:1:191,154,276 <-> chr4:1:191,154,276 #> Interactions: not loaded (use import() to load) #> -------------------------------------------------- # Inter-chromosomal interactions ONLY (no intra-chromosomal) cc_inter <- ChromatinContacts(   cooler_path = path_cf_100,   focus = \"chr4:10000000-15000000 & chr11:60000000-65000000\" ) cc_inter #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:60,000,000:65,000,000 <-> chr4:10,000,000:15,000,000 #> Interactions: not loaded (use import() to load) #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"complex-focus-patterns","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects > Focusing on Specific Regions","what":"Complex Focus Patterns","title":"Visualizing 3D Genome Organization with gghic","text":"Combine operators sophisticated queries: 💡 Practical Tips: Use focus working genome-wide data files (saves time memory) exploratory analysis, start whole chromosome, zoom regions Use & operator specifically studying trans-chromosomal interactions Combine focusing subsetting (next section) iterative analysis","code":"# Example 1: Multiple intra-chromosomal + one trans-chromosomal # Returns: chr1-chr1, chr2-chr2, chr3-chr3, chr1-chr2, chr1-chr3, chr2-chr3, AND chr4-chr5 focus_complex <- c(\"chr1 | chr2 | chr3\", \"chr4 & chr5\") # Example 2: Specific regions with trans interactions focus <- c(   \"chr1:1000000-5000000 | chr2:3000000-8000000\",   \"chr3:10000000-15000000 & chr4:20000000-25000000\" )  # Example 3: Multiple trans-chromosomal pairs focus <- c(\"chr1 & chr2\", \"chr3 & chr4\", \"chr5 & chr6\")"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-ginteractions-objects","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Creating ChromatinContacts Objects > Focusing on Specific Regions","what":"Using GInteractions Objects","title":"Visualizing 3D Genome Organization with gghic","text":"programmatic region definition (useful pipelines):","code":"# Create a GInteractions object to specify the focus focus_gi <- suppressWarnings(InteractionSet::GInteractions(   GenomicRanges::GRanges(\"chr4:10000000-12000000\"),   GenomicRanges::GRanges(\"chr11:61000000-63000000\") ))  cc_gis_focus <- ChromatinContacts(   cooler_path = path_cf_100,   focus = focus_gi ) cc_gis_focus #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr4:10,000,000:12,000,000 <-> chr11:61,000,000:63,000,000 #> Interactions: not loaded (use import() to load) #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"import-interaction-data","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects","what":"Import Interaction Data","title":"Visualizing 3D Genome Organization with gghic","text":"creating object, use import() load actual data:","code":"cc_100 <- import(cc_100_all) cc_100 #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: genome-wide #> Interactions: 1,150,956 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> -------------------------------------------------- # Chain operations with pipe operator cc_5 <- ChromatinContacts(cooler_path = path_cf_5) |>   import() cc_5 #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-5kb.cool #> Resolution: 5,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: genome-wide #> Interactions: 4,825,031 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-genomic-features","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects","what":"Adding Genomic Features","title":"Visualizing 3D Genome Organization with gghic","text":"Attach genomic features (TADs, loops, tracks) ChromatinContacts object integrated visualization. Key Benefits: Automatic synchronization: Features automatically subsetted zoom change regions Consistent context: features stay aligned contact map Simplified plotting: Pass single object gghic() instead managing multiple data sources","code":"# Load TADs, loops, and tracks from files tads <- rtracklayer::import(path_tad, format = \"bed\") loops <- path_loop |>   rtracklayer::import(format = \"bedpe\") |>   makeGInteractionsFromGRangesPairs() tracks <- paths_track |>   purrr::map(rtracklayer::import) |>   setNames(paste0(\"track\", seq_along(paths_track))) |>   GenomicRanges::GRangesList()  # Add features to the ChromatinContacts object features(cc_100, \"TADs\") <- tads features(cc_100, \"loops\") <- loops features(cc_100, \"tracks\") <- tracks  cc_100 #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: genome-wide #> Interactions: 1,150,956 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 245 regions #>   Loops: 255 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 2,403,441 ranges #>     [2] track2: 1,884,707 ranges #> -------------------------------------------------- features(cc_5, \"TADs\") <- tads features(cc_5, \"loops\") <- loops features(cc_5, \"tracks\") <- tracks"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"manipulating-chromatincontacts-objects","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects","what":"Manipulating ChromatinContacts Objects","title":"Visualizing 3D Genome Organization with gghic","text":"ChromatinContacts objects support flexible subsetting data import. useful : Iterative exploration: Start broad, zoom interesting regions Comparative analysis: Extract region multiple samples Quality filtering: Remove low-quality extreme-valued interactions Automatic updates: Subsetting filters interactions updates: Associated features (TADs, loops, tracks) focus slot (tracks current genomic context) Sequence information (seqinfo)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"subsetting-by-genomic-regions-character","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Manipulating ChromatinContacts Objects","what":"Subsetting by Genomic Regions (character)","title":"Visualizing 3D Genome Organization with gghic","text":"intuitive way subset providing character string representing genomic region:","code":"# Subset to keep only interactions on chromosome 11 cc_chr11 <- cc_100[\"chr11\"] cc_chr11 #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #> Interactions: 328,865 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 107 regions #>   Loops: 134 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 1,332,687 ranges #>     [2] track2: 985,360 ranges #> -------------------------------------------------- # Subset to a specific 20 Mb region on chromosome 4 cc_chr4_sub <- cc_100[\"chr4:20000000-40000000\"] cc_chr4_sub #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr4:1:191,154,276 <-> chr4:1:191,154,276 #> Interactions: 17,012 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 17 regions #>   Loops: 7 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 111,157 ranges #>     [2] track2: 89,885 ranges #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"subsetting-with-granges","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Manipulating ChromatinContacts Objects","what":"Subsetting with GRanges","title":"Visualizing 3D Genome Organization with gghic","text":"can use GRanges object subset interactions least one anchor overlaps given ranges:","code":"# Define a region of interest roi <- GenomicRanges::GRanges(\"chr11:60000000-70000000\")  # Subset the ChromatinContacts object cc_gr_sub <- cc_100[roi] cc_gr_sub #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #> Interactions: 4,215 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 8 regions #>   Loops: 58 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 299,741 ranges #>     [2] track2: 165,088 ranges #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"subsetting-with-ginteractions","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Manipulating ChromatinContacts Objects","what":"Subsetting with GInteractions","title":"Visualizing 3D Genome Organization with gghic","text":"select specific set interactions, can subset using GInteractions object. keep interactions ChromatinContacts object overlap query GInteractions:","code":"# Define a specific inter-chromosomal interaction to query query_gi <- InteractionSet::GInteractions(   GenomicRanges::GRanges(\"chr11:60000000-65000000\"),   GenomicRanges::GRanges(\"chr4:10000000-15000000\") )  # Subset the object cc_gi_sub <- cc_100[query_gi]  cc_gi_sub #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 1 region #>   [1] chr11:1:135,006,516 <-> chr4:1:191,154,276 #> Interactions: 89 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 10 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 108,442 ranges #>     [2] track2: 70,400 ranges #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"subsetting-by-index-or-logical-vector","dir":"Articles","previous_headings":"Working with ChromatinContacts Objects > Manipulating ChromatinContacts Objects","what":"Subsetting by Index or Logical Vector","title":"Visualizing 3D Genome Organization with gghic","text":"can also use numeric indices logical vectors subsetting, similar subset data.frame vector:","code":"# Subset by numeric index (e.g., first 1000 interactions) cc_numeric_sub <- cc_100[1:100]  cc_numeric_sub #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 2 regions #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #>   [2] chr11:1:135,006,516 <-> chr4:1:191,154,276 #> Interactions: 100 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 55 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 123,248 ranges #>     [2] track2: 79,981 ranges #> -------------------------------------------------- # Subset using a logical vector (e.g., interactions with a score > -0.1) df <- scaleData(cc_100, \"balanced\", log10)  # Then subset based on the score logical_vec <- (df$score > -0.1) & !is.na(df$score) cc_logical_sub <- cc_100[logical_vec]  cc_logical_sub #> ChromatinContacts object #> -------------------------------------------------- #> File: chr4_11-100kb.cool #> Resolution: 100,000 bp #> Sequences: 2 (chr11, chr4) #> Focus: 2 regions #>   [1] chr11:1:135,006,516 <-> chr11:1:135,006,516 #>   [2] chr4:1:191,154,276 <-> chr4:1:191,154,276 #> Interactions: 25 interactions #>   Metadata columns: bin_id1, bin_id2, count, balanced #> Features: #>   TADs: 13 regions #>   Loops: 2 regions #>   Tracks: 2 regions #>   Tracks: 2 tracks #>     [1] track1: 53,256 ranges #>     [2] track2: 30,979 ranges #> --------------------------------------------------"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"creating-visualizations","dir":"Articles","previous_headings":"","what":"Creating Visualizations","title":"Visualizing 3D Genome Organization with gghic","text":"gghic provides two complementary approaches plotting:","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"high-level-wrapper-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Visualization Approaches","what":"1. High-Level Wrapper: gghic()","title":"Visualizing 3D Genome Organization with gghic","text":"Best : Quick plots, standard layouts, exploratory analysis Single function call sensible defaults Automatically handles data scaling transformation Optional arguments ideograms, genes, TADs, loops, tracks Returns ggplot2 object customization","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"low-level-layers-geom_","dir":"Articles","previous_headings":"Creating Visualizations > Visualization Approaches","what":"2. Low-Level Layers: geom_*()","title":"Visualizing 3D Genome Organization with gghic","text":"Best : Custom layouts, complex multi-panel figures, precise control Build plots layer--layer like standard ggplot2 Full control aesthetics, scales, themes Mix ggplot2 geoms extensions Ideal publication figures specific requirements","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_hic-layer","dir":"Articles","previous_headings":"Creating Visualizations > Basic Hi-C Heatmap","what":"Using geom_hic() Layer","title":"Visualizing 3D Genome Organization with gghic","text":"geom_hic() creates triangle heatmap visualization. works standard data frames/tibbles: Required aesthetics: - seqnames1, start1, end1: First genomic anchor - seqnames2, start2, end2: Second genomic anchor - fill: Interaction strength (typically log-transformed)  theme_hic() provides clean, publication-ready appearance: Removes axis labels tick marks Eliminates grid lines Focuses attention contact map Suitable Hi-C visualizations","code":"df_100 <- cc_100 |>   scaleData(\"balanced\", log10)  p <- df_100 |>   dplyr::filter(seqnames1 == \"chr11\", seqnames2 == \"chr11\") |>   ggplot2::ggplot(     ggplot2::aes(       seqnames1 = seqnames1, start1 = start1, end1 = end1,       seqnames2 = seqnames2, start2 = start2, end2 = end2, fill = score     )   ) +   geom_hic()  p p + theme_hic()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-gghic-wrapper","dir":"Articles","previous_headings":"Creating Visualizations > Basic Hi-C Heatmap","what":"Using gghic() Wrapper","title":"Visualizing 3D Genome Organization with gghic","text":"wrapper handles scaling plotting automatically:","code":"cc_100[\"chr11\"] |>   gghic()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-chromosome-ideograms","dir":"Articles","previous_headings":"Creating Visualizations","what":"Adding Chromosome Ideograms","title":"Visualizing 3D Genome Organization with gghic","text":"Chromosome ideograms provide genomic context showing: - entire chromosome cytogenetic bands - Current viewing region highlighted - Chromosome name position","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_ideogram-layer","dir":"Articles","previous_headings":"Creating Visualizations > Adding Chromosome Ideograms","what":"Using geom_ideogram() Layer","title":"Visualizing 3D Genome Organization with gghic","text":"Key parameters: - genome: Reference genome (“hg19”, “hg38”, “mm10”, “mm39”) - highlight: Whether show current region colored bar - length_ratio: Ideogram height relative plot (0-1) - fontsize: Text size chromosome labels","code":"cc_100[\"chr4:10000000-15000000\"] |>   gghic() +   geom_ideogram(     genome = \"hg19\", highlight = TRUE, length_ratio = 0.7, fontsize = 8   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-the-ideogram-argument-in-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Adding Chromosome Ideograms","what":"Using the ideogram Argument in gghic()","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"cc_100[\"chr4:10000000-15000000\"] |>   gghic(     ideogram = TRUE, genome = \"hg19\", highlight = TRUE,     length_ratio = 0.7, ideogram_fontsize = 8   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-gene-annotations","dir":"Articles","previous_headings":"Creating Visualizations","what":"Adding Gene Annotations","title":"Visualizing 3D Genome Organization with gghic","text":"Visualize gene structures correlate chromatin interactions genomic features. Annotation features: - Exon blocks (thick rectangles) - Introns (connecting lines) - Gene directionality (arrows style = \"arrow\") - Multiple gene tracks overlapping genes - Automatic collision detection layout","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_annotation-layer","dir":"Articles","previous_headings":"Creating Visualizations > Adding Gene Annotations","what":"Using geom_annotation() Layer","title":"Visualizing 3D Genome Organization with gghic","text":"Key parameters: gtf_path: Path GTF/GFF annotation file \"basic\": Simple exon-intron structure \"arrow\": Adds directional arrows showing transcription direction Positive integer: Maximum gap gene tracks (bp) -1: Force genes single track (may overlap) 100000: Good default regions gene_symbols: Character vector specific genes display (others hidden) include_ncrna: Include non-coding RNAs (lncRNA, miRNA, etc.)","code":"# Prepare data at 5kb resolution df_5 <- cc_5 |>   scaleData(\"balanced\", log10)  # Create a base plot for a small region p <- df_5 |>   dplyr::filter(     seqnames1 == \"chr11\", seqnames2 == \"chr11\",     start1 > 67000000, start1 < 67100000,     start2 > 67000000, start2 < 67100000   ) |>   ggplot(aes(     seqnames1 = seqnames1, start1 = start1, end1 = end1,     seqnames2 = seqnames2, start2 = start2, end2 = end2, fill = score   )) +   geom_hic() +   theme_hic()  # Add the annotation layer p + geom_annotation(gtf_path = path_gtf, style = \"basic\", maxgap = 100000) p + geom_annotation(   gtf_path = path_gtf, style = \"arrow\", maxgap = -1,   gene_symbols = c(\"GRK2\", \"SSH3\", \"KDM2A\") )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-the-annotation-argument-in-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Adding Gene Annotations","what":"Using the annotation Argument in gghic()","title":"Visualizing 3D Genome Organization with gghic","text":", can also use annotation argument gghic() add gene annotations directly.","code":"cc_5[\"chr11:67000000-67100000\"] |>   gghic(     ideogram = TRUE, genome = \"hg19\", highlight = FALSE, length_ratio = 0.7, ideogram_fontsize = 8,     annotation = TRUE, gtf_path = path_gtf, style = \"arrow\", maxgap = -1, gene_symbols = c(\"GRK2\", \"SSH3\", \"KDM2A\")   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-tads-topologically-associating-domains","dir":"Articles","previous_headings":"Creating Visualizations","what":"Adding TADs (Topologically Associating Domains)","title":"Visualizing 3D Genome Organization with gghic","text":"TADs visualized triangles overlaid contact map, representing self-interacting genomic regions. Visualization features: - Triangle apex points TAD boundary - Triangle sides span TAD region - Color line style customizable - Automatically scaled match heatmap coordinates Two geoms available: - geom_tad(): Reads TAD file directly (convenient) - geom_tad2(): Uses data frame (flexible customization)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-tad-argument-in-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Adding TADs (Topologically Associating Domains)","what":"Using tad Argument in gghic()","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"cc_100[\"chr4:50000000-80000000\"] |>   gghic(     tad = TRUE, tad_is_0based = TRUE, tad_path = path_tad,     tad_colour = \"#00ff83\"   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_tad-and-geom_tad2","dir":"Articles","previous_headings":"Creating Visualizations > Adding TADs (Topologically Associating Domains)","what":"Using geom_tad() and geom_tad2()","title":"Visualizing 3D Genome Organization with gghic","text":"Using geom_tad2() makes easy customize TAD aesthetics since can provide data.frame additional columns.","code":"df_tad <- path_tad |>   read.table(     sep = \"\\t\", header = FALSE, col.names = c(\"seqnames\", \"start\", \"end\")   ) |>   dplyr::mutate(start = start + 1) |>   dplyr::filter(seqnames == \"chr4\", start > 60000000, end < 70000000) |>   dplyr::mutate(sample = c(\"A\", \"B\"))  df_100 |>   dplyr::filter(     seqnames1 == \"chr4\", seqnames2 == \"chr4\",     start1 > 60000000, end1 < 70000000,     start2 > 60000000, end2 < 70000000   ) |>   gghic(scale_column = \"score\", scale_method = function(x) x) +   geom_tad2(     data = df_tad, ggplot2::aes(       seqnames = seqnames, start = start, end = end, colour = sample     ), stroke = 2   ) +   ggplot2::scale_color_grey()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-chromatin-loops","dir":"Articles","previous_headings":"Creating Visualizations","what":"Adding Chromatin Loops","title":"Visualizing 3D Genome Organization with gghic","text":"Chromatin loops represent long-range interactions specific genomic loci (e.g., enhancer-promoter contacts). Visualization: - Drawn arcs/semicircles connecting loop anchors - Arc height proportional genomic distance - Customizable colors, line widths, styles Two geoms available: - geom_loop(): Reads BEDPE file directly - geom_loop2(): Uses data frame custom aesthetics (color, size significance)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-loop-argument-in-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Adding Chromatin Loops","what":"Using loop Argument in gghic()","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"cc_5[\"chr11:61915000-65000000\"] |>   gghic(loop = TRUE)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_loop-and-geom_loop2","dir":"Articles","previous_headings":"Creating Visualizations > Adding Chromatin Loops","what":"Using geom_loop() and geom_loop2()","title":"Visualizing 3D Genome Organization with gghic","text":"Using geom_loop2() makes easy customize loop aesthetics since can provide data.frame additional columns.","code":"df_loop <- path_loop |>   read.table(     sep = \"\\t\", col.names = c(       \"seqnames1\", \"start1\", \"end1\", \"seqnames2\", \"start2\", \"end2\"     )   ) |>   dplyr::filter(     seqnames1 == \"chr11\", seqnames2 == \"chr11\",     start1 > 61925000, end1 < 67480000,     start2 > 61925000, end2 < 67480000   )  keep <- sample(nrow(df_loop), 6) df_loop <- df_loop |>   dplyr::slice(keep) |>   dplyr::mutate(     sample = c(rep(\"A\", 3), rep(\"B\", 3))   )  cc_5[\"chr11:61915000-65000000\"] |>   gghic() +   geom_loop2(     data = df_loop, ggplot2::aes(       seqnames1 = seqnames1, start1 = start1, end1 = end1,       seqnames2 = seqnames2, start2 = start2, end2 = end2, colour = sample     ), stroke = 1, style = \"arc\"   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"multi-way-contact-visualization","dir":"Articles","previous_headings":"Creating Visualizations","what":"Multi-Way Contact Visualization","title":"Visualizing 3D Genome Organization with gghic","text":"Pore-C similar technologies capture multi-way contacts single DNA molecule contacts 3+ genomic loci simultaneously. concatemers? - Long DNA molecules captured nanopore sequencing - molecule contains multiple chromatin contact points - Represented sets genomic intervals shared read ID Visualization approach: - read shown colored horizontal bar - Bar width indicates genomic span contacts - Overlaid Hi-C heatmap context 💡 See also: Hypergraph vignette network-based analysis multi-way contacts","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_concatemer-and-geom_concatemer2","dir":"Articles","previous_headings":"Creating Visualizations > Multi-Way Contact Visualization","what":"Using geom_concatemer() and geom_concatemer2()","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"# Load the GInteractions object representing multi-way contacts gis <- path_gis_hic |>   readRDS() df <- scaleData(gis, \"balanced\", log10)  # Select a few reads to visualize names_read <- c(   \"0c32bbce-24f8-4006-a75c-0e3504648971\",   \"10ae8263-cebc-4cbc-94c1-2c1dc5f22101\",   \"ced078ca-2d68-5217-a20e-7dc37dd2d786\",   \"06063b40-0271-4f4e-993d-2f202028b697\",   \"08bb8fe4-c54b-4a11-b9a0-c9eed2d18933\" ) grs_concatemer <- path_concatemers |>   readRDS() |>   GenomicRanges::sort() grs_concatemer <- grs_concatemer[   GenomicRanges::seqnames(grs_concatemer) %in% c(\"chr22\") ] df_concatemers <- grs_concatemer |>   tibble::as_tibble() |>   dplyr::filter(read_name %in% names_read)  gghic(gis) +   geom_concatemer2(     data = df_concatemers, ggplot2::aes(       seqnames = seqnames, start = start, end = end, read_group = read_name,       colour = read_name     ), check_concatemers = TRUE, width_ratio = 0.03   ) +   ggplot2::theme(     legend.key.size = ggplot2::unit(2, \"mm\"),     legend.text = ggplot2::element_text(size = 4)   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"converting-concatemers-to-ginteractions","dir":"Articles","previous_headings":"Creating Visualizations > Multi-Way Contact Visualization","what":"Converting Concatemers to GInteractions","title":"Visualizing 3D Genome Organization with gghic","text":"can also generate GInteractions object set concatemers using concatemers2Gis() visualize contact frequency concatemers.","code":"grs_concatemer_sub <- grs_concatemer[   grs_concatemer$read_name %in% names_read ]  gis_concatemer <- concatemers2Gis(grs_concatemer_sub, bin_size = 100000)  gis_concatemer |>   sort() |>   tibble::as_tibble() |>   dplyr::mutate(balanced = count) |>   gghic(scale_method = function(x) x, ideogram = TRUE) +   geom_concatemer2(     data = df_concatemers,     ggplot2::aes(       seqnames = seqnames, start = start, end = end, read_group = read_name     )   ) +   ggplot2::theme(     legend.key.size = ggplot2::unit(2, \"mm\"),     legend.text = ggplot2::element_text(size = 4)   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"combining-heatmaps","dir":"Articles","previous_headings":"Creating Visualizations > Multi-Way Contact Visualization","what":"Combining Heatmaps","title":"Visualizing 3D Genome Organization with gghic","text":"can combine two heatmaps using geom_hic_under() visualize pairwise interactions multi-way contacts.","code":"gghic(gis) +   geom_concatemer2(     data = df_concatemers,     ggplot2::aes(       seqnames = seqnames, start = start, end = end, read_group = read_name     )   ) +   geom_hic_under(     data = tibble::as_tibble(gis_concatemer) |> dplyr::mutate(score = count),     ggplot2::aes(       seqnames1 = seqnames1, start1 = start1, end1 = end1,       seqnames2 = seqnames2, start2 = start2, end2 = end2, fill2 = score     ), draw_boundary = FALSE   ) |>   renameGeomAes(new_aes = c(\"fill\" = \"fill2\")) +   scale_fill_viridis_c(     aesthetics = \"fill2\", option = \"A\", guide = \"legend\", name = \"count\"   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"multi-chromosome-visualization","dir":"Articles","previous_headings":"Creating Visualizations","what":"Multi-Chromosome Visualization","title":"Visualizing 3D Genome Organization with gghic","text":"Visualize interactions across multiple chromosomes single unified plot. Use cases: - Genome-wide interaction patterns - Trans-chromosomal contacts - Comparative Hi-C across chromosomes - Chromosome territory analysis Layout features: - chromosome occupies diagonal block - Inter-chromosomal interactions shown -diagonal blocks - Chromosome boundaries clearly demarcated Key parameters: - draw_boundary = TRUE: Draws lines separating chromosomes - expand_xaxis = TRUE: Adds spacing chromosomes readability - expand_left: Additional left margin (bp) using ideograms/annotations  Chromosome ideograms gene tracks can also added plot visualizing multiple chromosomes.","code":"cc_100 |>   gghic(draw_boundary = TRUE, expand_xaxis = TRUE) p <- df_5 |>   dplyr::filter(     start1 > 10000000 & start1 < 11000000 &       start2 > 10000000 & start2 < 11000000   ) |>   gghic(     scale_column = \"score\", scale_method = function(x) x,     ideogram = TRUE, genome = \"hg19\", highlight = TRUE, ideogram_fontsize = 7, ideogram_width_ratio = 0.08,     annotation = TRUE, include_ncrna = FALSE, gtf_path = path_gtf, maxgap = 100000, annotation_fontsize = 5, annotation_width_ratio = 0.05,     draw_boundary = TRUE, expand_xaxis = TRUE, expand_left = 300000   )  p"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"adding-signal-tracks","dir":"Articles","previous_headings":"Creating Visualizations","what":"Adding Signal Tracks","title":"Visualizing 3D Genome Organization with gghic","text":"Integrate 1D genomic signals (ChIP-seq, ATAC-seq, RNA-seq, etc.) alongside Hi-C data. Supported formats: - BigWig files (.bw, .bigWig) - Automatic data range detection manual specification - Multiple tracks independent colors scales Visualization: - Tracks displayed area/mountain plots - Positioned left side heatmap - Aligned genomic coordinates - Rasterization option large datasets","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-geom_track-layer","dir":"Articles","previous_headings":"Creating Visualizations > Adding Signal Tracks","what":"Using geom_track() Layer","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"p + geom_track(   data_paths = paths_track, width_ratio = 0.3, data_range = \"auto\",   fill = c(\"#DC0000B2\", \"#00A087B2\"), rasterize = TRUE )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"using-track-argument-in-gghic","dir":"Articles","previous_headings":"Creating Visualizations > Adding Signal Tracks","what":"Using track Argument in gghic()","title":"Visualizing 3D Genome Organization with gghic","text":"gghic() handy adding features plot.","code":"keep <- which(   df_5$start1 > 10000000 & df_5$start1 < 11000000 &     df_5$start2 > 10000000 & df_5$start2 < 11000000 )  cc_5[keep] |>   gghic(     draw_boundary = TRUE, rasterize = TRUE,     ideogram = TRUE, genome = \"hg19\", highlight = TRUE, ideogram_fontsize = 7, ideogram_width_ratio = 0.08,     annotation = TRUE, include_ncrna = FALSE, gtf_path = path_gtf,     annotation_style = \"arrow\", maxgap = 100000, annotation_fontsize = 5, annotation_width_ratio = 0.05,     track = TRUE, track_width_ratio = 0.5, track_fill = c(\"#DC0000B2\", \"#00A087B2\"), data_range = \"maximum\",     loop = TRUE, loop_style = \"arc\", stroke = 0.5,     expand_xaxis = TRUE, expand_left = 300000   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/gghic.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualizing 3D Genome Organization with gghic","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] GenomicFeatures_1.62.0      AnnotationDbi_1.72.0        #>  [3] gghic_0.2.1                 InteractionSet_1.38.0       #>  [5] SummarizedExperiment_1.40.0 Biobase_2.70.0              #>  [7] MatrixGenerics_1.22.0       matrixStats_1.5.0           #>  [9] GenomicRanges_1.62.1        Seqinfo_1.0.0               #> [11] IRanges_2.44.0              S4Vectors_0.48.0            #> [13] BiocGenerics_0.56.0         generics_0.1.4              #> [15] dplyr_1.1.4                 ggplot2_4.0.1               #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3       rstudioapi_0.17.1        jsonlite_2.0.0           #>   [4] magrittr_2.0.4           farver_2.1.2             rmarkdown_2.30           #>   [7] fs_1.6.6                 BiocIO_1.20.0            ragg_1.5.0               #>  [10] vctrs_0.6.5              memoise_2.0.1            Rsamtools_2.26.0         #>  [13] RCurl_1.98-1.17          base64enc_0.1-3          htmltools_0.5.9          #>  [16] S4Arrays_1.10.1          progress_1.2.3           curl_7.0.0               #>  [19] Rhdf5lib_1.32.0          SparseArray_1.10.8       Formula_1.2-5            #>  [22] rhdf5_2.54.1             sass_0.4.10              bslib_0.9.0              #>  [25] htmlwidgets_1.6.4        desc_1.4.3               Gviz_1.54.0              #>  [28] httr2_1.2.2              cachem_1.1.0             GenomicAlignments_1.46.0 #>  [31] lifecycle_1.0.4          pkgconfig_2.0.3          Matrix_1.7-4             #>  [34] R6_2.6.1                 fastmap_1.2.0            digest_0.6.39            #>  [37] colorspace_2.1-2         textshaping_1.0.4        Hmisc_5.2-4              #>  [40] RSQLite_2.4.5            filelock_1.0.3           labeling_0.4.3           #>  [43] httr_1.4.7               abind_1.4-8              compiler_4.5.2           #>  [46] bit64_4.6.0-1            withr_3.0.2              htmlTable_2.4.3          #>  [49] S7_0.2.1                 backports_1.5.0          BiocParallel_1.44.0      #>  [52] DBI_1.2.3                biomaRt_2.66.0           rappdirs_0.3.3           #>  [55] DelayedArray_0.36.0      rjson_0.2.23             tools_4.5.2              #>  [58] foreign_0.8-90           nnet_7.3-20              glue_1.8.0               #>  [61] restfulr_0.0.16          rhdf5filters_1.22.0      grid_4.5.2               #>  [64] checkmate_2.3.3          cluster_2.1.8.1          gtable_0.3.6             #>  [67] BSgenome_1.78.0          tidyr_1.3.2              ensembldb_2.34.0         #>  [70] data.table_1.18.0        hms_1.1.4                XVector_0.50.0           #>  [73] pillar_1.11.1            stringr_1.6.0            BiocFileCache_3.0.0      #>  [76] lattice_0.22-7           deldir_2.0-4             rtracklayer_1.70.1       #>  [79] bit_4.6.0                biovizBase_1.58.0        tidyselect_1.2.1         #>  [82] Biostrings_2.78.0        knitr_1.51               gridExtra_2.3            #>  [85] ProtGenerics_1.42.0      xfun_0.55                stringi_1.8.7            #>  [88] UCSC.utils_1.6.1         lazyeval_0.2.2           yaml_2.3.12              #>  [91] evaluate_1.0.5           codetools_0.2-20         cigarillo_1.0.0          #>  [94] interp_1.1-6             tibble_3.3.0             cli_3.6.5                #>  [97] rpart_4.1.24             systemfonts_1.3.1        jquerylib_0.1.4          #> [100] dichromat_2.0-0.1        Rcpp_1.1.0               GenomeInfoDb_1.46.2      #> [103] dbplyr_2.5.1             png_0.1-8                XML_3.99-0.20            #> [106] parallel_4.5.2           pkgdown_2.2.0            blob_1.2.4               #> [109] prettyunits_1.2.0        jpeg_0.1-11              latticeExtra_0.6-31      #> [112] AnnotationFilter_1.34.0  bitops_1.0-9             txdbmaker_1.6.2          #> [115] viridisLite_0.4.2        VariantAnnotation_1.56.0 scales_1.4.0             #> [118] purrr_1.2.0              crayon_1.5.3             rlang_1.1.6              #> [121] KEGGREST_1.50.0"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Multi-way Contact Analysis with Hypergraphs","text":"Pore-C similar long-read technologies capture multi-way chromatin contacts single DNA molecule can contact 3, 4, 5, genomic loci simultaneously. Traditional Hi-C analysis focuses pairwise interactions, multi-way contacts provide richer information : Higher-order chromatin structure: TAD hubs, chromatin loops involving multiple enhancers Regulatory complexity: Multi-enhancer clusters coordinating gene expression Phase separation: Condensate formation many participants vignette shows analyze visualize multi-way contacts using hypergraph representations MultiWayContacts S4 class, : Nodes (vertices) = Genomic bins Hyperedges = Reads connecting multiple bins","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"what-is-a-hypergraph","dir":"Articles","previous_headings":"Key Concepts","what":"What is a Hypergraph?","title":"Multi-way Contact Analysis with Hypergraphs","text":"hypergraph generalization graph edges (called hyperedges) can connect number vertices (nodes), just two. chromatin contacts: Pairwise contact (Hi-C): edge connecting 2 bins 3-way contact: hyperedge connecting 3 bins N-way contact: hyperedge connecting N bins","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"why-use-hypergraphs","dir":"Articles","previous_headings":"Key Concepts","what":"Why Use Hypergraphs?","title":"Multi-way Contact Analysis with Hypergraphs","text":"Traditional pairwise analysis loses information: read contacting bins {, B, C, D} generates 6 pairwise contacts: AB, AC, AD, BC, BD, CD can’t reconstruct bins contacted together molecule Hypergraphs preserve simultaneity information","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"filtering-strategy","dir":"Articles","previous_headings":"Key Concepts","what":"Filtering Strategy","title":"Multi-way Contact Analysis with Hypergraphs","text":"Multi-way contact analysis requires careful filtering: Bin contacts: Remove low-quality pairwise interactions (quantile filtering) Multi-way degree: Keep reads ≥N contacts (e.g., ≥3) Chromosome focus: Analyze specific chromosomes clarity","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting Started","title":"Multi-way Contact Analysis with Hypergraphs","text":"Load required libraries:","code":"load_pkg <- function(pkgs) {   for (pkg in pkgs) suppressMessages(require(pkg, character.only = TRUE)) }  load_pkg(c(\"dplyr\", \"ggplot2\", \"gghic\"))"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"example-data-format","dir":"Articles","previous_headings":"Getting Started","what":"Example Data Format","title":"Multi-way Contact Analysis with Hypergraphs","text":"pairs file tab-separated least columns: row pairwise contact read. read 4 contacts generates 6 rows (pairs).","code":"read_name    chrom1  pos1  chrom2  pos2 read_001     chr1    1000  chr1    5000 read_001     chr1    1000  chr1    9000 read_002     chr2    2000  chr2    8000 ..."},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"prepare-example-data","dir":"Articles","previous_headings":"Getting Started","what":"Prepare Example Data","title":"Multi-way Contact Analysis with Hypergraphs","text":"vignette, ’ll create synthetic Pore-C data save temporary file:","code":"set.seed(42)  # Simulate multi-way contacts on multiple chromosomes n_reads <- 500  # Chromosome information chroms <- data.frame(   chrom = c(\"chr21\", \"chr22\"),   length = c(46e6, 50e6), # 46 Mb and 50 Mb   stringsAsFactors = FALSE )  # Generate reads with varying numbers of contacts read_data <- lapply(seq_len(n_reads), function(i) {   read_name <- sprintf(\"read_%05d\", i)    # 20% chance of trans-chromosomal contacts   is_trans <- runif(1) < 0.2    if (is_trans) {     # Trans-chromosomal: contacts on both chromosomes     n_contacts_chr1 <- sample(2:4, 1)     n_contacts_chr2 <- sample(2:4, 1)      # Generate positions on chr21     center1 <- runif(1, 10e6, chroms$length[1] - 10e6)     spread1 <- runif(1, 1e6, 3e6)     pos_chr1 <- sort(pmax(1, pmin(       chroms$length[1],       rnorm(n_contacts_chr1, center1, spread1)     )))      # Generate positions on chr22     center2 <- runif(1, 10e6, chroms$length[2] - 10e6)     spread2 <- runif(1, 1e6, 3e6)     pos_chr2 <- sort(pmax(1, pmin(       chroms$length[2],       rnorm(n_contacts_chr2, center2, spread2)     )))      # Create all pairwise combinations     all_positions <- list(       chr1 = data.frame(chrom = chroms$chrom[1], pos = as.integer(pos_chr1)),       chr2 = data.frame(chrom = chroms$chrom[2], pos = as.integer(pos_chr2))     )      all_contacts <- rbind(all_positions$chr1, all_positions$chr2)     n_total <- nrow(all_contacts)      if (n_total < 2) {       return(NULL)     }      pairs_list <- combn(n_total, 2, simplify = FALSE)      do.call(rbind, lapply(pairs_list, function(pair) {       data.frame(         read_name = read_name,         chrom1 = all_contacts$chrom[pair[1]],         pos1 = all_contacts$pos[pair[1]],         chrom2 = all_contacts$chrom[pair[2]],         pos2 = all_contacts$pos[pair[2]],         stringsAsFactors = FALSE       )     }))   } else {     # Intra-chromosomal: contacts on single chromosome     chr_idx <- sample(1:2, 1, prob = c(0.3, 0.7))     chr <- chroms$chrom[chr_idx]     chr_length <- chroms$length[chr_idx]      n_contacts <- sample(3:8, 1, prob = c(0.3, 0.25, 0.2, 0.15, 0.07, 0.03))      center <- runif(1, 10e6, chr_length - 10e6)     spread <- runif(1, 1e6, 5e6)     positions <- sort(pmax(1, pmin(       chr_length,       rnorm(n_contacts, center, spread)     )))      if (n_contacts < 2) {       return(NULL)     }      pairs <- combn(n_contacts, 2, simplify = FALSE)      do.call(rbind, lapply(pairs, function(pair) {       data.frame(         read_name = read_name,         chrom1 = chr,         pos1 = as.integer(positions[pair[1]]),         chrom2 = chr,         pos2 = as.integer(positions[pair[2]]),         stringsAsFactors = FALSE       )     }))   } })  pairs_df <- do.call(rbind, read_data)  # Add some noise noise_pairs <- do.call(rbind, lapply(1:100, function(i) {   chr <- sample(chroms$chrom, 1)   chr_length <- chroms$length[chroms$chrom == chr]   data.frame(     read_name = sprintf(\"noise_%04d\", i),     chrom1 = chr,     pos1 = sample(1:chr_length, 1),     chrom2 = chr,     pos2 = sample(1:chr_length, 1),     stringsAsFactors = FALSE   ) }))  pairs_df <- rbind(pairs_df, noise_pairs)  # Save to temporary file pairs_file <- tempfile(fileext = \".pairs.gz\") gz <- gzfile(pairs_file, \"w\") write.table(pairs_df, gz, sep = \"\\t\", quote = FALSE, row.names = FALSE) close(gz)  # Summary cat(sprintf(   \"Generated %d pairwise contacts from %d reads\\n\",   nrow(pairs_df), length(unique(pairs_df$read_name)) )) #> Generated 5319 pairwise contacts from 600 reads  trans_contacts <- sum(pairs_df$chrom1 != pairs_df$chrom2) cat(sprintf(   \"  Intra-chromosomal: %d (%.1f%%)\\n\",   nrow(pairs_df) - trans_contacts,   100 * (nrow(pairs_df) - trans_contacts) / nrow(pairs_df) )) #>   Intra-chromosomal: 4438 (83.4%) cat(sprintf(   \"  Trans-chromosomal: %d (%.1f%%)\\n\",   trans_contacts, 100 * trans_contacts / nrow(pairs_df) )) #>   Trans-chromosomal: 881 (16.6%)  head(pairs_df, 10) #>     read_name chrom1     pos1 chrom2     pos2 #> 1  read_00001  chr21 27651551  chr21 31762442 #> 2  read_00001  chr21 27651551  chr21 33514326 #> 3  read_00001  chr21 31762442  chr21 33514326 #> 4  read_00002  chr21 21721090  chr21 28230868 #> 5  read_00002  chr21 21721090  chr21 31627427 #> 6  read_00002  chr21 28230868  chr21 31627427 #> 7  read_00003  chr21 25627609  chr21 25874411 #> 8  read_00003  chr21 25627609  chr21 26736871 #> 9  read_00003  chr21 25874411  chr21 26736871 #> 10 read_00004  chr22  6959097  chr22  9658680"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"workflow-with-multiwaycontacts","dir":"Articles","previous_headings":"","what":"Workflow with MultiWayContacts","title":"Multi-way Contact Analysis with Hypergraphs","text":"MultiWayContacts S4 class provides streamlined, object-oriented workflow analyzing multi-way contacts. typical analysis follows steps: Create MultiWayContacts object Import pairs data Build hypergraph Tidy long format Select top hyperedges Visualize gghypergraph()","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"single-chromosome-analysis","dir":"Articles","previous_headings":"Workflow with MultiWayContacts","what":"Single Chromosome Analysis","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Create MultiWayContacts object for chr22 mc_chr22 <- MultiWayContacts(pairs_path = pairs_file, focus = \"chr22\")  # Complete workflow using pipes mc_chr22 <- mc_chr22 |>   import() |> # Load pairs data   build(     bin_size = 500000L, # 500 Kb bins     quantile = 0.80, # Top 20% contacts     min_multiway = 3   ) |> # ≥3-way contacts   gghic::tidy() |> # Convert to long format   gghic::select(n_intra = 10) # Select top hyperedges #> Reading pairs from file using C implementation... #> Reading pairs from: /tmp/RtmpIVVgTq/file1e6d29f19718.pairs.gz #> Filtering for chromosome: chr22 #> Mode: (intra-chromosomal only) #>  #> Total: 5320 lines processed, 2779 contacts retained #> Processing 2,779 contacts (chr22) #> Removed 471 duplicate pairwise contacts within reads (2,308 remaining) #> Filtering bin pairs with >= 3 contacts (80% quantile) #> Retained 1,337 contacts from 341 reads #> Estimated matrix size: 0.0 GB, Available RAM: 12.5 GB (threshold: 10.0 GB) #> Identifying unique hyperedge patterns... #> Removed 14 duplicate hyperedges (327 unique patterns) #> Final hypergraph: 68 bins, 238 unique hyperedges (min 3-way contacts)  # Visualize gghypergraph(mc_chr22, color_by = \"n_multiways\", palette = \"viridis\")"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"multiple-chromosomes","dir":"Articles","previous_headings":"Workflow with MultiWayContacts","what":"Multiple Chromosomes","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Analyze both chr21 and chr22 mc_multi <- MultiWayContacts(   pairs_path = pairs_file, focus = c(\"chr21\", \"chr22\") )  mc_multi <- mc_multi |>   import(inter_chrom = TRUE) |>   build(bin_size = 500000L, quantile = 0.80, min_multiway = 3) |>   gghic::tidy() |>   gghic::select(n_intra = 10, n_inter = 10) #> Reading pairs from file using C implementation... #> Reading pairs from: /tmp/RtmpIVVgTq/file1e6d29f19718.pairs.gz #> Filtering for 2 chromosomes #> Mode: (intra- and inter-chromosomal) #>  #> Total: 5320 lines processed, 5319 contacts retained #> Processing 5,319 contacts (2 chromosomes) #> Removed 872 duplicate pairwise contacts within reads (4,447 remaining) #> Filtering bin pairs with >= 2 contacts (80% quantile) #> Retained 2,873 contacts from 496 reads #> Estimated matrix size: 0.0 GB, Available RAM: 12.5 GB (threshold: 10.0 GB) #> Identifying unique hyperedge patterns... #> Removed 3 duplicate hyperedges (493 unique patterns) #> Final hypergraph: 138 bins, 435 unique hyperedges (min 3-way contacts)  # Faceted view (separate panels per chromosome) gghypergraph(mc_multi, facet_chrom = FALSE)"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"import","dir":"Articles","previous_headings":"Method Details","what":"import()","title":"Multi-way Contact Analysis with Hypergraphs","text":"Loads pairs data file. data can filtered : Specific chromosome(s) (via focus parameter constructor) Intra-chromosomal (default) include inter-chromosomal (inter_chrom = TRUE)","code":"# Intra-chromosomal only (default) mc <- MultiWayContacts(pairs_path) |>   import()  # Include inter-chromosomal mc <- MultiWayContacts(pairs_path) |>   import(inter_chrom = TRUE)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"build","dir":"Articles","previous_headings":"Method Details","what":"build()","title":"Multi-way Contact Analysis with Hypergraphs","text":"Constructs hypergraph several steps: Binning: Aggregate contacts genomic bins Filtering: Remove low-frequency bin pairs (quantile threshold) Incidence matrix: Build sparse matrix (bins × reads) Deduplication: Merge identical hyperedge patterns Multiway filtering: Keep hyperedges ≥ min_multiway contacts Parameters: bin_size: Genomic bin size (default 1 Mb). Smaller = higher resolution sparser quantile: Threshold bin pair filtering (default 0.85). Higher = stringent min_multiway: Minimum contacts per hyperedge (default 2)","code":"# High resolution, strict filtering mc |>   build(bin_size = 100000L, quantile = 0.90, min_multiway = 4)  # Lower resolution, permissive filtering mc |>   build(bin_size = 1000000L, quantile = 0.75, min_multiway = 2)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"tidy","dir":"Articles","previous_headings":"Method Details","what":"tidy()","title":"Multi-way Contact Analysis with Hypergraphs","text":"Converts sparse incidence matrix tidy long-format data frame. Parameters: max_hyperedges: Subset top N hyperedges contact order (default: ) \"none\": Raw frequency counts (default) \"log\": Log-transformed \"by_order\": Normalized within contact order \"minmax\": Scaled [0, 1]","code":"# Top 50 hyperedges with log weights mc |>   tidy(max_hyperedges = 50, weight_normalization = \"log\")  # All hyperedges with normalized weights mc |>   tidy(weight_normalization = \"by_order\")"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"select","dir":"Articles","previous_headings":"Method Details","what":"select()","title":"Multi-way Contact Analysis with Hypergraphs","text":"Selects top-weighted hyperedges visualization. chromosome, selects: Top n_intra intra-chromosomal hyperedges Top n_inter inter-chromosomal hyperedges fewer intra-chromosomal hyperedges exist, remaining quota added inter-chromosomal selection. Parameters: n_intra: Number intra-chromosomal hyperedges per chromosome (default 5) n_inter: Number inter-chromosomal hyperedges per chromosome (default 5) n_multiways_filter: Keep specific contact orders (e.g., c(3, 4)) chroms: Focus specific chromosome(s) append: Add existing selection (TRUE) replace (FALSE)","code":"# Select more hyperedges mc |>   gghic::select(n_intra = 15, n_inter = 10)  # Only 3-way and 4-way contacts mc |>   gghic::select(n_multiways_filter = c(3, 4))  # Focus on chr1 mc |>   gghic::select(chroms = \"chr1\", append = FALSE)  # Accumulate selections mc |>   gghic::select(chroms = \"chr1\", append = FALSE) |>   gghic::select(chroms = \"chr2\", append = TRUE)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"gghypergraph","dir":"Articles","previous_headings":"Method Details","what":"gghypergraph()","title":"Multi-way Contact Analysis with Hypergraphs","text":"Creates ggplot2 visualization selected hyperedges. Parameters: point_size: Size bin points (default 2) line_width: Base width hyperedge lines (default 0.3) line_alpha: Transparency lines (default 0.6) color_by: Variable coloring (\"n_multiways\" ) palette: Color palette (\"viridis\", \"magma\", \"plasma\", etc.) facet_chrom: Separate panels per chromosome (TRUE) composite y-axis (FALSE)  plot shows: X-axis: Hyperedges (sorted genomic position) Y-axis: Genomic bins (position within chromosome) Line width: Scales hyperedge weight Line color: contact order (number bins)","code":"gghypergraph(   mc_chr22,   point_size = 3,   line_width = 0.5,   line_alpha = 0.8,   palette = \"plasma\",   facet_chrom = TRUE )"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"filtering-by-contact-order","dir":"Articles","previous_headings":"Other Examples","what":"Filtering by Contact Order","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Focus on high-order contacts only (≥5-way) mc_high_order <- MultiWayContacts(pairs_file, focus = \"chr22\") |>   import() |>   build(bin_size = 500000L, quantile = 0.85, min_multiway = 5) |>   gghic::tidy() |>   gghic::select(n_intra = 10, n_inter = 0) #> Reading pairs from file using C implementation... #> Reading pairs from: /tmp/RtmpIVVgTq/file1e6d29f19718.pairs.gz #> Filtering for chromosome: chr22 #> Mode: (intra-chromosomal only) #>  #> Total: 5320 lines processed, 2779 contacts retained #> Processing 2,779 contacts (chr22) #> Removed 471 duplicate pairwise contacts within reads (2,308 remaining) #> Filtering bin pairs with >= 4 contacts (85% quantile) #> Retained 860 contacts from 301 reads #> Estimated matrix size: 0.0 GB, Available RAM: 12.5 GB (threshold: 10.0 GB) #> Identifying unique hyperedge patterns... #> Removed 36 duplicate hyperedges (265 unique patterns) #> Final hypergraph: 60 bins, 46 unique hyperedges (min 5-way contacts)  gghypergraph(mc_high_order, palette = \"inferno\")"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"comparing-chromosomes","dir":"Articles","previous_headings":"Other Examples","what":"Comparing Chromosomes","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Select from both chromosomes independently mc_compare <- MultiWayContacts(pairs_file, focus = c(\"chr21\", \"chr22\")) |>   import() |>   build(bin_size = 500000L) |>   gghic::tidy() |>   gghic::select(n_intra = 10, n_inter = 5, append = FALSE) #> Reading pairs from file using C implementation... #> Reading pairs from: /tmp/RtmpIVVgTq/file1e6d29f19718.pairs.gz #> Filtering for 2 chromosomes #> Mode: (intra-chromosomal only) #>  #> Total: 5320 lines processed, 4438 contacts retained #> Processing 4,438 contacts (2 chromosomes) #> Removed 97 reads with inter-chromosomal contacts (503 reads remaining) #> Removed 649 duplicate pairwise contacts within reads (3,140 remaining) #> Filtering bin pairs with >= 3 contacts (85% quantile) #> Retained 1,290 contacts from 353 reads #> Estimated matrix size: 0.0 GB, Available RAM: 12.3 GB (threshold: 9.8 GB) #> Identifying unique hyperedge patterns... #> Removed 18 duplicate hyperedges (335 unique patterns) #> Final hypergraph: 112 bins, 331 unique hyperedges (min 2-way contacts)  # Faceted comparison gghypergraph(mc_compare, facet_chrom = TRUE)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"customizing-plots","dir":"Articles","previous_headings":"Other Examples","what":"Customizing Plots","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Get base plot and customize p <- gghypergraph(mc_chr22, facet_chrom = FALSE)  # Add custom styling p +   ggplot2::theme_bw() +   ggplot2::labs(     title = \"Multi-way Chromatin Contacts on chr22\",     subtitle = \"Colored by contact order, line width = frequency\"   ) +   ggplot2::theme(     plot.title = element_text(size = 16, face = \"bold\"),     plot.subtitle = element_text(size = 12)   )"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"contact-order-distribution","dir":"Articles","previous_headings":"Interpreting Results","what":"Contact Order Distribution","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Examine distribution of contact orders if (!is.null(hypergraphData(mc_multi, \"selected\"))) {   contact_summary <- hypergraphData(mc_multi, \"selected\") |>     dplyr::distinct(hyperedge_idx, n_multiways) |>     dplyr::count(n_multiways, name = \"n_hyperedges\")    print(contact_summary)    ggplot2::ggplot(     contact_summary,     ggplot2::aes(x = n_multiways, y = n_hyperedges)   ) +     ggplot2::geom_col(fill = \"steelblue\") +     ggplot2::labs(       x = \"Number of contacts (multiway order)\",       y = \"Number of hyperedges\",       title = \"Distribution of Contact Orders\"     ) +     ggplot2::theme_minimal() } #> # A tibble: 5 × 2 #>   n_multiways n_hyperedges #>         <dbl>        <int> #> 1           3           13 #> 2           4            9 #> 3           5            5 #> 4           6            2 #> 5           7            1"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"intra-vs-inter-chromosomal","dir":"Articles","previous_headings":"Interpreting Results","what":"Intra vs Inter-chromosomal","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Check balance of intra vs inter contacts if (!is.null(hypergraphData(mc_multi, \"selected\"))) {   type_summary <- hypergraphData(mc_multi, \"selected\") |>     dplyr::distinct(hyperedge_idx, type) |>     dplyr::count(type)    print(type_summary) } #> # A tibble: 2 × 2 #>   type      n #>   <chr> <int> #> 1 inter    10 #> 2 intra    20"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best Practices","title":"Multi-way Contact Analysis with Hypergraphs","text":"Start single chromosome: Easier interpret faster compute Tune bin size: Use resolution_depth vignette find optimal resolution Adjust quantile: Higher (0.9-0.95): strict, fewer high-confidence contacts Lower (0.75-0.85): permissive, capture weaker signals Filter multiway order: Focus specific contact orders targeted analysis Use composite view (facet_chrom = FALSE) multi-chromosome see relationships Weight normalization: Use \"by_order\" compare across different contact orders fairly","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"using-geom_hypergraph-for-custom-plots","dir":"Articles","previous_headings":"","what":"Using geom_hypergraph for Custom Plots","title":"Multi-way Contact Analysis with Hypergraphs","text":"gghypergraph() provides convenient high-level interface, can also use geom_hypergraph() directly customization. useful want : Combine hypergraph ggplot2 layers Create custom faceting layouts Apply custom themes styling Build complex multi-panel figures","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"basic-usage","dir":"Articles","previous_headings":"Using geom_hypergraph for Custom Plots","what":"Basic Usage","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Extract the selected hypergraph data df <- hypergraphData(mc_chr22, \"selected\")  # Create custom x-axis ordering (by genomic position) hyperedge_order <- df |>   dplyr::mutate(chrom_num = as.numeric(gsub(\"\\\\D\", \"\", chrom))) |>   dplyr::group_by(hyperedge_idx) |>   dplyr::summarise(     min_chrom_num = min(chrom_num, na.rm = TRUE),     min_bin = min(bin),     .groups = \"drop\"   ) |>   dplyr::arrange(min_chrom_num, min_bin) |>   dplyr::pull(hyperedge_idx)  df <- df |>   dplyr::mutate(     x = as.numeric(factor(hyperedge_idx, levels = hyperedge_order)),     y = bin   )  # Create plot with geom_hypergraph ggplot2::ggplot(df, ggplot2::aes(x = x, y = y, group = hyperedge_idx)) +   geom_hypergraph(     ggplot2::aes(colour = n_multiways),     line_width = 0.4,     line_alpha = 0.7,     point_size = 2.5   ) +   ggplot2::scale_color_viridis_c(name = \"Contact Order\") +   ggplot2::labs(     title = \"Multi-way Contacts on chr22\",     x = \"Hyperedge\",     y = \"Genomic Position (bin)\"   ) +   ggplot2::theme_minimal() +   ggplot2::theme(     panel.grid.minor = ggplot2::element_blank(),     axis.text.x = ggplot2::element_blank(),     axis.ticks.x = ggplot2::element_blank()   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"multi-chromosome-with-custom-layout","dir":"Articles","previous_headings":"Using geom_hypergraph for Custom Plots","what":"Multi-Chromosome with Custom Layout","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Get multi-chromosome data df_multi <- hypergraphData(mc_multi, \"selected\")  # Order hyperedges hyperedge_order_multi <- df_multi |>   dplyr::mutate(chrom_num = as.numeric(gsub(\"\\\\D\", \"\", chrom))) |>   dplyr::group_by(hyperedge_idx) |>   dplyr::summarise(     min_chrom_num = min(chrom_num, na.rm = TRUE),     min_chrom = dplyr::first(chrom[chrom_num == min_chrom_num]),     min_bin = min(bin[chrom == min_chrom]),     .groups = \"drop\"   ) |>   dplyr::arrange(min_chrom_num, min_bin) |>   dplyr::pull(hyperedge_idx)  df_multi <- df_multi |>   dplyr::mutate(     x = as.numeric(factor(hyperedge_idx, levels = hyperedge_order_multi))   )  # Create faceted plot ggplot2::ggplot(   df_multi,   ggplot2::aes(x = x, y = bin, group = hyperedge_idx) ) +   geom_hypergraph(     ggplot2::aes(colour = weight),     line_width = 0.4,     point_size = 2   ) +   ggplot2::scale_color_gradient(     low = \"lightblue\",     high = \"darkred\",     name = \"Weight\"   ) +   ggplot2::facet_grid(chrom ~ ., scales = \"free_y\", space = \"free_y\") +   ggplot2::labs(     title = \"Multi-way Contacts Across Chromosomes\",     x = \"Hyperedge\",     y = \"Genomic Position\"   ) +   ggplot2::theme_bw() +   ggplot2::theme(     strip.text = ggplot2::element_text(face = \"bold\"),     axis.text.x = ggplot2::element_blank(),     axis.ticks.x = ggplot2::element_blank()   )"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"adding-annotations","dir":"Articles","previous_headings":"Using geom_hypergraph for Custom Plots","what":"Adding Annotations","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Add regions of interest regions_of_interest <- data.frame(   ymin = c(20, 60),   ymax = c(30, 70),   label = c(\"Region A\", \"Region B\") )  ggplot2::ggplot(df, ggplot2::aes(x = x, y = y, group = hyperedge_idx)) +   # Add shaded regions   ggplot2::geom_rect(     data = regions_of_interest,     ggplot2::aes(xmin = -Inf, xmax = Inf, ymin = ymin, ymax = ymax),     fill = \"yellow\", alpha = 0.2, inherit.aes = FALSE   ) +   # Add hypergraph   geom_hypergraph(     ggplot2::aes(colour = n_multiways),     line_width = 0.4,     line_alpha = 0.7   ) +   # Add region labels   ggplot2::geom_text(     data = regions_of_interest,     ggplot2::aes(x = max(df$x) * 0.95, y = (ymin + ymax) / 2, label = label),     hjust = 1, fontface = \"bold\", inherit.aes = FALSE   ) +   ggplot2::scale_color_viridis_c(name = \"Contacts\") +   ggplot2::labs(     title = \"Hypergraph with Annotated Regions\",     x = \"Hyperedge\",     y = \"Genomic Bin\"   ) +   ggplot2::theme_minimal()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"highlighting-specific-hyperedges","dir":"Articles","previous_headings":"Using geom_hypergraph for Custom Plots","what":"Highlighting Specific Hyperedges","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Highlight high-order contacts (≥5-way) df_highlight <- df |>   dplyr::mutate(     is_high_order = n_multiways >= 5,     alpha_value = ifelse(is_high_order, 0.9, 0.3),     line_color = ifelse(is_high_order, \"red\", \"gray70\")   )  ggplot2::ggplot(   df_highlight,   ggplot2::aes(x = x, y = y, group = hyperedge_idx) ) +   geom_hypergraph(     ggplot2::aes(colour = line_color, alpha = alpha_value),     line_width = 0.4,     point_size = 2   ) +   ggplot2::scale_color_identity() +   ggplot2::scale_alpha_identity() +   ggplot2::labs(     title = \"Highlighting High-Order Contacts (≥5-way)\",     subtitle = \"Red = high-order, Gray = lower-order\",     x = \"Hyperedge\",     y = \"Genomic Bin\"   ) +   ggplot2::theme_minimal()"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"geom_hypergraph-parameters","dir":"Articles","previous_headings":"Using geom_hypergraph for Custom Plots","what":"geom_hypergraph Parameters","title":"Multi-way Contact Analysis with Hypergraphs","text":"geom_hypergraph() layer accepts key parameters: line_width: Width hyperedge lines (default: 0.3) line_alpha: Transparency lines (default: 0.6) point_size: Size bin points (default: 2) point_alpha: Transparency points (default: 0.8) colour_by: color (“n_contacts” “none”) can also map aesthetics directly using aes(): colour: Color variable group: Must hyperedge identifier x, y: Position mappings","code":""},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"cleanup","dir":"Articles","previous_headings":"","what":"Cleanup","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"# Remove temporary file unlink(pairs_file)"},{"path":"https://jasonwong-lab.github.io/gghic/articles/hypergraph.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Multi-way Contact Analysis with Hypergraphs","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] gghic_0.2.1   ggplot2_4.0.1 dplyr_1.1.4   #>  #> loaded via a namespace (and not attached): #>  [1] SummarizedExperiment_1.40.0 gtable_0.3.6                #>  [3] rjson_0.2.23                xfun_0.55                   #>  [5] bslib_0.9.0                 htmlwidgets_1.6.4           #>  [7] rhdf5_2.54.1                Biobase_2.70.0              #>  [9] lattice_0.22-7              bitops_1.0-9                #> [11] rhdf5filters_1.22.0         vctrs_0.6.5                 #> [13] tools_4.5.2                 generics_0.1.4              #> [15] parallel_4.5.2              stats4_4.5.2                #> [17] curl_7.0.0                  tibble_3.3.0                #> [19] pkgconfig_2.0.3             Matrix_1.7-4                #> [21] RColorBrewer_1.1-3          cigarillo_1.0.0             #> [23] S7_0.2.1                    desc_1.4.3                  #> [25] S4Vectors_0.48.0            lifecycle_1.0.4             #> [27] compiler_4.5.2              farver_2.1.2                #> [29] Rsamtools_2.26.0            Biostrings_2.78.0           #> [31] textshaping_1.0.4           codetools_0.2-20            #> [33] Seqinfo_1.0.0               InteractionSet_1.38.0       #> [35] htmltools_0.5.9             sass_0.4.10                 #> [37] RCurl_1.98-1.17             yaml_2.3.12                 #> [39] tidyr_1.3.2                 crayon_1.5.3                #> [41] pillar_1.11.1               pkgdown_2.2.0               #> [43] jquerylib_0.1.4             BiocParallel_1.44.0         #> [45] cachem_1.1.0                DelayedArray_0.36.0         #> [47] abind_1.4-8                 tidyselect_1.2.1            #> [49] digest_0.6.39               purrr_1.2.0                 #> [51] restfulr_0.0.16             labeling_0.4.3              #> [53] fastmap_1.2.0               grid_4.5.2                  #> [55] cli_3.6.5                   SparseArray_1.10.8          #> [57] magrittr_2.0.4              S4Arrays_1.10.1             #> [59] utf8_1.2.6                  dichromat_2.0-0.1           #> [61] XML_3.99-0.20               withr_3.0.2                 #> [63] scales_1.4.0                rmarkdown_2.30              #> [65] XVector_0.50.0              httr_1.4.7                  #> [67] matrixStats_1.5.0           ragg_1.5.0                  #> [69] evaluate_1.0.5              knitr_1.51                  #> [71] BiocIO_1.20.0               GenomicRanges_1.62.1        #> [73] IRanges_2.44.0              viridisLite_0.4.2           #> [75] rtracklayer_1.70.1          rlang_1.1.6                 #> [77] Rcpp_1.1.0                  glue_1.8.0                  #> [79] BiocGenerics_0.56.0         jsonlite_2.0.0              #> [81] R6_2.6.1                    Rhdf5lib_1.32.0             #> [83] GenomicAlignments_1.46.0    MatrixGenerics_1.22.0       #> [85] systemfonts_1.3.1           fs_1.6.6"},{"path":"https://jasonwong-lab.github.io/gghic/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Minghao Jiang. Author, maintainer, contributor, copyright holder.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jiang M, Jing D, Wong JWH (2024). “gghic: Versatile R Package Exploring Visualizing 3D Genome Organization.” arXiv preprint. doi:10.48550/arXiv.2412.03005, https://arxiv.org/abs/2412.03005.","code":"@Article{,   title = {gghic: A Versatile R Package for Exploring and Visualizing 3D Genome Organization},   author = {Minghao Jiang and Duohui Jing and Jason W. H. Wong},   journal = {arXiv preprint},   year = {2024},   doi = {10.48550/arXiv.2412.03005},   url = {https://arxiv.org/abs/2412.03005}, }"},{"path":"https://jasonwong-lab.github.io/gghic/index.html","id":"gghic","dir":"","previous_headings":"","what":"Visualizing Genomic Interaction Data Using ggplot2","title":"Visualizing Genomic Interaction Data Using ggplot2","text":"gghic powerful flexible R package visualizing 3D genome organization Hi-C multi-way contact data. Built ggplot2, provides publication-ready visualizations minimal code maintaining full customization capabilities.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Visualizing Genomic Interaction Data Using ggplot2","text":"🎨 Intuitive API - Simple high-level functions sensible defaults 🧬 Comprehensive - Visualize Hi-C heatmaps, TADs, loops, genes, signal tracks 🚀 Memory Efficient - Focused data loading large datasets 📊 Publication Ready - Generate high-quality figures minimal effort 🔧 Customizable - Full ggplot2 compatibility advanced styling 🧪 Multi-way Contacts - Native support Pore-C multi-contact data","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/index.html","id":"from-github","dir":"","previous_headings":"Installation","what":"From GitHub","title":"Visualizing Genomic Interaction Data Using ggplot2","text":"Install development version using devtools:","code":"if (!require(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\") if (!require(\"devtools\", quietly = TRUE)) install.packages(\"devtools\")  # Install gghic devtools::install_github(\"jasonwong-lab/gghic\")"},{"path":"https://jasonwong-lab.github.io/gghic/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Visualizing Genomic Interaction Data Using ggplot2","text":"Get started gghic Hi-C/-like data visualization Hi-C/-like data quality assessment Pore-C/-like multi-way contact analysis","code":""},{"path":"https://jasonwong-lab.github.io/gghic/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting Help","title":"Visualizing Genomic Interaction Data Using ggplot2","text":"🐛 Bug Reports: GitHub Issues 💡 Feature Requests: GitHub Discussions Open issue questions support Email mjhk@connect.hku.hk direct inquiries","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts-class.html","id":null,"dir":"Reference","previous_headings":"","what":"ChromatinContacts S4 class — ChromatinContacts-class","title":"ChromatinContacts S4 class — ChromatinContacts-class","text":"S4 class representing chromatin contact data cooler files (.cool .mcool). Memory-efficient pointer loads data import() called.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ChromatinContacts S4 class — ChromatinContacts-class","text":"Key features: Memory-efficient: loads data needed Flexible focusing: subset regions import Feature integration: automatically subsets attached features Multi-resolution: supports .cool .mcool files Focus parameter options: Single region: \"chr1:1000000-2000000\" Whole chromosome: \"chr1\" Multiple regions (combinations): \"chr1 | chr2\" Inter-chromosomal : \"chr1 & chr2\" GInteractions object programmatic control","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"ChromatinContacts S4 class — ChromatinContacts-class","text":"cooler_path Character. Path cooler file. resolution Integer NULL. Resolution base pairs (required .mcool files). focus GInteractions NULL. Genomic regions interest (NULL genome-wide). interactions GInteractions NULL. Imported Hi-C interaction data. seqinfo Seqinfo NULL. Genome assembly sequence information. compartments GRanges NULL. /B compartment annotations. TADs GRanges NULL. Topologically associating domains. loops GInteractions NULL. Chromatin loop calls. multi_contacts GRanges NULL. Multi-way contact regions. tracks GRangesList. Genomic signal tracks (ChIP-seq, ATAC-seq, etc.).","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ChromatinContacts S4 class — ChromatinContacts-class","text":"","code":"if (FALSE) { # \\dontrun{ # Create and import cc <- ChromatinContacts(\"data.cool\") |> import()  # Focus on specific region cc <- ChromatinContacts(\"data.cool\", focus = \"chr1:1-2e6\") |> import()  # Multi-resolution cooler cc <- ChromatinContacts(\"data.mcool\", resolution = 10000) |> import()  # Add features features(cc, \"TADs\") <- tads_granges features(cc, \"loops\") <- loops_ginteractions } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a ChromatinContacts object — ChromatinContacts","title":"Create a ChromatinContacts object — ChromatinContacts","text":"Constructor ChromatinContacts cooler files (.cool .mcool).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a ChromatinContacts object — ChromatinContacts","text":"","code":"ChromatinContacts(cooler_path, focus = NULL, resolution = NULL)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a ChromatinContacts object — ChromatinContacts","text":"cooler_path Character. Path .cool .mcool file. focus Character, GInteractions, NULL. Genomic region(s) focus: Single region: \"chr1\" \"chr1:1-1000000\" Inter-chromosomal: \"chr1&chr2\" (excludes diagonal) combinations: \"chr1|chr2\" (includes intra-chromosomal) Multiple: c(\"chr1&chr2\", \"chr3|chr4\") NULL genome-wide (default) resolution Integer. Resolution base pairs (required .mcool).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a ChromatinContacts object — ChromatinContacts","text":"ChromatinContacts object.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/ChromatinContacts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a ChromatinContacts object — ChromatinContacts","text":"","code":"if (FALSE) { # \\dontrun{ # Genome-wide .cool file cc <- ChromatinContacts(\"file.cool\")  # Multi-resolution .mcool cc <- ChromatinContacts(\"file.mcool\", resolution = 5000L)  # Focus on chromosome cc <- ChromatinContacts(\"file.cool\", focus = \"chr1\")  # Inter-chromosomal between chr1 and chr2 cc <- ChromatinContacts(\"file.cool\", focus = \"chr1&chr2\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":null,"dir":"Reference","previous_headings":"","what":"MultiWayContacts S4 class — MultiWayContacts-class","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"S4 class multi-way chromatin contacts long-read sequencing (Pore-C, Micro-C XL). Represents interactions hypergraphs reads connect multiple genomic loci. Constructor MultiWayContacts .pairs files.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"","code":"MultiWayContacts(pairs_path = NULL, focus = NULL)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"pairs_path Character. Path .pairs .pairs.gz file. focus Character NULL. Chromosome(s) analyze (NULL genome-wide).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"Workflow: Create → Import → Build → Tidy → Select → Visualize Key features: Hypergraph representation: reads hyperedges connecting bins Sparse matrix storage memory efficiency Multiple weight normalizations Flexible filtering order, chromosome, weight","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"pairs_path Character. Path .pairs file. pairs Data.frame NULL. Loaded pairs data. bin_size Integer NULL. Genomic bin size base pairs. focus Character NULL. Chromosome(s) analyze. hypergraph dgCMatrix NULL. Sparse incidence matrix (bins × hyperedges). weights Data.frame. Hyperedge weights normalizations (raw, log, by_order, minmax). bin_info Data.frame. Genomic bin information. hyperedge_reads SimpleList. Read names per hyperedge. multiways Numeric. Contact count per hyperedge. tidied_hypergraph Data.frame NULL. Long-format hypergraph. select_hypergraph Data.frame NULL. Selected hyperedges plotting.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/MultiWayContacts-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MultiWayContacts S4 class — MultiWayContacts-class","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage mc <- MultiWayContacts(\"sample.pairs.gz\")  # Focus on chromosome mc <- MultiWayContacts(\"sample.pairs.gz\", focus = \"chr1\")  # Complete workflow mc <- MultiWayContacts(\"sample.pairs.gz\", focus = \"chr1\") |>   import() |>   build(bin_size = 1000000L) |>   tidy() |>   select(n_intra = 10, n_inter = 5) |>   gghypergraph() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/as_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert ChromatinContacts to tibble — as_tibble","title":"Convert ChromatinContacts to tibble — as_tibble","text":"Converts interaction feature data ChromatinContacts tibble.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/as_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert ChromatinContacts to tibble — as_tibble","text":"","code":"as_tibble(x, which = \"interactions\")  # S4 method for class 'ChromatinContacts' as_tibble(   x,   which = c(\"interactions\", \"compartments\", \"TADs\", \"loops\", \"multi_contacts\") )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/as_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert ChromatinContacts to tibble — as_tibble","text":"x ChromatinContacts object. Character. Data convert: \"interactions\" (default), feature name (\"TADs\", \"loops\", \"compartments\", \"multi_contacts\").","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/as_tibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert ChromatinContacts to tibble — as_tibble","text":"Tibble requested data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/as_tibble.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert ChromatinContacts to tibble — as_tibble","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"sample.cool\") |> import() df <- as_tibble(cc) tads_df <- as_tibble(cc, which = \"TADs\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":null,"dir":"Reference","previous_headings":"","what":"Build hypergraph from multi-way contacts — build","title":"Build hypergraph from multi-way contacts — build","text":"Constructs hypergraph pairs data binning, filtering, building sparse incidence matrix.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build hypergraph from multi-way contacts — build","text":"","code":"build(x, ...)  # S4 method for class 'MultiWayContacts' build(x, bin_size = 1000000L, quantile = 0.85, min_multiway = 2)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build hypergraph from multi-way contacts — build","text":"x MultiWayContacts object loaded pairs. ... Additional arguments (used). bin_size Integer. Bin size base pairs (default: 1000000L). quantile Numeric (0-1). Quantile threshold filtering bin pairs contact frequency (default: 0.85). min_multiway Integer. Minimum contacts per hyperedge retain (default: 2).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build hypergraph from multi-way contacts — build","text":"MultiWayContacts populated hypergraph slots: hypergraph (incidence matrix), weights (normalizations), bin_info, hyperedge_reads, multiways, bin_size.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build hypergraph from multi-way contacts — build","text":"Steps: bin positions → filter quantile → build incidence matrix → deduplicate patterns → filter min_multiway. Weight normalizations: raw (frequency), log (log-transformed), by_order (normalized within order), minmax (scaled [0,1]). Higher quantile = stricter filtering. Typical: 0.8-0.95.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/build.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build hypergraph from multi-way contacts — build","text":"","code":"if (FALSE) { # \\dontrun{ # Default parameters mc <- MultiWayContacts(\"sample.pairs.gz\") |> import() |> build()  # Custom parameters mc <- mc |> build(bin_size = 500000L, quantile = 0.9, min_multiway = 3) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"Transforms multi-way chromatin contact reads (concatemers Pore-C, Tri-C, Multi-C, etc.) traditional pairwise Hi-C format. Generates pairwise combinations fragments within read, bins specified resolution, creates GInteractions object compatible standard Hi-C analysis tools.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"","code":"concatemers2Gis(grs, region = NULL, bin_size = 1e+05, read_group = \"read_name\")"},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"grs GRanges object containing concatemer fragment coordinates. Must include metadata column identifying fragments belong read (specified read_group parameter). region GRanges object defining genomic region(s) interest. reads overlapping region included (default: NULL genome-wide analysis). bin_size Integer. Genomic bin size base pairs aggregating contacts. Typical values: 5000-1000000 (default: 100000 = 100kb). read_group Character. Name metadata column grs contains read identifiers grouping fragments sequencing read (default: \"read_name\").","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"GInteractions object containing: Binned pairwise interactions concatemers count metadata column: number reads supporting interaction Compatible gghic(), ChromatinContacts(), Hi-C tools","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"algorithm","dir":"Reference","previous_headings":"","what":"Algorithm","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"Group fragments read identifier (read_group) read ≥2 fragments, generate pairwise combinations Bin anchors pair specified resolution Aggregate identical bin pairs, counting supporting reads Remove self-interactions (bin pairs)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"multi-way-to-pairwise-conversion","dir":"Reference","previous_headings":"","what":"Multi-way to pairwise conversion","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"read contacting N fragments generates N×(N-1)/2 pairwise interactions. example: 2-way contact → 1 pair 3-way contact → 3 pairs 4-way contact → 6 pairs inflation considered comparing multi-way traditional Hi-C datasets.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"memory-considerations","dir":"Reference","previous_headings":"","what":"Memory considerations","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"large datasets, use region parameter process chromosomes individually reduce memory usage.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/concatemers2gis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert multi-way concatemer reads to pairwise Hi-C interactions — concatemers2Gis","text":"","code":"if (FALSE) { # \\dontrun{ # Load concatemer data concatemers <- readRDS(\"concatemers.rds\")  # Convert to pairwise at 100kb resolution gis <- concatemers2Gis(concatemers, bin_size = 100000)  # Visualize as Hi-C map gghic(gis)  # Focus on specific region at higher resolution region <- GRanges(\"chr1:1000000-5000000\") gis_region <- concatemers2Gis(   concatemers,   region = region,   bin_size = 10000 )  # Process by chromosome to manage memory chr_gis <- lapply(paste0(\"chr\", 1:22), function(chr) {   region <- GRanges(seqnames = chr,                     ranges = IRanges(1, 250000000))   concatemers2Gis(concatemers, region, bin_size = 100000) })  # Use with ChromatinContacts gis_all <- do.call(c, chr_gis) # Then visualize or analyze } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":null,"dir":"Reference","previous_headings":"","what":"Set genomic features in ChromatinContacts object — features<-","title":"Set genomic features in ChromatinContacts object — features<-","text":"Assigns updates genomic features (TADs, loops, compartments, tracks) ChromatinContacts object. Features automatically subsetted overlap loaded interactions, ensuring relevant data retained.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set genomic features in ChromatinContacts object — features<-","text":"","code":"features(x, name, ...) <- value  # S4 method for class 'ChromatinContacts,character,GRanges' features(x, name, ...) <- value  # S4 method for class 'ChromatinContacts,character,GInteractions' features(x, name, ...) <- value  # S4 method for class 'ChromatinContacts,character,GRangesList' features(x, name, ...) <- value  # S4 method for class 'ChromatinContacts,character,list' features(x, name, ...) <- value"},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set genomic features in ChromatinContacts object — features<-","text":"x ChromatinContacts object imported interaction data. name Character. Feature slot name: \"compartments\": /B compartment annotations (GRanges) \"TADs\": Topologically associating domains (GRanges) \"multi_contacts\": Multi-way contact regions (GRanges) \"loops\": Chromatin loop calls (GInteractions) \"tracks\": Genomic signal tracks (GRangesList) ... Additional arguments (currently used). value Feature data appropriate type: GRanges: compartments, TADs, multi_contacts GInteractions: loops GRangesList list: tracks (converted GRangesList)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set genomic features in ChromatinContacts object — features<-","text":"ChromatinContacts object updated features slot. modified object returned invisibly support piping.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"requirements","dir":"Reference","previous_headings":"","what":"Requirements","title":"Set genomic features in ChromatinContacts object — features<-","text":"Interactions must imported assigning features. Use import() first.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"automatic-subsetting","dir":"Reference","previous_headings":"","what":"Automatic subsetting","title":"Set genomic features in ChromatinContacts object — features<-","text":"Features automatically filtered retain elements overlapping loaded Hi-C interaction data. prevents visualization errors reduces memory usage.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"track-naming","dir":"Reference","previous_headings":"","what":"Track naming","title":"Set genomic features in ChromatinContacts object — features<-","text":"providing tracks GRangesList, ensure named proper labeling plots. Unnamed tracks receive default names (track1, track2, etc.).","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/features-set.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set genomic features in ChromatinContacts object — features<-","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data first cc <- ChromatinContacts(\"sample.cool\") |> import()  # Add TADs from BED file features(cc, \"TADs\") <- rtracklayer::import(\"TADs.bed\")  # Add chromatin loops features(cc, \"loops\") <- loops_ginteractions  # Add multiple ChIP-seq tracks features(cc, \"tracks\") <- GRangesList(   H3K27ac = rtracklayer::import(\"H3K27ac.bw\"),   H3K4me3 = rtracklayer::import(\"H3K4me3.bw\") )  # Add compartments features(cc, \"compartments\") <- compartment_gr  # Chain operations cc <- ChromatinContacts(\"sample.cool\") |>   import() |>   `features<-`(\"TADs\", value = tads) |>   `features<-`(\"loops\", value = loops) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/features.html","id":null,"dir":"Reference","previous_headings":"","what":"Get genomic features — features","title":"Get genomic features — features","text":"Retrieves specific genomic features.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get genomic features — features","text":"","code":"features(x, name)  # S4 method for class 'ChromatinContacts,character' features(x, name)  # S4 method for class 'ChromatinContacts,missing' features(x)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get genomic features — features","text":"x ChromatinContacts object. name Character. Feature name: \"compartments\", \"TADs\", \"loops\", \"multi_contacts\". missing, returns SimpleList.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get genomic features — features","text":"GRanges (TADs, compartments, multi_contacts), GInteractions (loops), SimpleList (features).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/features.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get genomic features — features","text":"","code":"if (FALSE) { # \\dontrun{ tads <- features(cc, \"TADs\") loops <- features(cc, \"loops\") all_features <- features(cc) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/focus.html","id":null,"dir":"Reference","previous_headings":"","what":"Get focus regions — focus","title":"Get focus regions — focus","text":"Retrieves focus regions ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/focus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get focus regions — focus","text":"","code":"focus(x)  # S4 method for class 'ChromatinContacts' focus(x)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/focus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get focus regions — focus","text":"x ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/focus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get focus regions — focus","text":"GInteractions (focus regions) NULL (genome-wide).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/focus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get focus regions — focus","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"sample.cool\", focus = \"chr1\") focus(cc) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Add gene annotation tracks to Hi-C plots — geom_annotation","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Displays gene models annotation tracks Hi-C heatmaps, showing gene structure exons, introns, UTRs, strand orientation. Gene annotations automatically retrieved GTF files TxDb objects positioned Hi-C plot gene symbols labeled underneath. function supports two visualization styles: \"basic\" (detailed exon/intron structure) \"arrow\" (simplified arrow representation indicating strand direction).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"","code":"geom_annotation(   mapping = NULL,   data = NULL,   stat = StatAnnotation,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   txdb = NULL,   tx2gene = NULL,   gtf_path = NULL,   width_ratio = 1/50,   spacing_ratio = 1/3,   maxgap = -1,   include_ncrna = TRUE,   style = c(\"basic\", \"arrow\"),   gene_symbols = NULL,   chrom_prefix = TRUE,   fontsize = 10,   colour = \"#48CFCB\",   fill = \"#48CFCB\",   draw_boundary = TRUE,   boundary_colour = \"black\",   linetype = \"dashed\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). txdb TxDb object GenomicFeatures package containing transcript annotations. Must provided together tx2gene gtf_path specified. Default NULL. tx2gene data frame tibble mapping transcript information gene information. Required using txdb parameter. include following columns: chrom: Chromosome number name gene_id: Entrez gene ID unique gene identifier gene_symbol: Common gene symbol name (e.g., \"TP53\", \"BRCA1\") tx_id: Entrez transcript ID unique transcript identifier tx_name: Name transcript gene_type: Gene biotype (e.g., \"protein_coding\", \"lncRNA\") tx_type: Transcript biotype Default NULL. gtf_path Character string specifying path GTF/GFF file. function automatically parse GTF file generate txdb tx2gene objects. Parsed data cached speed subsequent calls. Either gtf_path txdb tx2gene must provided. Default NULL. width_ratio Numeric value controlling height gene track relative Hi-C plot height. Smaller values create thinner tracks. Default 1/50 (2% Hi-C plot height). spacing_ratio Numeric value controlling vertical spacing gene tracks proportion track height. Larger values increase spacing. Default 1/3 (33% track height). maxgap Integer specifying maximum genomic distance (bp) genes horizontal line. Genes within distance placed separate lines prevent overlap. Set -1 automatic spacing. Default -1. include_ncrna Logical indicating whether include non-coding RNA genes (lncRNA, miRNA, etc.) annotation track. Set FALSE show protein-coding genes. Default TRUE. style Character string specifying visualization style. Options: \"basic\": Shows detailed gene structure distinct exons (thick boxes), introns (thin lines directional arrows), UTRs (thin boxes) \"arrow\": Simplified representation showing gene single arrow pointing direction transcription (5' 3') Default \"basic\". gene_symbols Character vector specific gene symbols display. provided, genes shown annotation track. Useful highlighting genes interest. Default NULL (show genes). chrom_prefix Logical indicating whether chromosome names include \"chr\" prefix (e.g., \"chr1\" vs \"1\"). match naming convention Hi-C data. Default TRUE. fontsize Numeric value specifying font size gene symbol labels. Default 10. colour Character string specifying outline color gene features. Default \"#48CFCB\" (teal). fill Character string specifying fill color gene features (exons, UTRs, arrows). Default \"#48CFCB\" (teal). draw_boundary Logical indicating whether draw vertical boundary lines chromosomes multi-chromosome displays. Default TRUE. boundary_colour Character string specifying color chromosome boundary lines. Default \"black\". linetype Character string integer specifying line type chromosome boundaries. Default \"dashed\". ... Additional parameters (currently ignored).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"ggplot2 layer object can added gghic plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required Aesthetics","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"geom inherits aesthetics Hi-C data requires: seqnames1, seqnames2: Chromosome names start1, start2: Start positions end1, end2: End positions","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"gene-annotation-sources","dir":"Reference","previous_headings":"","what":"Gene Annotation Sources","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Gene annotations can provided three ways: GTF file via gtf_path: convenient, automatically parsed cached TxDb + tx2gene: Pre-processed annotations custom databases Downloaded online repositories (Ensembl, UCSC, GENCODE)","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"basic-style-style-basic-","dir":"Reference","previous_headings":"","what":"Basic Style (style = \"basic\")","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Shows detailed gene structure: Coding exons (CDS): Thick rectangles full color UTRs: Thinner rectangles showing 5' 3' untranslated regions Introns: Thin lines small directional arrows indicating strand ncRNAs: Thin rectangles non-coding transcripts (include_ncrna = TRUE)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"arrow-style-style-arrow-","dir":"Reference","previous_headings":"","what":"Arrow Style (style = \"arrow\")","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Simplified representation: gene shown single arrow shape Arrow points 5' 3' direction compact, suitable dense genomic regions","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"gene-placement-and-layout","dir":"Reference","previous_headings":"","what":"Gene Placement and Layout","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Genes automatically arranged multiple horizontal lines prevent overlap Genes closer maxgap placed separate lines Gene symbols centered gene Multiple tracks vertically stacked spacing controlled spacing_ratio","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"multi-chromosome-display","dir":"Reference","previous_headings":"","what":"Multi-Chromosome Display","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"displaying multiple chromosomes: Coordinates automatically adjusted proper alignment Vertical boundary lines separate chromosomes (draw_boundary = TRUE) Gene labels maintain proper positioning across chromosome boundaries","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"gene-filtering","dir":"Reference","previous_headings":"","what":"Gene Filtering","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"Use gene_symbols parameter highlight specific genes: Provide character vector gene names matching genes displayed Useful focusing candidate genes pathways","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"performance-considerations","dir":"Reference","previous_headings":"","what":"Performance Considerations","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"GTF parsing cached faster subsequent loading large genomic regions, consider filtering genes gene_symbols Setting include_ncrna = FALSE reduces number features Arrow style renders faster basic style dense regions","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_annotation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add gene annotation tracks to Hi-C plots — geom_annotation","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage with GTF file cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  gtf_file <- \"path/to/genes.gtf\" gghic(cc) + geom_annotation(gtf_path = gtf_file)  # Filter specific genes of interest gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     gene_symbols = c(\"BRCA1\", \"TP53\", \"MYC\")   )  # Arrow style with custom colors gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     style = \"arrow\",     colour = \"darkblue\",     fill = \"lightblue\",     fontsize = 8   )  # Exclude non-coding RNAs for cleaner view gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     include_ncrna = FALSE   )  # Custom track dimensions gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     width_ratio = 1 / 40,    # Taller tracks     spacing_ratio = 1 / 2     # More spacing   )  # Using TxDb object directly library(TxDb.Hsapiens.UCSC.hg38.knownGene) txdb <- TxDb.Hsapiens.UCSC.hg38.knownGene tx2gene <- read.csv(\"tx2gene_mapping.csv\")  gghic(cc) +   geom_annotation(txdb = txdb, tx2gene = tx2gene)  # Multiple genes with custom styling candidates <- c(\"PDGFRA\", \"KIT\", \"KDR\", \"FLT1\") gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     gene_symbols = candidates,     colour = \"red\",     fill = \"pink\",     fontsize = 12   )  # Without chromosome prefix (e.g., \"1\" instead of \"chr1\") gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     chrom_prefix = FALSE   )  # Multi-chromosome with boundaries cc_multi <- ChromatinContacts(\"path/to/cooler.cool\",                               focus = c(\"chr4\", \"chr8\")) |>   import() gghic(cc_multi) +   geom_annotation(     gtf_path = gtf_file,     draw_boundary = TRUE,     boundary_colour = \"gray50\",     linetype = \"dotted\"   )  # Protein-coding genes only with arrow style gghic(cc) +   geom_annotation(     gtf_path = gtf_file,     include_ncrna = FALSE,     style = \"arrow\",     fill = \"#2E86AB\"   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"Displays multi-way chromatin contact reads (concatemers) horizontal bars positioned Hi-C contact map. bar represents genomic fragments contacted single long sequencing read, gaps shown connecting lines. Useful visualizing Pore-C, Tri-C, similar multi-way contact data genomic context.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"","code":"geom_concatemer(   mapping = NULL,   data = NULL,   stat = StatConcatemer,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   width_ratio = 1/100,   spacing_ratio = 1/5,   concatemer_grs = NULL,   concatemer_path = NULL,   group_identifier = NULL,   fill = \"black\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). width_ratio Numeric. Height concatemer track relative Hi-C plot height (default: 1/100). spacing_ratio Numeric. Spacing concatemer tracks fraction track height (default: 1/5). concatemer_grs GRanges object containing concatemer fragment coordinates. Must include metadata column specified group_identifier. Either concatemer_grs concatemer_path required (default: NULL). concatemer_path Character. Path file containing concatemer data. Either concatemer_grs concatemer_path required (default: NULL). group_identifier Character. Name metadata column concatemer_grs identifies fragments belong read (e.g., \"read_name\") (required). fill Character. Fill color concatemer bars (default: \"black\"). ... Parameters ignored.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"ggplot object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"Requires following aesthetics: seqnames1 start1 end1 seqnames2 start2 end2","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize multi-way contact concatemers below Hi-C map — geom_concatemer","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Load concatemer data (multi-way contacts from Pore-C) concatemers <- rtracklayer::import(\"path/to/concatemers.bed\")  # Add concatemer tracks to Hi-C plot gghic(cc) +   geom_concatemer(     concatemer_grs = concatemers,     group_identifier = \"read_name\",     fill = \"blue\"   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize concatemers (a second version) — geom_concatemer2","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"Another version geom_concatemer() requires Hi-C plot drawn first takes direct data frame input. Displays multi-way contact reads horizontal bars Hi-C heatmap.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"","code":"geom_concatemer2(   mapping = NULL,   data = NULL,   stat = StatConcatemer2,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = FALSE,   check_concatemers = TRUE,   width_ratio = 1/100,   spacing_ratio = 1/5,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). check_concatemers Whether subset concatemers according main heatmap's range. Default TRUE. width_ratio ratio width concatemer track relative height Hi-C plot. Default 1/100. spacing_ratio ratio spacing two tracks. Default 1/5. ... Parameters ignored.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"ggplot object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"Requires following aesthetics: seqnames start end read_group","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_concatemer2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize concatemers (a second version) — geom_concatemer2","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Load concatemer data concat_df <- rtracklayer::import(\"path/to/concatemers.bed\") |>   as.data.frame()  concat_df <- as.data.frame(concatemers)  # Custom styling gghic(cc) +   geom_concatemer2(     data = concat_df,     aes(       seqnames = seqnames,       start = start,       end = end,       read_group = read_name,       fill = read_name     ),     width_ratio = 1 / 80,     spacing_ratio = 1 / 3   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_hic — geom_hic","title":"geom_hic — geom_hic","text":"Creates Hi-C contact heatmap layer diamond-shaped tiles.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_hic — geom_hic","text":"","code":"geom_hic(   mapping = NULL,   data = NULL,   stat = StatHic,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   rasterize = TRUE,   dpi = 300,   dev = \"cairo\",   scale = 1,   draw_boundary = TRUE,   boundary_colour = \"black\",   linetype = \"dashed\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_hic — geom_hic","text":"mapping Aesthetic mappings ggplot2::aes(). data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). rasterize Logical. Rasterize performance (default: TRUE). dpi Numeric. Rasterization resolution (default: 300). dev Character. Graphics device (default: \"cairo\"). scale Numeric. Rasterization scaling (default: 1). draw_boundary Logical. Draw chromosome boundaries (default: TRUE). boundary_colour Character. Boundary color (default: \"black\"). linetype Boundary line type (default: \"dashed\"). ... Additional parameters (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_hic — geom_hic","text":"ggplot2 layer.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"geom_hic — geom_hic","text":"Transforms interaction data diamond tiles 45°, creating characteristic triangular Hi-C visualization. Required aesthetics: seqnames1, start1, end1, seqnames2, start2, end2, fill","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"geom_hic — geom_hic","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"file.cool\") |> import() library(ggplot2) ggplot() +   geom_hic(     data = scaleData(cc[\"chr4\"], \"balanced\", log10),     aes(seqnames1 = seqnames1, start1 = start1, end1 = end1,         seqnames2 = seqnames2, start2 = start2, end2 = end2, fill = score)   ) + theme_hic() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"Creates flipped (inverted) Hi-C contact heatmap positioned main plot. Useful comparing two datasets showing data different color scales/transformations.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"","code":"geom_hic_under(   mapping = NULL,   data = NULL,   stat = StatHicUnder,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   rasterize = TRUE,   dpi = 300,   dev = \"cairo\",   scale = 1,   draw_boundary = TRUE,   boundary_colour = \"black\",   linetype = \"dashed\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"mapping Set aesthetic mappings created ggplot2::aes(). Must include fill aesthetic. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). rasterize Logical. Rasterize performance (default: TRUE). dpi Numeric. Rasterization resolution (default: 300). dev Character. Graphics device rasterization (default: \"cairo\"). scale Numeric. Rasterization scaling factor (default: 1). draw_boundary Logical. Draw chromosome boundaries multi-chromosome plots (default: TRUE). boundary_colour Character. Boundary line color (default: \"black\"). linetype Boundary line type (default: \"dashed\"). ... Additional parameters (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"ggplot2 layer inverted Hi-C heatmap.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required aesthetics","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"seqnames1, start1, end1: First anchor coordinates seqnames2, start2, end2: Second anchor coordinates fill: Color scale values","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"geom requires main Hi-C plot created geom_hic() first. inverted heatmap automatically positioned , using independent color scales via fill2 aesthetic.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"common-use-cases","dir":"Reference","previous_headings":"","what":"Common use cases","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"Compare two experimental conditions Show raw vs. normalized data Display data different color scales","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hic_under.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize inverted Hi-C heatmap below main contact map — geom_hic_under","text":"","code":"if (FALSE) { # \\dontrun{ # Compare two datasets cc1 <- ChromatinContacts(\"sample1.cool\") |> import() cc2 <- ChromatinContacts(\"sample2.cool\") |> import()  library(ggplot2) ggplot() +   geom_hic(data = scaleData(cc1, \"balanced\", log10),            aes(seqnames1 = seqnames1, start1 = start1, end1 = end1,                seqnames2 = seqnames2, start2 = start2, end2 = end2,                fill = score)) +   geom_hic_under(data = scaleData(cc2, \"balanced\", log10),                  aes(seqnames1 = seqnames1, start1 = start1, end1 = end1,                      seqnames2 = seqnames2, start2 = start2, end2 = end2,                      fill2 = score)) +   scale_fill_viridis_c() +   scale_fill2_viridis_c(option = \"magma\") # Load two Hi-C datasets for comparison cc1 <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Simulate a second dataset (in practice, load a different sample) cc2 <- cc1  # Compare two Hi-C maps with different color scales library(ggplot2) ggplot() +   geom_hic(     data = scaleData(cc1, \"balanced\", log10),     aes(       seqnames1 = seqnames1, start1 = start1, end1 = end1,       seqnames2 = seqnames2, start2 = start2, end2 = end2, fill = score     )   ) +   geom_hic_under(     data = scaleData(cc2, \"balanced\", log10),     aes(       seqnames1 = seqnames1, start1 = start1, end1 = end1,       seqnames2 = seqnames2, start2 = start2, end2 = end2, fill2 = score     )   ) |>   renameGeomAes(new_aes = c(\"fiil\" = \"fill2\")) +   scale_fill_gradientn(     aesthetics = \"fill2\", colors = c(\"white\", \"blue\"), name = \"Sample 2\"   ) +   theme_hic() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"Creates hypergraph visualization multi-way chromatin contacts genomic bins displayed points (nodes) reads shown vertical lines (hyperedges) connecting multiple bins.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"","code":"geom_hypergraph(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   line_width = 0.3,   line_alpha = 0.6,   point_size = 2,   point_alpha = 0.8,   colour_by = \"n_contacts\",   palette = \"viridis\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"mapping Set aesthetic mappings created aes(). x, y, group used. data data frame hypergraph_to_tidy(). stat statistical transformation use data. Default: \"identity\". position Position adjustment. Default: \"identity\". na.rm FALSE (default), missing values removed warning. show.legend Logical. layer included legends? inherit.aes FALSE, overrides default aesthetics. line_width Numeric line width hyperedges. Default: 0.3. line_alpha Numeric transparency lines. Default: 0.6. point_size Numeric size bin points. Default: 2. point_alpha Numeric transparency points. Default: 0.8. colour_by Character: \"n_contacts\" \"none\". Default: \"n_contacts\". palette Character: ggplot2 colour palette. Default: \"viridis\". ... Additional arguments passed layer.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"geom creates specialized visualization multi-way chromatin contacts Pore-C/HiPore-C data. visualization shows: Y-axis: Genomic bins (sorted position) X-axis: Individual reads (ordered first appearance) Lines: Connect bins contacted single read Points: Individual bin positions colour: Number contacts per read (optional) visualization similar Sankey diagram specialized multi-way genomic interactions.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"geom_hypergraph() understands following aesthetics: - x (required): Read index position - y (required): Bin position - group (required): Read identifier - colour (optional): Number contacts per read","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_hypergraph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize Multi-way Contacts as Hypergraph — geom_hypergraph","text":"","code":"if (FALSE) { # \\dontrun{ # Build hypergraph hg <- build_hypergraph(   pairs = pairs_df,   bin_size = 100000,   chrom = \"chr22\",   quantile = 0.85,   min_multiway = 3 )  # Convert to tidy format df <- hypergraph_to_tidy(hg, max_reads = 100)  # Create visualization ggplot(df, aes(x = read_idx, y = bin, group = read_idx)) +   geom_hypergraph(aes(colour = n_contacts)) +   labs(title = \"Multi-way Contacts on chr22\") +   theme_minimal()  # Without colouring ggplot(df, aes(x = read_idx, y = bin, group = read_idx)) +   geom_hypergraph(colour_by = \"none\") +   theme_minimal() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"Displays chromosome ideograms (cytogenetic band representations) Hi-C contact map, showing genomic context Giemsa staining patterns highlighting displayed region. Ideograms provide visual reference chromosome structure, centromeres, cytogenetic landmarks.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"","code":"geom_ideogram(   mapping = NULL,   data = NULL,   stat = StatIdeogram,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   genome = \"hg19\",   chrom_prefix = TRUE,   highlight = TRUE,   show_coord = FALSE,   width_ratio = 1/30,   length_ratio = 0.8,   fontsize = 10,   colour = \"red\",   fill = \"#FFE3E680\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). genome Character. Genome assembly version retrieving cytogenetic band information UCSC. Supported genomes include: \"hg38\": Human (GRCh38/hg38) \"hg19\": Human (GRCh37/hg19) (default) \"mm10\": Mouse (GRCm38) \"mm39\": Mouse (GRCm39) UCSC genome assemblies cytoBand tables chrom_prefix Logical. Whether chromosome names data include \"chr\" prefix (e.g., \"chr1\" vs \"1\"). Set FALSE Ensembl-style naming (default: TRUE). highlight Logical. Draw colored outline around displayed genomic region ideogram emphasize Hi-C map extent (default: TRUE). show_coord Logical. Display genomic coordinates (start-end) next chromosome names ideogram (default: FALSE). Useful showing exact region boundaries. width_ratio Numeric. Height ideogram relative Hi-C plot height (default: 1/30). Larger values create taller ideograms. length_ratio Numeric. Fraction Hi-C plot width used ideogram length (default: 0.8 = 80%). Controls horizontal scaling leave space labels. fontsize Numeric. Font size points chromosome labels coordinates (default: 10). colour Character. Border color highlighted region box (default: \"red\"). fill Character. Fill color highlighted region box, using RGBA hex format transparency (default: \"#FFE3E680\" = semi-transparent light red). ... Additional parameters (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"ggplot2 layer can added Hi-C plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required aesthetics","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"Inherits Hi-C data: seqnames1, start1, end1, seqnames2, start2, end2","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"ideogram-structure","dir":"Reference","previous_headings":"","what":"Ideogram structure","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"Chromosomes displayed horizontally Hi-C map : Cytogenetic bands: Giemsa staining patterns (G-bands) shown standard colors (light/dark representing staining intensity) Centromeres: Typically appear darker bands near middle Highlighted region: Colored box showing exact genomic region displayed Hi-C map Labels: Chromosome names coordinates right side","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"multi-chromosome-display","dir":"Reference","previous_headings":"","what":"Multi-chromosome display","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"visualizing multiple chromosomes, ideograms stacked vertically order appear Hi-C plot.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"genome-assembly-selection","dir":"Reference","previous_headings":"","what":"Genome assembly selection","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"Ensure genome parameter matches data's assembly. Mismatched assemblies show incorrect cytogenetic band patterns fail retrieve band data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"performance-considerations","dir":"Reference","previous_headings":"","what":"Performance considerations","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"Ideogram data fetched UCSC Genome Browser first use per session. Subsequent calls use cached data improved performance.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_ideogram.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add chromosome ideogram annotation to Hi-C plot — geom_ideogram","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage with human genome (hg19) cc <- ChromatinContacts(\"sample.cool\", focus = \"chr4\") |> import() gghic(cc) + geom_ideogram(genome = \"hg19\")  # Use human GRCh38/hg38 assembly gghic(cc) + geom_ideogram(genome = \"hg38\")  # Mouse genome cc_mouse <- ChromatinContacts(\"mouse.cool\", focus = \"chr1\") |> import() gghic(cc_mouse) + geom_ideogram(genome = \"mm10\")  # Show coordinates instead of just chromosome names gghic(cc) +   geom_ideogram(genome = \"hg19\", show_coord = TRUE)  # Customize highlight colors gghic(cc) +   geom_ideogram(     genome = \"hg19\",     highlight = TRUE,     colour = \"blue\",     fill = \"#ADD8E680\"  # Semi-transparent light blue   )  # Adjust ideogram size gghic(cc) +   geom_ideogram(     genome = \"hg19\",     width_ratio = 1/20,    # Taller ideogram     length_ratio = 0.9,    # Wider ideogram     fontsize = 12          # Larger labels   )  # Multiple chromosomes with ideograms cc_multi <- ChromatinContacts(\"sample.cool\", focus = \"chr1|chr2\") |>   import() gghic(cc_multi) +   geom_ideogram(genome = \"hg19\", show_coord = TRUE)  # Ensembl-style chromosome names (without \"chr\" prefix) cc_ensembl <- ChromatinContacts(\"ensembl.cool\", focus = \"1\") |> import() gghic(cc_ensembl) +   geom_ideogram(genome = \"hg19\", chrom_prefix = FALSE)  # Disable highlighting for cleaner look gghic(cc) +   geom_ideogram(genome = \"hg19\", highlight = FALSE)  # Complete publication-ready plot gghic(cc, ideogram = FALSE) +  # Disable auto-ideogram   geom_ideogram(     genome = \"hg19\",     highlight = TRUE,     colour = \"darkred\",     fill = \"#FFE3E650\",     fontsize = 11   ) +   theme_hic() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize chromatin loops on Hi-C heatmap — geom_loop","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"Adds chromatin loop annotations Hi-C contact maps. Loops can displayed circles (points) arcs. Automatically filters loops display within plotted region.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"","code":"geom_loop(   mapping = NULL,   data = NULL,   stat = StatLoop,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   loop_path = NULL,   loop_gis = NULL,   is_0_based = FALSE,   style = \"circle\",   n_arc_points = 50,   colour = \"black\",   shape = 21,   fill = NA,   size = grid::unit(1/80, \"native\"),   stroke = 1,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). loop_path Character. Path loop file BEDPE-like format columns: chrom1, start1, end1, chrom2, start2, end2. Either loop_path loop_gis must provided (default: NULL). loop_gis GInteractions object containing loop coordinates. Either loop_path loop_gis must provided (default: NULL). is_0_based Logical. Whether input coordinates 0-based (e.g., BED format). Set TRUE BEDPE files (default: FALSE). style Character. Visualization style: \"circle\": display loops circular points (default) \"arc\": display loops curved arcs connecting anchors n_arc_points Integer. Number points used draw arc style = \"arc\". Higher values produce smoother curves (default: 50). colour Character. Color loop markers arcs (default: \"black\"). shape Integer. Point shape style = \"circle\" (default: 21 = filled circle). fill Character. Fill color points style = \"circle\" (default: NA transparent). size Unit numeric. Size loop markers. Can grid unit numeric value mm (default: unit(1/80, \"native\")). stroke Numeric. Line width point borders arc lines (default: 1). ... Additional parameters passed layer (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"ggplot2 layer can added gghic plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required aesthetics","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"Inherits Hi-C data: seqnames1, start1, end1, seqnames2, start2, end2","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"loop-file-format","dir":"Reference","previous_headings":"","what":"Loop file format","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"Tab-delimited file columns:","code":"chrom1  start1  end1  chrom2  start2  end2 chr1    1000000 1005000 chr1  2000000 2005000"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"performance-tips","dir":"Reference","previous_headings":"","what":"Performance tips","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"large loop files, pre-filter region interest plotting. Arc style computationally intensive circle style.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize chromatin loops on Hi-C heatmap — geom_loop","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage with loop file cc <- ChromatinContacts(\"file.cool\", focus = \"chr4\") |> import() gghic(cc) + geom_loop(loop_path = \"loops.bedpe\")  # Arc style visualization gghic(cc) +    geom_loop(loop_path = \"loops.bedpe\", style = \"arc\", colour = \"red\")  # Using GInteractions object loops <- rtracklayer::import(\"loops.bedpe\") gghic(cc) + geom_loop(loop_gis = loops, colour = \"blue\", size = 2)  # 0-based coordinates (BEDPE format) gghic(cc) + geom_loop(loop_path = \"loops.bedpe\", is_0_based = TRUE)  # Customized appearance gghic(cc) +   geom_loop(     loop_path = \"loops.bedpe\",     colour = \"darkred\",     fill = \"red\",     size = 3,     stroke = 1.5,     shape = 21   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize chromatin loops (a second version) — geom_loop2","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"Another version geom_loop() requires direct data frame input loop coordinates instead file paths. Supports circle arc visualization styles.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"","code":"geom_loop2(   mapping = NULL,   data = NULL,   stat = StatLoop2,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = FALSE,   style = \"circle\",   n_arc_points = 50,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). style Character. Visualization style: \"circle\": Display loops circular points (default) \"arc\": Display loops curved arcs connecting anchors n_arc_points Integer. Number points drawing smooth arcs style = \"arc\". Higher values = smoother curves (default: 50). ... Additional parameters (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"ggplot2 layer.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required aesthetics","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"seqnames1, start1, end1: First loop anchor seqnames2, start2, end2: Second loop anchor","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"difference-from-geom-loop-","dir":"Reference","previous_headings":"","what":"Difference from geom_loop()","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"version requires Hi-C plot drawn first geom_hic() takes data frames directly rather file paths. Use geom_loop() convenience gghic() workflow.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_loop2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize chromatin loops (a second version) — geom_loop2","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Prepare loop data frame loop_file <- \"path/to/loops.bedpe\" loops <- read.table(   loop_file,   col.names = c(     \"chr1\", \"start1\", \"end1\", \"chr2\", \"start2\", \"end2\"   ) )  # Draw loops as circles (default) gghic(cc) +   geom_loop2(     data = loops, aes(       seqnames1 = chr1, start1 = start1, end1 = end1,       seqnames2 = chr2, start2 = start2, end2 = end2     )   )  # Draw loops as arcs gghic(cc) +   geom_loop2(     data = loops, aes(       seqnames1 = chr1, start1 = start1, end1 = end1,       seqnames2 = chr2, start2 = start2, end2 = end2     ), style = \"arc\"   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"Adds topologically associating domain (TAD) boundary annotations Hi-C contact maps. TAD boundaries displayed triangular outlines marking diagonal extent domain.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"","code":"geom_tad(   mapping = NULL,   data = NULL,   stat = StatTad,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   tad_path = NULL,   tad_gis = NULL,   is_0_based = FALSE,   colour = \"grey\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). tad_path Character. Path BED-like file TAD coordinates (columns: chrom, start, end). Either tad_path tad_gis must provided (default: NULL). tad_gis GInteractions object containing TAD coordinates interactions start end positions. Either tad_path tad_gis must provided (default: NULL). is_0_based Logical. Whether input coordinates 0-based (BED format). Set TRUE BED files (default: FALSE). colour Character. Color TAD boundary lines (default: \"grey\"). ... Additional parameters passed layer (unused).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"ggplot2 layer can added gghic plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required aesthetics","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"Inherits Hi-C data: seqnames1, start1, end1, seqnames2, start2, end2","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"tad-file-format","dir":"Reference","previous_headings":"","what":"TAD file format","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"Tab-delimited BED-like file columns:","code":"chrom  start     end chr1   0         1000000 chr1   1000000   2500000"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"interpretation","dir":"Reference","previous_headings":"","what":"Interpretation","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"TAD boundaries drawn V-shaped lines Hi-C diagonal. TAD represented two lines forming triangle encloses domain. Darker regions inside triangles represent increased intra-TAD interactions.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize TAD boundaries on Hi-C heatmap — geom_tad","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage with TAD file cc <- ChromatinContacts(\"file.cool\", focus = \"chr4\") |> import() gghic(cc) + geom_tad(tad_path = \"tads.bed\")  # Custom color gghic(cc) + geom_tad(tad_path = \"tads.bed\", colour = \"blue\")  # Using GInteractions object tads <- rtracklayer::import(\"tads.bed\") |> as(\"GInteractions\") gghic(cc) + geom_tad(tad_gis = tads)  # 0-based coordinates (BED format) gghic(cc) + geom_tad(tad_path = \"tads.bed\", is_0_based = TRUE)  # Combined with loops gghic(cc) +   geom_tad(tad_path = \"tads.bed\", colour = \"grey\") +   geom_loop(loop_path = \"loops.bedpe\", colour = \"red\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize TAD boundaries (a second version) — geom_tad2","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"Another version geom_tad() requires direct data frame input. Draws TAD boundaries triangular outlines Hi-C heatmap.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"","code":"geom_tad2(   mapping = NULL,   data = NULL,   stat = StatTad2,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = FALSE,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). ... Parameters ignored.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"ggplot object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"Requires following aesthetics: seqname start end","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_tad2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize TAD boundaries (a second version) — geom_tad2","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Load TAD data tad_file <- \"path/to/tads.bed\" tads <- read.table(tad_file, col.names = c(\"seqnames\", \"start\", \"end\"))  # Add TAD boundaries using data frame library(ggplot2) gghic(cc) +   geom_tad2(data = tads, aes(seqnames = seqnames, start = start, end = end))  # Multiple TAD types with different colors tads1 <- tads[1:5, ] tads1$type <- \"Strong\" tads2 <- tads[6:10, ] tads2$type <- \"Weak\" all_tads <- rbind(tads1, tads2)  gghic(cc) +   geom_tad2(     data = all_tads,     aes(seqnames = seqnames, start = start, end = end, colour = type)   ) +   scale_colour_manual(values = c(\"Strong\" = \"red\", \"Weak\" = \"grey\")) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":null,"dir":"Reference","previous_headings":"","what":"Add genomic signal tracks to Hi-C plots — geom_track","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"Displays continuous genomic signal data (ChIP-seq, ATAC-seq, RNA-seq, etc.) tracks Hi-C heatmaps. Data read standard genomic file formats (BigWig, BED, bedGraph) provided GRanges objects. track shows signal intensity filled area plot automatic y-axis scaling labeled axes. Multiple tracks can stacked vertically independent shared scaling.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"","code":"geom_track(   mapping = NULL,   data = NULL,   stat = StatTrack,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   data_paths = NULL,   track_grs = NULL,   width_ratio = 1/20,   spacing_ratio = 0.5,   data_range = c(\"auto\", \"maximum\"),   fill = \"black\",   fontsize = 5,   rasterize = TRUE,   dpi = 300,   dev = \"cairo\",   scale = 1,   draw_boundary = TRUE,   boundary_colour = \"black\",   linetype = \"dashed\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). data_paths Character vector file paths genomic signal files. Supported formats include BigWig (.bw, .bigWig), BED, bedGraph files. Files automatically read using rtracklayer. Named vectors recommended provide track labels (e.g., c(\"H3K27ac\" = \"chip.bw\", \"ATAC\" = \"atac.bw\")). Either data_paths track_grs must provided. Default NULL. track_grs Named list GRanges objects containing genomic signal data. GRanges score metadata column signal values. Names used track labels. Either data_paths track_grs must provided. Default NULL. width_ratio Numeric value controlling height track relative Hi-C plot height. Smaller values create shorter tracks. Default 1/20 (5% Hi-C plot height). spacing_ratio Numeric value controlling vertical spacing tracks proportion track height. Default 0.5 (50% track height). data_range Character string numeric value(s) controlling y-axis scaling: \"auto\": track scaled independently maximum value \"maximum\": tracks share y-axis scale (global maximum) Numeric value: Fixed maximum tracks (e.g., 100) Numeric vector: Individual maximum track (length must match number tracks) Default \"auto\". fill Character string named character vector specifying fill colors tracks. named, names match track names. unnamed, colors recycled across tracks. Default \"black\". fontsize Numeric value specifying font size track labels axis annotations. Default 5. rasterize Logical indicating whether rasterize track polygons faster rendering smaller file sizes. Recommended high-resolution data. Default TRUE. dpi Numeric value specifying resolution (dots per inch) rasterized tracks. Higher values increase quality also file size. Default 300. dev Character string specifying graphics device rasterization. Options include \"cairo\", \"ragg\", devices. Default \"cairo\". scale Numeric scaling factor rasterized output. Values > 1 increase resolution. Default 1. draw_boundary Logical indicating whether draw vertical boundary lines chromosomes multi-chromosome displays. Default TRUE. boundary_colour Character string specifying color chromosome boundary lines. Default \"black\". linetype Character string integer specifying line type chromosome boundaries. Default \"dashed\". ... Additional parameters (currently ignored).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"ggplot2 layer object can added gghic plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required Aesthetics","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"geom inherits aesthetics Hi-C data requires: seqnames1, seqnames2: Chromosome names start1, start2: Start positions end1, end2: End positions","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"input-data-formats","dir":"Reference","previous_headings":"","what":"Input Data Formats","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"Tracks can provided via two methods:","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"file-based-input-data-paths-","dir":"Reference","previous_headings":"","what":"File-based input (data_paths)","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"Reads directly genomic signal files Automatically extracts data displayed genomic region Supports BigWig (.bw), BED, bedGraph formats Named vector provides track labels","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"granges-input-track-grs-","dir":"Reference","previous_headings":"","what":"GRanges input (track_grs)","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"Pre-loaded genomic data GRanges objects Must contain score metadata column Useful custom data pre-processed signals Automatically filtered displayed region","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"track-visualization","dir":"Reference","previous_headings":"","what":"Track Visualization","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"track displays: Signal area: Filled polygon showing signal intensity Y-axis: Left side minimum (0) maximum value labels Track label: Name displayed left Baseline: Zero line bottom track","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"y-axis-scaling-options","dir":"Reference","previous_headings":"","what":"Y-Axis Scaling Options","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"data_range parameter controls tracks scaled: Independent scaling (\"auto\"): track scaled maximum, best comparing patterns within dataset Shared scaling (\"maximum\"): tracks use scale, enabling direct amplitude comparison tracks Fixed scaling (numeric): Manually set maximum value(s) consistent scaling across multiple plots known value ranges","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"color-specification","dir":"Reference","previous_headings":"","what":"Color Specification","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"fill parameter accepts: Single color: Applied tracks (e.g., \"black\") Named vector: Specific colors track (e.g., c(\"ChIP\" = \"blue\", \"ATAC\" = \"red\")) Unnamed vector: Colors recycled across tracks order","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"performance-optimization","dir":"Reference","previous_headings":"","what":"Performance Optimization","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"Rasterization (rasterize = TRUE): Converts high-resolution tracks raster images, dramatically reducing file size rendering time DPI setting: Balance quality vs. file size (150-300 dpi typical) Data filtering: overlapping regions loaded files","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"multi-chromosome-display","dir":"Reference","previous_headings":"","what":"Multi-Chromosome Display","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"displaying multiple chromosomes: Track coordinates automatically adjusted proper alignment Vertical boundaries drawn chromosomes (draw_boundary = TRUE) Y-axis labels positioned consistently across chromosomes","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add genomic signal tracks to Hi-C plots — geom_track","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage with BigWig files cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  track1 <- \"path/to/H3K27ac.bw\" track2 <- \"path/to/ATAC.bw\"  # Add tracks using file paths gghic(cc) +   geom_track(data_paths = c(track1, track2))  # Named tracks with labels gghic(cc) +   geom_track(     data_paths = c(       \"H3K27ac\" = \"path/to/H3K27ac.bw\",       \"ATAC-seq\" = \"path/to/ATAC.bw\",       \"RNA-seq\" = \"path/to/RNA.bw\"     )   )  # Custom colors for each track gghic(cc) +   geom_track(     data_paths = c(\"H3K27ac\" = track1, \"ATAC\" = track2),     fill = c(\"H3K27ac\" = \"#E63946\", \"ATAC\" = \"#457B9D\")   )  # Shared y-axis scaling for comparison gghic(cc) +   geom_track(     data_paths = c(\"Condition1\" = \"cond1.bw\", \"Condition2\" = \"cond2.bw\"),     data_range = \"maximum\"   )  # Fixed y-axis maximum gghic(cc) +   geom_track(     data_paths = c(\"ChIP-seq\" = track1),     data_range = 100  # Fix max to 100   )  # Different maximums for each track gghic(cc) +   geom_track(     data_paths = c(\"Track1\" = track1, \"Track2\" = track2),     data_range = c(50, 100)  # Track1 max=50, Track2 max=100   )  # Using GRanges objects library(rtracklayer) gr1 <- import(\"path/to/track1.bw\") gr2 <- import(\"path/to/track2.bw\")  gghic(cc) +   geom_track(     track_grs = list(\"H3K27ac\" = gr1, \"H3K4me3\" = gr2)   )  # Custom track dimensions gghic(cc) +   geom_track(     data_paths = c(\"Signal\" = track1),     width_ratio = 1 / 15,   # Taller tracks     spacing_ratio = 1        # More spacing   )  # Disable rasterization for vector output gghic(cc) +   geom_track(     data_paths = c(\"ChIP\" = track1),     rasterize = FALSE   )  # High-resolution rasterization gghic(cc) +   geom_track(     data_paths = c(\"Signal\" = track1),     rasterize = TRUE,     dpi = 600,     dev = \"ragg\"   )  # Multi-chromosome with custom boundaries cc_multi <- ChromatinContacts(\"path/to/cooler.cool\",                               focus = c(\"chr4\", \"chr8\")) |>   import() gghic(cc_multi) +   geom_track(     data_paths = c(\"ATAC\" = track1),     draw_boundary = TRUE,     boundary_colour = \"gray50\",     linetype = \"dotted\"   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":null,"dir":"Reference","previous_headings":"","what":"Add genomic signal tracks with direct data input (a second version) — geom_track2","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"Another version geom_track() accepts pre-loaded genomic signal data data frame tibble explicit aesthetic mappings. Displays continuous genomic signals (ChIP-seq, ATAC-seq, RNA-seq, etc.) filled area tracks Hi-C heatmaps. Unlike geom_track(), function uses standard ggplot2 aesthetic mappings, making flexible custom styling integration ggplot2 scales themes.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"","code":"geom_track2(   mapping = NULL,   data = NULL,   stat = StatTrack2,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   width_ratio = 1/20,   spacing_ratio = 0.5,   data_range = c(\"auto\", \"maximum\"),   rasterize = TRUE,   dpi = 300,   dev = \"cairo\",   scale = 1,   draw_boundary = TRUE,   boundary_colour = \"black\",   linetype = \"dashed\",   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). stat statistical transformation use data layer. using geom_*() function construct layer, stat argument can used override default coupling geoms stats. stat argument accepts following: Stat ggproto subclass, example StatCount. string naming stat. give stat string, strip function name stat_ prefix. example, use stat_count(), give stat \"count\". information ways specify stat, see layer stat documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). width_ratio Numeric value controlling height track relative Hi-C plot height. Smaller values create shorter tracks. Default 1/20 (5% Hi-C plot height). spacing_ratio Numeric value controlling vertical spacing tracks proportion track height. Default 0.5 (50% track height). data_range Character string numeric value(s) controlling y-axis scaling: \"auto\": track scaled independently maximum value \"maximum\": tracks share y-axis scale (global maximum) Numeric value: Fixed maximum tracks (e.g., 100) Numeric vector: Individual maximum track (length must match number tracks) Default \"auto\". rasterize Logical indicating whether rasterize track polygons faster rendering smaller file sizes. Recommended high-resolution data. Default TRUE. dpi Numeric value specifying resolution (dots per inch) rasterized tracks. Higher values increase quality also file size. Default 300. dev Character string specifying graphics device rasterization. Options include \"cairo\", \"ragg\", devices. Default \"cairo\". scale Numeric scaling factor rasterized output. Values > 1 increase resolution. Default 1. draw_boundary Logical indicating whether draw vertical boundary lines chromosomes multi-chromosome displays. Default TRUE. boundary_colour Character string specifying color chromosome boundary lines. Default \"black\". linetype Character string integer specifying line type chromosome boundaries. Default \"dashed\". ... Additional parameters (currently ignored).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"ggplot2 layer object can added gghic plot.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"required-aesthetics","dir":"Reference","previous_headings":"","what":"Required Aesthetics","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"geom requires following aesthetics mapped: seqnames: Chromosome name genomic bin start: Start position bin end: End position bin score: Signal intensity value (numeric) name: Track identifier/label (groups bins tracks)","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"input-data-format","dir":"Reference","previous_headings":"","what":"Input Data Format","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"Data data frame tibble row represents one genomic bin:","code":"seqnames  start    end  score      name chr1      10000  10100   5.2    \"ChIP-seq\" chr1      10100  10200   6.1    \"ChIP-seq\" chr1      10200  10300   4.8    \"ChIP-seq\""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"track-visualization","dir":"Reference","previous_headings":"","what":"Track Visualization","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"track displays: Signal area: Filled polygon showing signal intensity Y-axis: Left side minimum (0) maximum value labels Track label: Name (name aesthetic) displayed left Baseline: Zero line bottom track","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"color-and-fill-aesthetics","dir":"Reference","previous_headings":"","what":"Color and Fill Aesthetics","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"function fully integrates ggplot2's aesthetic system: Map fill aesthetic track names automatic coloring Use scale_fill_manual(), scale_fill_brewer(), etc. custom colors Supports standard ggplot2 color specifications Can combine aesthetic mappings (alpha, etc.)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"y-axis-scaling","dir":"Reference","previous_headings":"","what":"Y-Axis Scaling","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"Control track scaling via data_range: Independent (\"auto\"): Compare patterns within track Shared (\"maximum\"): Compare absolute signal tracks Fixed (numeric): Consistent scaling across multiple plots","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"performance","dir":"Reference","previous_headings":"","what":"Performance","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"Rasterization recommended dense genomic data Adjust dpi balance quality file size Pre-filter data displayed region faster rendering","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"multi-chromosome-support","dir":"Reference","previous_headings":"","what":"Multi-Chromosome Support","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"data includes multiple chromosomes: Coordinates automatically adjusted proper alignment Vertical boundaries separate chromosomes (draw_boundary = TRUE) Works seamlessly Hi-C multi-chromosome displays","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/geom_track2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add genomic signal tracks with direct data input (a second version) — geom_track2","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"path/to/cooler.cool\", focus = \"chr4\") |>   import()  # Load and prepare track data library(rtracklayer) track1 <- import(\"path/to/H3K27ac.bw\") track1$name <- \"H3K27ac\" track_df <- as.data.frame(track1)  # Basic usage with aesthetic mappings library(ggplot2) gghic(cc) +   geom_track2(     data = track_df,     aes(       seqnames = seqnames,       start = start,       end = end,       score = score,       name = name     )   )  # Multiple tracks with color mapping track2 <- import(\"path/to/ATAC.bw\") track2$name <- \"ATAC-seq\" tracks_df <- rbind(   as.data.frame(track1),   as.data.frame(track2) )  gghic(cc) +   geom_track2(     data = tracks_df,     aes(       seqnames = seqnames,       start = start,       end = end,       score = score,       name = name,       fill = name  # Color by track name     )   ) +   scale_fill_manual(values = c(\"H3K27ac\" = \"#E63946\", \"ATAC-seq\" = \"#457B9D\"))  # Using scale_fill_brewer for automatic colors gghic(cc) +   geom_track2(     data = tracks_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name, fill = name)   ) +   scale_fill_brewer(palette = \"Set2\")  # Shared y-axis scaling gghic(cc) +   geom_track2(     data = tracks_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name, fill = name),     data_range = \"maximum\"   )  # Custom track dimensions gghic(cc) +   geom_track2(     data = track_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name),     width_ratio = 1 / 15,    # Taller tracks     spacing_ratio = 1         # More spacing   )  # Fixed y-axis maximum gghic(cc) +   geom_track2(     data = track_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name),     data_range = 50  # Fix max to 50   )  # Multiple tracks with different y-axis limits gghic(cc) +   geom_track2(     data = tracks_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name),     data_range = c(100, 50)  # Different max for each track   )  # High-resolution rasterization gghic(cc) +   geom_track2(     data = track_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name),     rasterize = TRUE,     dpi = 600,     dev = \"ragg\"   )  # Combine with other geoms gghic(cc) +   geom_track2(     data = track_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name),     fill = \"darkblue\"   ) +   geom_loop(\"path/to/loops.bedpe\")  # Multi-chromosome display cc_multi <- ChromatinContacts(\"path/to/cooler.cool\",                               focus = c(\"chr4\", \"chr8\")) |>   import() gghic(cc_multi) +   geom_track2(     data = tracks_df,     aes(seqnames = seqnames, start = start, end = end,         score = score, name = name, fill = name),     draw_boundary = TRUE   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"Calculates appropriate breaks labels x-axis visualizing multiple chromosomes simultaneously. Adjusts break density based chromosome length.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"","code":"getBreaksLabels(data)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"data data frame tibble columns seqnames, start, end representing genomic coordinates.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"list two elements: breaks: Numeric vector x-axis break positions labels: Character vector formatted labels","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"function: Groups data chromosome Calculates chromosome lengths Assigns breaks longer chromosomes (2-10 breaks per chromosome) Formats labels megabases (M) Adds newlines chromosome transitions clarity Useful multi-chromosome Hi-C visualizations chromosomes displayed side--side.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/getBreaksLabels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate axis breaks and labels for multi-chromosome plots — getBreaksLabels","text":"","code":"if (FALSE) { # \\dontrun{ # Get breaks and labels for multi-chromosome plot df <- scaleData(cc, \"balanced\", log10) breaks_labels <- getBreaksLabels(df)  ggplot(df) +   geom_hic() +   scale_x_continuous(     breaks = breaks_labels$breaks,     labels = breaks_labels$labels   ) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic-package.html","id":null,"dir":"Reference","previous_headings":"","what":"gghic: Visualizing Genomic Interaction Data Using ggplot2 — gghic-package","title":"gghic: Visualizing Genomic Interaction Data Using ggplot2 — gghic-package","text":"easy way create publication-ready figures genomic interaction data using ggplot2.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"gghic: Visualizing Genomic Interaction Data Using ggplot2 — gghic-package","text":"Maintainer: Minghao Jiang mjhk@connect.hku.hk (ORCID) [contributor, copyright holder]","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Hi-C visualization plot — gghic","title":"Create Hi-C visualization plot — gghic","text":"High-level wrapper publication-ready Hi-C visualizations genomic features.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Hi-C visualization plot — gghic","text":"","code":"gghic(x, ...)  # S4 method for class 'ChromatinContacts' gghic(   x,   scale_method = log10,   ideogram = FALSE,   ideogram_width_ratio = 1/30,   ideogram_fontsize = 10,   ideogram_colour = \"red\",   ideogram_fill = \"#FFE3E680\",   annotation = FALSE,   annotation_style = \"basic\",   annotation_width_ratio = 1/50,   annotation_spacing_ratio = 1/3,   annotation_fontsize = 10,   annotation_colour = \"#48CFCB\",   annotation_fill = \"#48CFCB\",   track = FALSE,   track_width_ratio = 1/20,   track_spacing_ratio = 1/2,   track_fill = \"black\",   track_fontsize = 5,   tad = FALSE,   tad_colour = \"grey\",   loop = FALSE,   loop_style = \"circle\",   loop_colour = \"black\",   loop_fill = NA,   concatemer = FALSE,   concatemer_width_ratio = 1/100,   concatemer_spacing_ratio = 1/5,   expand_xaxis = FALSE,   expand_left = NULL,   expand_right = NULL,   ... )  # S4 method for class 'data.frame' gghic(   x,   scale_column = \"balanced\",   scale_method = log10,   ideogram = FALSE,   ideogram_width_ratio = 1/30,   ideogram_fontsize = 10,   ideogram_colour = \"red\",   ideogram_fill = \"#FFE3E680\",   annotation = FALSE,   annotation_style = \"basic\",   annotation_width_ratio = 1/50,   annotation_spacing_ratio = 1/3,   annotation_fontsize = 10,   annotation_colour = \"#48CFCB\",   annotation_fill = \"#48CFCB\",   track = FALSE,   track_width_ratio = 1/20,   track_spacing_ratio = 1/2,   track_fill = \"black\",   track_fontsize = 5,   tad = FALSE,   tad_is_0_based = FALSE,   tad_colour = \"grey\",   loop = FALSE,   loop_style = \"circle\",   loop_is_0_based = FALSE,   loop_colour = \"black\",   loop_fill = NA,   concatemer = FALSE,   concatemer_width_ratio = 1/100,   concatemer_spacing_ratio = 1/5,   expand_xaxis = FALSE,   expand_left = NULL,   expand_right = NULL,   ... )  # S4 method for class 'GInteractions' gghic(   x,   scale_column = \"balanced\",   scale_method = log10,   ideogram = FALSE,   ideogram_width_ratio = 1/30,   ideogram_fontsize = 10,   ideogram_colour = \"red\",   ideogram_fill = \"#FFE3E680\",   annotation = FALSE,   annotation_style = \"basic\",   annotation_width_ratio = 1/50,   annotation_spacing_ratio = 1/3,   annotation_fontsize = 10,   annotation_colour = \"#48CFCB\",   annotation_fill = \"#48CFCB\",   track = FALSE,   track_width_ratio = 1/20,   track_spacing_ratio = 1/2,   track_fill = \"black\",   track_fontsize = 5,   tad = FALSE,   tad_is_0_based = FALSE,   tad_colour = \"grey\",   loop = FALSE,   loop_style = \"circle\",   loop_is_0_based = FALSE,   loop_colour = \"black\",   loop_fill = NA,   concatemer = FALSE,   concatemer_width_ratio = 1/100,   concatemer_spacing_ratio = 1/5,   expand_xaxis = FALSE,   expand_left = NULL,   expand_right = NULL,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Hi-C visualization plot — gghic","text":"x ChromatinContacts, GInteractions, data.frame interactions. ... Additional arguments geom functions. scale_method Function data transformation (default: log10). ideogram Logical. Add chromosome ideogram (default: FALSE). ideogram_width_ratio Numeric. Ideogram height ratio (default: 1/30). ideogram_fontsize Numeric. Ideogram font size (default: 10). ideogram_colour Character. Highlight color (default: \"red\"). ideogram_fill Character. Highlight fill (default: \"#FFE3E680\"). annotation Logical. Add gene annotations (default: FALSE). Requires gtf_path .... annotation_style Character. \"basic\" \"arrow\" (default: \"basic\"). annotation_width_ratio Numeric. Track height (default: 1/50). annotation_spacing_ratio Numeric. Gene spacing (default: 1/3). annotation_fontsize Numeric. Label size (default: 10). annotation_colour Character. Feature color (default: \"#48CFCB\"). annotation_fill Character. Feature fill (default: \"#48CFCB\"). track Logical. Add genomic tracks (default: FALSE). Requires tracks object data_paths .... track_width_ratio Numeric. Track height (default: 1/20). track_spacing_ratio Numeric. Track spacing (default: 1/2). track_fill Character. Track colors (default: \"black\"). track_fontsize Numeric. Label size (default: 5). tad Logical. Add TAD boundaries (default: FALSE). Requires TADs object tad_path .... tad_colour Character. TAD color (default: \"grey\"). loop Logical. Add loops (default: FALSE). Requires loops object loop_path .... loop_style Character. \"circle\" \"arc\" (default: \"circle\"). loop_colour Character. Loop color (default: \"black\"). loop_fill Fill color (default: NA). concatemer Logical. Add multi-way contacts (default: FALSE). concatemer_width_ratio Numeric. Track height (default: 1/100). concatemer_spacing_ratio Numeric. Spacing (default: 1/5). expand_xaxis Logical. Expand x-axis (default: FALSE). expand_left Numeric. Left expansion bp (default: 10×resolution). expand_right Numeric. Right expansion bp (default: 10×resolution). scale_column Character string. Name column use scaling (e.g., \"balanced\", \"count\"). Used input GInteractions data.frame. tad_is_0_based Logical. Whether TAD coordinates 0-based. Default TRUE. loop_is_0_based Logical. Whether loop coordinates 0-based. Default TRUE.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Hi-C visualization plot — gghic","text":"ggplot2 object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Hi-C visualization plot — gghic","text":"Automatically handles: data scaling, coordinate transformation, feature integration, axis labels, default theme. Use individual geom_*() functions control: geom_hic(), geom_ideogram(), geom_annotation(), geom_track(), geom_tad(), geom_loop(), geom_concatemer().","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Hi-C visualization plot — gghic","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage cc <- ChromatinContacts(\"file.cool\") |> import() gghic(cc) gghic(cc[\"chr4:0-50000000\"])  # With features gghic(cc, ideogram = TRUE, genome = \"hg19\") gghic(cc, tad = TRUE, tad_path = \"tads.bed\") gghic(cc, loop = TRUE, loop_path = \"loops.bedpe\")  # With tracks features(cc, \"tracks\") <- GRangesList(   H3K27ac = rtracklayer::import(\"track.bw\") ) gghic(cc, track = TRUE, track_fill = \"blue\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"Creates intuitive ggplot2 visualization multi-way chromatin contacts Pore-C similar long-read technologies. Displays genomic bins points multi-way contacts connecting lines (hyperedges), line width color encoding contact properties.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"","code":"gghypergraph(x, ...)  # S4 method for class 'MultiWayContacts' gghypergraph(   x,   point_size = 2,   line_width = 0.3,   line_alpha = 0.6,   color_by = \"n_multiways\",   palette = \"viridis\",   facet_chrom = TRUE,   weight_normalization = \"none\" )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"x MultiWayContacts object selected hyperedges (running select()). ... Additional arguments (used). point_size Numeric. Size genomic bin points (default: 2). line_width Numeric. Base line width hyperedges. Actual width scaled hyperedge weight (default: 0.3). line_alpha Numeric 0 1. Line transparency reduce overplotting (default: 0.6). color_by Character. Variable line coloring: \"n_multiways\": Color contact order (2-way, 3-way, etc.) (default) values: Uniform gray coloring palette Character. Color palette name: Viridis options: \"viridis\", \"magma\", \"plasma\", \"inferno\", \"cividis\" ColorBrewer palettes: \"YlOrRd\", \"Blues\", etc. Default: \"viridis\" facet_chrom Logical. Layout strategy: TRUE: Separate facet panel per chromosome (default) FALSE: Composite y-axis chromosomes stacked weight_normalization Character. Deprecated parameter (weights now set tidy() method).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"ggplot2 object can customized additional ggplot2 layers themes.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"visualization-structure","dir":"Reference","previous_headings":"","what":"Visualization structure","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"X-axis: Hyperedge index (read/contact) Y-axis: Genomic bin position (genomic coordinate) Points: Individual genomic bins Lines: Connect bins single multi-way contact Line width: Scaled hyperedge weight Line color: Contact order (number fragments per read)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"interpretation","dir":"Reference","previous_headings":"","what":"Interpretation","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"Vertical lines: Bins contacted read Line thickness: Relative importance/weight Color gradient: Contact complexity (darker = higher-order) Patterns reveal genome organization contact preferences","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"prerequisites","dir":"Reference","previous_headings":"","what":"Prerequisites","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"Must run complete workflow: import() → build() → tidy() → select() visualization.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/gghypergraph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize multi-way chromatin contacts as hypergraph network — gghypergraph","text":"","code":"if (FALSE) { # \\dontrun{ # Complete workflow mc <- MultiWayContacts(\"sample.pairs.gz\", focus = \"chr1\") |>   import() |>   build(bin_size = 1000000L, quantile = 0.85) |>   tidy(weight_normalization = \"log\") |>   select(n_intra = 10, n_inter = 5)  # Basic visualization gghypergraph(mc)  # Composite layout with custom colors gghypergraph(mc, facet_chrom = FALSE, palette = \"magma\")  # Emphasize line patterns gghypergraph(mc, line_width = 0.5, line_alpha = 0.8, point_size = 3)  # Further customization gghypergraph(mc) +   theme_minimal() +   labs(title = \"Multi-way Contacts on Chromosome 1\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":null,"dir":"Reference","previous_headings":"","what":"Get hypergraph data from MultiWayContacts object — hypergraphData","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"Retrieves selected tidied hypergraph data MultiWayContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"","code":"hypergraphData(x, which = c(\"selected\", \"tidied\"))  # S4 method for class 'MultiWayContacts' hypergraphData(x, which = c(\"selected\", \"tidied\"))"},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"x MultiWayContacts object. Character. hypergraph data retrieve: \"selected\" (default) returns selected subset visualization, \"tidied\" returns full tidied long-format data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"data.frame containing hypergraph data long format, NULL requested data computed yet.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"= \"selected\": Returns data select(), subset hyperedges chosen visualization. Use plotting. = \"tidied\": Returns data tidy(), full hypergraph long format. Use analysis.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/hypergraphData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get hypergraph data from MultiWayContacts object — hypergraphData","text":"","code":"if (FALSE) { # \\dontrun{ mc <- MultiWayContacts(\"sample.pairs.gz\") |>   import() |>   build(bin_size = 1e6, min_multiway = 3) |>   tidy(max_hyperedges = 100) |>   select(n = 50)  # Get selected hyperedges for plotting df <- hypergraphData(mc, \"selected\")  # Get full tidied data for analysis df_full <- hypergraphData(mc, \"tidied\") } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":null,"dir":"Reference","previous_headings":"","what":"Import chromatin contact data — import-ChromatinContacts","title":"Import chromatin contact data — import-ChromatinContacts","text":"Imports interaction data cooler file ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Import chromatin contact data — import-ChromatinContacts","text":"","code":"# S4 method for class 'ChromatinContacts,ANY,ANY' import(con, format, text, balance_column = \"weight\", ...)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Import chromatin contact data — import-ChromatinContacts","text":"con ChromatinContacts object cooler file path. format Character. Balance column name normalization (default: \"weight\"). Can provided second argument convenience. text used (compatibility). balance_column Character. Balance column name (overridden format provided). ... Additional arguments (used).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Import chromatin contact data — import-ChromatinContacts","text":"ChromatinContacts interactions slot populated GInteractions containing bin_id1, bin_id2, count, balanced columns.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Import chromatin contact data — import-ChromatinContacts","text":"Loads Hi-C data cooler file. focus regions specified, interactions loaded. Balance weights (e.g., \"weight\", \"KR\", \"VC\") used normalize raw counts. Warning issued balance column found. Shorthand: import(cc, \"KR\") equivalent import(cc, balance_column = \"KR\").","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-ChromatinContacts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Import chromatin contact data — import-ChromatinContacts","text":"","code":"if (FALSE) { # \\dontrun{ # Basic import cc <- ChromatinContacts(\"sample.cool\") |> import()  # With specific balance column cc <- import(cc, \"KR\")  # Focus region (more efficient) cc <- ChromatinContacts(\"sample.cool\", focus = \"chr1:1-5e6\") |> import() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":null,"dir":"Reference","previous_headings":"","what":"Import multi-way contact data — import-MultiWayContacts","title":"Import multi-way contact data — import-MultiWayContacts","text":"Imports multi-way chromatin contact data .pairs file MultiWayContacts object. method loads pairwise contacts long-read sequencing experiments (e.g., Pore-C).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Import multi-way contact data — import-MultiWayContacts","text":"","code":"# S4 method for class 'MultiWayContacts,ANY,ANY' import(con, format, text, inter_chrom = FALSE, ...)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Import multi-way contact data — import-MultiWayContacts","text":"con MultiWayContacts object containing path pairs file optional focus regions. format Logical indicating whether include inter-chromosomal contacts. parameter used second positional argument convenience. Default FALSE. text used. Included compatibility generic. inter_chrom Logical. TRUE, includes inter-chromosomal contacts. FALSE (default), intra-chromosomal contacts loaded. format provided, overrides parameter. ... Additional arguments (currently used).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Import multi-way contact data — import-MultiWayContacts","text":"MultiWayContacts object pairs slot populated data frame containing: read_name: Unique identifier read chrom1, chrom2: Chromosomes contact pos1, pos2: Genomic positions contact","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Import multi-way contact data — import-MultiWayContacts","text":"function loads pairwise contact data .pairs file format (typically .pairs.gz). focus chromosome specified MultiWayContacts object, contacts involving chromosome loaded. inter_chrom = FALSE, reads contain inter-chromosomal contacts completely removed dataset ensure clean intra-chromosomal analysis. pairs file read using optimized C code efficient parsing large files. convenience, inter_chrom parameter can provided second positional argument: import(mc, TRUE) equivalent import(mc, inter_chrom = TRUE).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/import-MultiWayContacts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Import multi-way contact data — import-MultiWayContacts","text":"","code":"if (FALSE) { # \\dontrun{ # Basic import (intra-chromosomal only) mc <- MultiWayContacts(\"sample.pairs.gz\") mc <- import(mc)  # Using pipe operator mc <- MultiWayContacts(\"sample.pairs.gz\") |> import()  # Include inter-chromosomal contacts mc <- import(mc, inter_chrom = TRUE)  # Convenient syntax mc <- import(mc, TRUE)  # Import with focus on specific chromosome mc <- MultiWayContacts(   \"sample.pairs.gz\",   focus = \"chr1\" ) |> import()  # Check imported data head(mc@pairs) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Get interaction data — interactions,ChromatinContacts-method","title":"Get interaction data — interactions,ChromatinContacts-method","text":"Retrieves imported Hi-C interactions.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get interaction data — interactions,ChromatinContacts-method","text":"","code":"# S4 method for class 'ChromatinContacts' interactions(x)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get interaction data — interactions,ChromatinContacts-method","text":"x ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get interaction data — interactions,ChromatinContacts-method","text":"GInteractions (Hi-C data) NULL (yet imported).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get interaction data — interactions,ChromatinContacts-method","text":"Must load import() first. GInteractions contains bin coordinates metadata (count, balanced).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/interactions-ChromatinContacts-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get interaction data — interactions,ChromatinContacts-method","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"sample.cool\") |> import() gis <- interactions(cc) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotCoverageCurve.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Coverage Fraction by Resolution — plotCoverageCurve","title":"Plot Coverage Fraction by Resolution — plotCoverageCurve","text":"Create line plot showing fraction bins meeting contact threshold changes resolution.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotCoverageCurve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Coverage Fraction by Resolution — plotCoverageCurve","text":"","code":"plotCoverageCurve(   pairs,   bin_sizes = c(1000, 2000, 5000, 10000, 20000, 25000, 50000, 1e+05, 150000, 2e+05,     250000, 5e+05, 1e+06),   min_contacts = 1000,   title = \"Genome Coverage by Resolution\" )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotCoverageCurve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Coverage Fraction by Resolution — plotCoverageCurve","text":"pairs data frame tibble pairs data. bin_sizes Integer vector bin sizes test. See plotResolutionCoverage. min_contacts Integer minimum contacts threshold. Default: 1000. title Character plot title.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotCoverageCurve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Coverage Fraction by Resolution — plotCoverageCurve","text":"ggplot2 object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotCoverageCurve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Coverage Fraction by Resolution — plotCoverageCurve","text":"","code":"if (FALSE) { # \\dontrun{ p <- plotCoverageCurve(pairs) print(p) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Resolution vs Coverage — plotResolutionCoverage","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"Generate boxplot showing coverage bins different bin sizes.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"","code":"plotResolutionCoverage(   pairs,   bin_sizes = c(1000, 2000, 5000, 10000, 20000, 25000, 50000, 1e+05, 150000, 2e+05,     250000, 5e+05, 1e+06),   min_contacts = 1000,   title = \"Coverage by Resolution\" )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"pairs data frame tibble columns: read_name, chrom1, pos1, chrom2, pos2. bin_sizes Integer vector bin sizes test (base pairs). Default: c(1e3, 2e3, 5e3, 1e4, 2e4, 2.5e4, 5e4, 1e5, 1.5e5, 2e5, 2.5e5, 5e5, 1e6) min_contacts Integer minimum number contacts. Default: 1000. title Character title plot. Default: \"Coverage Resolution\".","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"ggplot2 object showing coverage distribution across bin sizes.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"Creates boxplot visualization panel represents bin size, distribution shows number contacts per bin. helps visualize resolution affects coverage across genome.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/plotResolutionCoverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Resolution vs Coverage — plotResolutionCoverage","text":"","code":"if (FALSE) { # \\dontrun{ # Plot coverage for default bin sizes p <- plotResolutionCoverage(pairs) print(p)  # Custom bin sizes p <- plotResolutionCoverage(pairs,   bin_sizes = c(10000, 50000, 100000, 500000) ) print(p) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"Advanced utility function remapping aesthetic names ggplot2 layer. Used internally gghic creating complex multi-layer visualizations custom aesthetics.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"","code":"renameGeomAes(layer, new_aes, mapping = NULL)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"layer ggplot2 layer object. new_aes Named character vector. Maps new aesthetic names original names (e.g., c(\"fill2\" = \"fill\")). mapping Optional aesthetic mapping. NULL, created new_aes.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"modified ggplot2 layer remapped aesthetics.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"function creates new ggproto object remaps aesthetics, allowing multiple layers use different aesthetic names (e.g., fill fill2) independent scales. primarily internal function used geom_hic_under() allow overlaying two heatmaps independent color scales.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/renameGeomAes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename aesthetic mappings in a ggplot2 layer — renameGeomAes","text":"","code":"if (FALSE) { # \\dontrun{ # Typically used internally layer <- geom_tile(aes(fill = score)) renamed_layer <- renameGeomAes(layer, c(\"fill2\" = \"fill\")) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Resolution and Depth for Pairs Data — resolution-depth","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"Functions analyze genomic interaction resolution coverage depth. Load pairs file C memory fast repeated analysis. cache persists garbage collected explicitly cleared.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"","code":"calculateResolutionDepth(pairs, bin_size)  calculateGenomeCoverage(pairs, bin_size, min_contacts = 1000)  findOptimalResolution(   pairs,   min_bin = 1000,   max_bin = 5e+06,   target_coverage = 0.8,   min_contacts = 1000 )  readPairsCache(pairs_file)  calcResDepthChunked(pairs_file = NULL, bin_size, cache = NULL)  calcGenomeCovChunked(   pairs_file = NULL,   bin_size,   min_contacts = 1000,   cache = NULL )  findOptResChunked(   pairs_file = NULL,   min_bin = 1000,   max_bin = 5e+06,   target_coverage = 0.8,   min_contacts = 1000,   cache = NULL,   return_cache = FALSE )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"pairs Data frame columns: read_name, chrom1, pos1, chrom2, pos2. large files, use pairs_file instead. bin_size Integer. Bin size base pairs. min_contacts Integer. Minimum contacts per bin (default: 1000). min_bin Integer. Minimum bin size search (default: 1000). max_bin Integer. Maximum bin size search (default: 5000000). target_coverage Numeric (0-1). Target coverage fraction (default: 0.8). pairs_file Character path pairs file. cache External pointer readPairsCache(). Faster repeated operations. return_cache Logical. Return list bin size cache pointer (default: FALSE).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"calculateResolutionDepth(): Tibble chrom, bin, count. calculateGenomeCoverage(): Coverage fraction (bins ≥ min_contacts). findOptimalResolution(): Optimal bin size (integer). calcResDepthChunked(): , reads file chunks. calcGenomeCovChunked(): Coverage file. findOptResChunked(): Optimal resolution large files. external pointer cached data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"Analyzes Hi-C pairs determine optimal resolution. large files, use _chunked variants cache readPairsCache() speed.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution-depth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Resolution and Depth for Pairs Data — resolution-depth","text":"","code":"if (FALSE) { # \\dontrun{ pairs <- read.table(\"contact_matrix.txt\") depth_10kb <- calculateResolutionDepth(pairs, bin_size = 10000) coverage <- calculateGenomeCoverage(pairs, bin_size = 10000) opt_bin <- findOptimalResolution(pairs, target_coverage = 0.8)  # Large file with cache cache <- readPairsCache(\"contact_matrix.txt\") opt_bin <- findOptResChunked(cache = cache, target_coverage = 0.8) depth <- calcResDepthChunked(cache = cache, bin_size = opt_bin) } # }  if (FALSE) { # \\dontrun{ # Create cache once cache <- readPairsCache(\"data.pairs.gz\")  # Reuse cache for multiple operations depth1 <- calcResDepthChunked(cache = cache, bin_size = 10000) depth2 <- calcResDepthChunked(cache = cache, bin_size = 50000) coverage <- calcGenomeCovChunked(cache = cache, bin_size = 10000)  # Cache is automatically freed when R session ends # Or explicitly remove it: rm(cache) gc() } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution.html","id":null,"dir":"Reference","previous_headings":"","what":"Get resolution of ChromatinContacts object — resolution","title":"Get resolution of ChromatinContacts object — resolution","text":"Retrieves bin size base pairs.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get resolution of ChromatinContacts object — resolution","text":"","code":"resolution(x)  # S4 method for class 'ChromatinContacts' resolution(x)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get resolution of ChromatinContacts object — resolution","text":"x ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get resolution of ChromatinContacts object — resolution","text":"Integer (resolution bp) NULL.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/resolution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get resolution of ChromatinContacts object — resolution","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"sample.mcool\", resolution = 10000L) resolution(cc) # Returns 10000 } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale and transform Hi-C interaction data for visualization — scaleData","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"Transforms scales chromatin interaction data prepare visualization. Applies user-defined scaling functions (e.g., log transformation) interaction scores handles missing values.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"","code":"scaleData(data, scale_column, scale_method, remove_na = FALSE)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"data Input data one formats: ChromatinContacts object imported interactions GInteractions object score metadata data.frame tibble columns: seqnames1, start1, end1, seqnames2, start2, end2, plus score column scale_column Character. Name column containing values scale. Common options: \"balanced\": ICE-normalized counts (recommended) \"count\": raw contact counts numeric metadata column scale_method Function apply transformation. Common options: log10: log10 transformation (default Hi-C data) log2: log2 transformation log1p: log(x + 1) transformation (handles zeros) identity function(x) x: transformation Custom function: function takes numeric vector returns numeric vector remove_na Logical. Whether remove rows NA infinite values scaling (default: FALSE). Set TRUE remove missing data cause visualization issues.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"Tibble (data frame) standardized columns: seqnames1, start1, end1: First anchor coordinates seqnames2, start2, end2: Second anchor coordinates score: Transformed scaled values","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"processing-steps","dir":"Reference","previous_headings":"","what":"Processing steps","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"Convert input tibble format Apply scale_method function scale_column Create new score column transformed values Optionally remove NA/infinite values Squish extreme outliers prevent visualization artifacts","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"recommended-scaling","dir":"Reference","previous_headings":"","what":"Recommended scaling","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"typical Hi-C data visualization: Use \"balanced\" column log10 transformation Set remove_na = TRUE handle bins coverage","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"custom-transformations","dir":"Reference","previous_headings":"","what":"Custom transformations","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"can provide function scaling:","code":"# Square root transformation scaleData(cc, \"count\", sqrt)  # Custom transformation scaleData(cc, \"balanced\", function(x) log2(x + 0.1))"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/scaleData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale and transform Hi-C interaction data for visualization — scaleData","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data cc <- ChromatinContacts(\"file.cool\") |> import()  # Standard log10 scaling of balanced data scaled_data <- scaleData(cc, \"balanced\", log10)  # Raw counts without transformation scaled_raw <- scaleData(cc, \"count\", function(x) x)  # Log2 scaling with NA removal scaled_clean <- scaleData(cc, \"balanced\", log2, remove_na = TRUE)  # Use with plotting library(ggplot2) ggplot() +   geom_hic(data = scaleData(cc, \"balanced\", log10),            aes(seqnames1 = seqnames1, start1 = start1, end1 = end1,                seqnames2 = seqnames2, start2 = start2, end2 = end2,                fill = score)) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":null,"dir":"Reference","previous_headings":"","what":"Select top hyperedges for visualization — select","title":"Select top hyperedges for visualization — select","text":"Selects top-weighted intra- inter-chromosomal hyperedges per chromosome visualization.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select top hyperedges for visualization — select","text":"","code":"select(x, ...)  # S4 method for class 'MultiWayContacts' select(   x,   n_intra = 5,   n_inter = 5,   n_multiways_filter = NULL,   chroms = NULL,   append = TRUE,   ... )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select top hyperedges for visualization — select","text":"x MultiWayContacts tidied hypergraph. ... Additional arguments (used). n_intra Integer. Top intra-chromosomal hyperedges per chromosome (default: 5). n_inter Integer. Top inter-chromosomal hyperedges per chromosome (default: 5). Quota increases fewer intra hyperedges available. n_multiways_filter Integer vector NULL. Filter specific contact orders, e.g., c(3,4) 3-way 4-way (default: NULL). chroms Character NULL. Filter chromosome(s) (default: NULL). append Logical. Append existing selection (TRUE) replace (FALSE, default: TRUE).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select top hyperedges for visualization — select","text":"MultiWayContacts select_hypergraph slot containing selected hyperedges plus type (intra/inter) source_chrom columns.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select top hyperedges for visualization — select","text":"Per chromosome: select top n_intra intra-chromosomal n_inter inter-chromosomal hyperedges weight. insufficient intra hyperedges, quota transferred inter. Hyperedges deduplicated across chromosomes.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/select.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select top hyperedges for visualization — select","text":"","code":"if (FALSE) { # \\dontrun{ # Default: top 5 intra + 5 inter per chromosome mc <- MultiWayContacts(\"sample.pairs.gz\") |>   import() |> build() |> tidy() |> select()  # More hyperedges mc <- mc |> select(n_intra = 10, n_inter = 10, append = FALSE)  # Filter by contact order mc <- mc |> select(n_multiways_filter = c(3, 4), append = FALSE)  # Specific chromosomes mc <- mc |> select(chroms = c(\"chr1\", \"chr2\"), append = FALSE) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/seqinfo-ChromatinContacts-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Get sequence information — seqinfo,ChromatinContacts-method","title":"Get sequence information — seqinfo,ChromatinContacts-method","text":"Retrieves chromosome/sequence information.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/seqinfo-ChromatinContacts-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get sequence information — seqinfo,ChromatinContacts-method","text":"","code":"# S4 method for class 'ChromatinContacts' seqinfo(x)"},{"path":"https://jasonwong-lab.github.io/gghic/reference/seqinfo-ChromatinContacts-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get sequence information — seqinfo,ChromatinContacts-method","text":"x ChromatinContacts object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/seqinfo-ChromatinContacts-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get sequence information — seqinfo,ChromatinContacts-method","text":"Seqinfo object.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/seqinfo-ChromatinContacts-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get sequence information — seqinfo,ChromatinContacts-method","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"sample.cool\") seqinfo(cc) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset ChromatinContacts objects by various criteria — subset-methods","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"Flexibly subset ChromatinContacts objects using multiple indexing methods: numeric indices, logical vectors, character strings (genomic regions), GRanges, GInteractions. attached genomic features (TADs, loops, tracks) automatically filtered match subset.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"","code":"# S4 method for class 'ChromatinContacts,numeric' subsetByOverlaps(x, ranges)  # S4 method for class 'ChromatinContacts,logical' subsetByOverlaps(x, ranges)  # S4 method for class 'ChromatinContacts,GRanges' subsetByOverlaps(x, ranges, type = c(\"within\", \"any\"))  # S4 method for class 'ChromatinContacts,GInteractions' subsetByOverlaps(x, ranges)  # S4 method for class 'ChromatinContacts,numeric,ANY,ANY' x[i]  # S4 method for class 'ChromatinContacts,logical,ANY,ANY' x[i]  # S4 method for class 'ChromatinContacts,GRanges,ANY,ANY' x[i, j, ..., drop = TRUE]  # S4 method for class 'ChromatinContacts,GInteractions,ANY,ANY' x[i]  # S4 method for class 'ChromatinContacts,character,ANY,ANY' x[i]"},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"x ChromatinContacts object. ranges subsetByOverlaps: GRanges, GInteractions, numeric, logical vector subset . type Character string specifying overlap type GRanges subsetting. Can \"within\" \"\". Default \"\". Index, logical vector, character (region string), GRanges, GInteractions subsetting. j, drop Ignored. Included S4 compatibility. ... Additional arguments passed subsetting methods.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"subsetted ChromatinContacts object. Features (TADs, loops, tracks) automatically subsetted match new interaction data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"Subsetting methods: Numeric: Select interactions index Logical: Select interactions matching TRUE values Character: Specify genomic region(s) strings (e.g., \"chr1\" \"chr1:1000000-2000000\") GRanges: Select interactions overlapping ranges GInteractions: Select interactions overlapping interaction pairs methods automatically update: interactions slot focus slot attached features (TADs, loops, tracks, etc.)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/subset-methods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset ChromatinContacts objects by various criteria — subset-methods","text":"","code":"if (FALSE) { # \\dontrun{ # Load Hi-C data with features cc <- ChromatinContacts(\"sample.cool\") |> import() features(cc, \"TADs\") <- rtracklayer::import(\"tads.bed\") features(cc, \"loops\") <- loops_gi  # Subset by character region string cc_chr1 <- cc[\"chr1\"]  # Entire chromosome cc_region <- cc[\"chr1:1000000-5000000\"]  # Specific region cc_multi <- cc[\"chr1|chr2\"]  # Multiple regions  # Subset by numeric index cc_first_1000 <- cc[1:1000]  # First 1000 interactions  # Subset by logical vector gis <- interactions(cc) high_counts <- gis$count > 100 cc_high <- cc[high_counts]  # Only high-count interactions  # Subset by GRanges region_gr <- GRanges(\"chr1:1000000-2000000\") cc_overlap <- cc[region_gr]  # Interactions overlapping region  # Subset by GInteractions specific_pairs <- GInteractions(   GRanges(\"chr1:1000000-1100000\"),   GRanges(\"chr1:2000000-2100000\") ) cc_pairs <- cc[specific_pairs]  # All features are automatically subset length(features(cc, \"TADs\"))  # Original TAD count length(features(cc_chr1, \"TADs\"))  # Fewer TADs after subsetting  # By GRanges roi <- GRanges(\"chr1:1000000-5000000\") cc_sub <- cc[roi]  # By GInteractions query_gi <- GInteractions(   GRanges(\"chr1:1000000-2000000\"),   GRanges(\"chr1:3000000-4000000\") ) cc_sub <- cc[query_gi] } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"Creates clean, publication-ready theme Hi-C visualization optimized defaults: hidden y-axis, fixed coordinate ratio, custom color gradient. Provides fine control axis formatting limits.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"","code":"theme_hic(   hide_y = TRUE,   coord_ratio = 1,   scale_fill_gradientn = TRUE,   breaks = ggplot2::waiver(),   labels = scales::unit_format(unit = \"M\", scale = 1e-06),   xmin = NULL,   xmax = NULL,   expand_x = c(0, 0) )"},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"hide_y Logical. Hide y-axis elements (axis title, text, ticks) (default: TRUE). Y-axis typically uninformative Hi-C plots. coord_ratio Numeric. Aspect ratio ggplot2::coord_fixed(). 1 maintains equal x/y scaling (default: 1). scale_fill_gradientn Logical. Apply custom Hi-C color gradient (white → yellow → orange → red → black) (default: TRUE). Set FALSE use custom scales. breaks Numeric vector ggplot2::waiver(). X-axis break positions ggplot2::scale_x_continuous(). Default uses automatic breaks. labels Function character vector. X-axis label formatter. Default displays genomic coordinates megabases (e.g., \"10M\" 10,000,000 bp). xmin Numeric NULL. Minimum x-axis limit. NULL, uses data range (default: NULL). xmax Numeric NULL. Maximum x-axis limit. NULL, uses data range (default: NULL). expand_x Numeric vector (length 2). X-axis expansion plot units: c(left_expansion, right_expansion) (default: c(0, 0) expansion).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"List ggplot2 theme elements scales can added ggplot object.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"theme-components","dir":"Reference","previous_headings":"","what":"Theme components","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"Based theme_bw() minimal grid lines Hidden y-axis (configurable) Fixed 1:1 coordinate ratio accurate distance representation Custom color gradient optimized Hi-C data Genomic coordinate formatting (Mb units)","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"color-gradient","dir":"Reference","previous_headings":"","what":"Color gradient","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"default gradient transitions 13 colors white (contacts) black (maximum contacts), providing excellent dynamic range typical Hi-C data.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"customization","dir":"Reference","previous_headings":"","what":"Customization","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"Combine ggplot2 theme elements additional customization:","code":"gghic(cc) + theme_hic() + theme(text = element_text(size = 14))"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/reference/theme_hic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 theme optimized for Hi-C contact maps — theme_hic","text":"","code":"if (FALSE) { # \\dontrun{ cc <- ChromatinContacts(\"file.cool\", focus = \"chr4\") |> import()  # Basic usage with default theme gghic(cc) + theme_hic()  # Custom color scale gghic(cc) +   theme_hic(scale_fill_gradientn = FALSE) +   scale_fill_viridis_c()  # Show y-axis gghic(cc) + theme_hic(hide_y = FALSE)  # Custom axis limits and breaks gghic(cc) +   theme_hic(     xmin = 1e6,     xmax = 5e6,     breaks = seq(1e6, 5e6, by = 1e6)   )  # Custom axis labels (show kb instead of Mb) gghic(cc) +   theme_hic(labels = scales::unit_format(unit = \"kb\", scale = 1e-3)) } # }"},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy hypergraph to long format — tidy","title":"Tidy hypergraph to long format — tidy","text":"Converts hypergraph incidence matrix long-format data frame analysis visualization.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy hypergraph to long format — tidy","text":"","code":"tidy(x, ...)  # S4 method for class 'MultiWayContacts' tidy(x, max_hyperedges = NULL, weight_normalization = \"none\")"},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy hypergraph to long format — tidy","text":"x MultiWayContacts built hypergraph. ... Additional arguments (used). max_hyperedges Integer NULL. Maximum hyperedges include (default: NULL ). Selects top contact order. weight_normalization Character. Weight scheme: \"none\" (raw), \"log\", \"by_order\", \"minmax\" (default: \"none\").","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy hypergraph to long format — tidy","text":"MultiWayContacts tidied_hypergraph slot containing: bin_idx, hyperedge_idx, bin_id, chrom, bin, n_multiways, weight.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tidy hypergraph to long format — tidy","text":"Converts sparse matrix long format. max_hyperedges set, ranks contact order retains top N. Unused bins removed.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/reference/tidy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tidy hypergraph to long format — tidy","text":"","code":"if (FALSE) { # \\dontrun{ # Tidy all with raw weights mc <- MultiWayContacts(\"sample.pairs.gz\") |> import() |> build() |> tidy()  # Top 100 with log weights mc <- mc |> tidy(max_hyperedges = 100, weight_normalization = \"log\") } # }"},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"major-changes-0-2-1","dir":"Changelog","previous_headings":"","what":"Major Changes","title":"gghic 0.2.1","text":"buildHypergraph() now generic S4 method build() methods MultiWayContacts objects. tidyHypergraph() replaced S4 generic tidy() method. selectHypergraph() replaced S4 generic select() method. methods support method dispatch MultiWayContacts class. Maintains backward compatibility consistent API design. Added show() method MultiWayContacts class providing informative object summaries.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"documentation-improvements-0-2-1","dir":"Changelog","previous_headings":"","what":"Documentation Improvements","title":"gghic 0.2.1","text":"Added detailed @details sections explaining algorithms, workflows, technical considerations. Expanded @param descriptions valid options, defaults, usage guidance. Included 8-12 practical examples per major function covering common use cases. Added @seealso cross-references linking related functions. geom_hic(): Added coordinate system explanation, transformation details, scaling algorithms. geom_loop() geom_loop2(): Detailed BEDPE format specification, styling options. geom_tad() geom_tad2(): Comprehensive boundary visualization guidance. geom_track() geom_track2(): File format support, scaling strategies, comparison table. geom_annotation(): Gene model visualization, GTF parsing, style comparison. geom_concatemer() geom_concatemer2(): Multi-way contact representation. geom_hypergraph(): Network visualization workflow layout algorithms. geom_ideogram(): Cytogenetic band display, genome assembly support. geom_hic_under(): Inverted heatmap visualization comparative displays. scaleData(): Transformation functions (log, asinh, sqrt) mathematical formulas. S4 classes methods: Comprehensive slot descriptions usage examples.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"bug-fixes-0-2-1","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"gghic 0.2.1","text":"Fixed unresolved roxygen2 link setters-methods.R (changed [import()] [import-ChromatinContacts]).","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"internal-changes-0-2-1","dir":"Changelog","previous_headings":"","what":"Internal Changes","title":"gghic 0.2.1","text":"Improved consistency function naming parameter conventions. Enhanced code organization hypergraph workflow methods.","code":""},{"path":[]},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"major-changes-0-2-0","dir":"Changelog","previous_headings":"","what":"Major Changes","title":"gghic 0.2.0","text":"New import() methods loading data Cooler files. Setter methods assigning genomic features (TADs, loops, tracks, compartments). Comprehensive subsetting methods supporting numeric, logical, character, GRanges, GInteractions indexing. Enhanced show() method better object summaries.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"new-features-0-2-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"gghic 0.2.0","text":"Multi-way Contact Visualization: Added geom_hypergraph() visualizing Pore-C/-like multi-way chromatin interactions. Lower Triangle Plots: New geom_hic_under() plotting flipped Hi-C heatmaps diagonal. Resolution Depth Analysis: Implemented C-based resolution depth calculation caching support improved performance. Pairs File Support: Added readPairsCache() reading caching pairs files filtering capabilities. Concatemer Conversion: New concatemers2Gis() function convert concatemer reads GInteractions.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"performance-improvements-0-2-0","dir":"Changelog","previous_headings":"","what":"Performance Improvements","title":"gghic 0.2.0","text":"Implemented C code resolution depth calculations hash table-based bin tracking. Added comprehensive caching system resolution depth calculations. Memory-efficient pairs file /O filtering support.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"documentation-0-2-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"gghic 0.2.0","text":"Added comprehensive hypergraph vignette multi-way contact analysis. Enhanced main vignette improved workflow examples data loading. Refactored depth vignette better caching explanations. Updated pkgdown website better navigation feature descriptions.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"enhancements-0-2-0","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"gghic 0.2.0","text":"Refactored geom_* functions consistent parameter handling. Added renameGeomAes() utility remapping ggplot2 aesthetics (source: https://github.com/clauswilke/relayer). Better error messages validation throughout.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"internal-changes-0-2-0","dir":"Changelog","previous_headings":"","what":"Internal Changes","title":"gghic 0.2.0","text":"Refactored utility functions consistent naming conventions. Added Makevars compiler flags C code compilation.","code":""},{"path":"https://jasonwong-lab.github.io/gghic/news/index.html","id":"gghic-010","dir":"Changelog","previous_headings":"","what":"gghic 0.1.0","title":"gghic 0.1.0","text":"Added core functionalities visualising genomic interaction data. Integrated ggplot2 flexible customisable plotting. Included support heatmaps, chromosome ideograms, gene tracks, genomic data tracks.","code":""}]
