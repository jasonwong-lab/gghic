% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hypergraph.R
\name{buildHypergraph}
\alias{buildHypergraph}
\title{Build Hypergraph from Multi-way Contacts}
\usage{
buildHypergraph(
  pairs = NULL,
  pairs_file = NULL,
  bin_size,
  chrom = NULL,
  min_contacts = NULL,
  quantile = 0.85,
  min_multiway = 3,
  inter_chrom = FALSE
)
}
\arguments{
\item{pairs}{A data frame or tibble with columns:
\code{read_name}, \code{chrom1}, \code{pos1}, \code{chrom2}, \code{pos2}.
For large files, use \code{pairs_file} instead.}

\item{pairs_file}{Character path to pairs file for chunked reading.}

\item{bin_size}{Integer bin size in base pairs.}

\item{chrom}{Character chromosome name(s) to analyze (e.g., "chr22" or
c("chr21", "chr22")). Use NULL for genome-wide analysis. Default: NULL.}

\item{min_contacts}{Integer minimum number of contacts per bin pair.
Filters out sparse pairwise interactions. Default: NULL (no filtering).}

\item{quantile}{Numeric quantile threshold (0-1) for filtering pairwise
contacts. Keeps only bin pairs above this quantile. Default: 0.85.}

\item{min_multiway}{Integer minimum number of bins a read must contact
to be included in hypergraph. Default: 3.}

\item{inter_chrom}{Logical, whether to include inter-chromosomal contacts.
When FALSE, only intra-chromosomal contacts are kept.
When TRUE and multiple
chromosomes are specified in \code{chrom}, includes both intra- and inter-
chromosomal contacts between the specified chromosomes only (not with other
chromosomes in the genome). Default: FALSE (intra-chromosomal only).}
}
\value{
A list with class "hypergraph" containing:
\item{incidence}{Sparse incidence matrix (bins x reads)}
\item{bins}{Integer vector of bin IDs (sorted)}
\item{reads}{Character vector of read names}
\item{contacts_per_read}{Integer vector of contact counts per read}
\item{bin_size}{The bin size used}
\item{chrom}{The chromosome analyzed}
}
\description{
Analyze multi-way contacts from Pore-C/HiPore-C data by constructing
hypergraph representations where genomic bins are nodes and reads are
hyperedges connecting multiple bins.
}
\details{
The function performs the following steps:
\enumerate{
\item Bins genomic positions into fixed-size bins
\item Removes duplicate pairwise contacts within each read
\item Filters bin pairs by count quantile or minimum threshold
\item Constructs incidence matrix (bins as rows, reads as columns)
\item Filters reads by minimum multi-way contact degree
}

The resulting hypergraph can be visualized with \code{geom_hypergraph()}.
}
\examples{
\dontrun{
# Build hypergraph from pairs data
hg <- buildHypergraph(
  pairs = pairs_df,
  bin_size = 100000,
  chrom = "chr22",
  quantile = 0.85,
  min_multiway = 3
)

# From large file
hg <- buildHypergraph(
  pairs_file = "contact_matrix.txt",
  bin_size = 100000,
  chrom = "chr22"
)

# Multi-chromosome with inter-chromosomal contacts
hg <- buildHypergraph(
  pairs = pairs_df,
  bin_size = 100000,
  chrom = c("chr21", "chr22"),
  inter_chrom = TRUE
)

# Genome-wide with inter-chromosomal contacts
hg <- buildHypergraph(
  pairs = pairs_df,
  bin_size = 100000,
  chrom = NULL,
  inter_chrom = TRUE
)

# Visualize
plotHypergraph(hg)
}
}
