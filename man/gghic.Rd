% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gghic-methods.R
\name{gghic}
\alias{gghic}
\alias{gghic,ChromatinContacts-method}
\alias{gghic,data.frame-method}
\alias{gghic,GInteractions-method}
\title{Create Hi-C visualization plot}
\usage{
\S4method{gghic}{ChromatinContacts}(
  x,
  scale_method = log10,
  ideogram = FALSE,
  ideogram_width_ratio = 1/30,
  ideogram_fontsize = 10,
  ideogram_colour = "red",
  ideogram_fill = "#FFE3E680",
  annotation = FALSE,
  annotation_style = "basic",
  annotation_width_ratio = 1/50,
  annotation_spacing_ratio = 1/3,
  annotation_fontsize = 10,
  annotation_colour = "#48CFCB",
  annotation_fill = "#48CFCB",
  track = FALSE,
  track_width_ratio = 1/20,
  track_spacing_ratio = 1/2,
  track_fill = "black",
  track_fontsize = 5,
  tad = FALSE,
  tad_colour = "grey",
  loop = FALSE,
  loop_style = "circle",
  loop_colour = "black",
  loop_fill = NA,
  concatemer = FALSE,
  concatemer_width_ratio = 1/100,
  concatemer_spacing_ratio = 1/5,
  expand_xaxis = FALSE,
  expand_left = NULL,
  expand_right = NULL,
  ...
)

\S4method{gghic}{data.frame}(
  x,
  scale_column = "balanced",
  scale_method = log10,
  ideogram = FALSE,
  ideogram_width_ratio = 1/30,
  ideogram_fontsize = 10,
  ideogram_colour = "red",
  ideogram_fill = "#FFE3E680",
  annotation = FALSE,
  annotation_style = "basic",
  annotation_width_ratio = 1/50,
  annotation_spacing_ratio = 1/3,
  annotation_fontsize = 10,
  annotation_colour = "#48CFCB",
  annotation_fill = "#48CFCB",
  track = FALSE,
  track_width_ratio = 1/20,
  track_spacing_ratio = 1/2,
  track_fill = "black",
  track_fontsize = 5,
  tad = FALSE,
  tad_is_0_based = FALSE,
  tad_colour = "grey",
  loop = FALSE,
  loop_style = "circle",
  loop_is_0_based = FALSE,
  loop_colour = "black",
  loop_fill = NA,
  concatemer = FALSE,
  concatemer_width_ratio = 1/100,
  concatemer_spacing_ratio = 1/5,
  expand_xaxis = FALSE,
  expand_left = NULL,
  expand_right = NULL,
  ...
)

\S4method{gghic}{GInteractions}(
  x,
  scale_column = "balanced",
  scale_method = log10,
  ideogram = FALSE,
  ideogram_width_ratio = 1/30,
  ideogram_fontsize = 10,
  ideogram_colour = "red",
  ideogram_fill = "#FFE3E680",
  annotation = FALSE,
  annotation_style = "basic",
  annotation_width_ratio = 1/50,
  annotation_spacing_ratio = 1/3,
  annotation_fontsize = 10,
  annotation_colour = "#48CFCB",
  annotation_fill = "#48CFCB",
  track = FALSE,
  track_width_ratio = 1/20,
  track_spacing_ratio = 1/2,
  track_fill = "black",
  track_fontsize = 5,
  tad = FALSE,
  tad_is_0_based = FALSE,
  tad_colour = "grey",
  loop = FALSE,
  loop_style = "circle",
  loop_is_0_based = FALSE,
  loop_colour = "black",
  loop_fill = NA,
  concatemer = FALSE,
  concatemer_width_ratio = 1/100,
  concatemer_spacing_ratio = 1/5,
  expand_xaxis = FALSE,
  expand_left = NULL,
  expand_right = NULL,
  ...
)
}
\arguments{
\item{x}{A \code{ChromatinContacts} object with imported interaction data, or a
\code{GInteractions} object, or a \code{data.frame}/\code{tibble} with interaction data.}

\item{scale_method}{Function to apply for data transformation. Common
choices: \code{log10} (default), \code{log2}, \code{function(x) x} (no transformation).}

\item{ideogram}{Logical. Add chromosome ideogram track. Default is \code{FALSE}.}

\item{ideogram_width_ratio}{Numeric. Height of ideogram relative to heatmap
height. Default is \code{1/30}.}

\item{ideogram_fontsize}{Numeric. Font size for ideogram labels. Default is
\code{10}.}

\item{ideogram_colour}{Character. Color for highlighted region on ideogram.
Default is \code{"red"}.}

\item{ideogram_fill}{Character. Fill color for highlighted region. Default
is \code{"#FFE3E680"} (transparent red).}

\item{annotation}{Logical. Add gene annotation track. Requires \code{gtf_path} in
\code{...}. Default is \code{FALSE}.}

\item{annotation_style}{Character. Style for gene annotation: \code{"basic"} or
\code{"arrow"}. Default is \code{"basic"}.}

\item{annotation_width_ratio}{Numeric. Height of annotation track relative
to heatmap. Default is \code{1/50}.}

\item{annotation_spacing_ratio}{Numeric. Spacing between genes. Default is
\code{1/3}.}

\item{annotation_fontsize}{Numeric. Font size for gene labels. Default is
\code{10}.}

\item{annotation_colour}{Character. Color for gene features. Default is
\code{"#48CFCB"}.}

\item{annotation_fill}{Character. Fill color for gene features. Default is
\code{"#48CFCB"}.}

\item{track}{Logical. Add genomic signal tracks (e.g., ChIP-seq). Requires
\code{tracks} in the \code{ChromatinContacts} object or \code{data_paths} in \code{...}.
Default is \code{FALSE}.}

\item{track_width_ratio}{Numeric. Height of track area relative to heatmap.
Default is \code{1/20}.}

\item{track_spacing_ratio}{Numeric. Spacing between multiple tracks. Default
is \code{1/2}.}

\item{track_fill}{Character or vector. Colors for track signals. Default is
\code{"black"}.}

\item{track_fontsize}{Numeric. Font size for track labels. Default is \code{5}.}

\item{tad}{Logical. Add TAD (topologically associating domain) boundaries.
Requires \code{TADs} in the \code{ChromatinContacts} object or \code{tad_path} in \code{...}.
Default is \code{FALSE}.}

\item{tad_colour}{Character. Color for TAD boundaries. Default is \code{"grey"}.}

\item{loop}{Logical. Add chromatin loop arcs. Requires \code{loops} in the
\code{ChromatinContacts} object or \code{loop_path} in \code{...}. Default is \code{FALSE}.}

\item{loop_style}{Character. Style for loops: \code{"circle"} or \code{"arc"}.
Default is \code{"circle"}.}

\item{loop_colour}{Character. Color for loop arcs. Default is \code{"black"}.}

\item{loop_fill}{Fill color for loop arcs. Default is \code{NA}.}

\item{concatemer}{Logical. Add concatemer visualization for multi-way
contacts. Requires \code{multi_contacts} in object. Default is \code{FALSE}.}

\item{concatemer_width_ratio}{Numeric. Height of concatemer track. Default
is \code{1/100}.}

\item{concatemer_spacing_ratio}{Numeric. Spacing between concatemers.
Default is \code{1/5}.}

\item{expand_xaxis}{Logical. Expand x-axis to show full chromosome context.
Default is \code{FALSE}.}

\item{expand_left}{Numeric. Left expansion in base pairs.
If \code{NULL} (default),
uses 10× resolution.}

\item{expand_right}{Numeric. Right expansion in base pairs. If \code{NULL}
(default), uses 10× resolution.}

\item{...}{Additional arguments passed to individual geom functions:
\itemize{
\item For \code{geom_ideogram()}: \code{genome}, \code{highlight}, \code{length_ratio}
\item For \code{geom_annotation()}: \code{gtf_path}, \code{style}, \code{maxgap}, \code{gene_symbols},
\code{include_ncrna}
\item For \code{geom_track()}: \code{data_paths}, \code{data_range}, \code{rasterize}
\item For \code{geom_tad()}: \code{tad_path} (path to BED file), \code{tad_is_0_based}
(logical, default TRUE), \code{stroke}
\item For \code{geom_loop()}: \code{loop_path} (path to BEDPE file), \code{loop_is_0_based}
(logical, default TRUE), \code{stroke}
\item For \code{geom_hic()}: \code{draw_boundary}, \code{rasterize}
}}

\item{scale_column}{Character string. Name of the column to use for scaling
(e.g., \code{"balanced"}, \code{"count"}). Used when input is \code{GInteractions} or
\code{data.frame}.}

\item{tad_is_0_based}{Logical. Whether TAD coordinates are 0-based. Default
is \code{TRUE}.}

\item{loop_is_0_based}{Logical. Whether loop coordinates are 0-based. Default
is \code{TRUE}.}
}
\value{
A \code{ggplot2} object that can be further customized with additional
ggplot2 layers and functions.
}
\description{
High-level wrapper function to create publication-ready Hi-C contact map
visualizations with optional genomic features. Automatically handles data
transformation, feature integration, and theme application.
}
\details{
\code{gghic()} provides a high-level interface for creating Hi-C visualizations.
It automatically:
\itemize{
\item Scales interaction data using the specified method
\item Applies appropriate coordinate transformations
\item Integrates genomic features from the \code{ChromatinContacts} object
\item Sets up axis labels and breaks
\item Applies a clean default theme
}

\strong{For more control}, use individual \verb{geom_*()} functions with \code{ggplot2}:
\itemize{
\item \code{geom_hic()} - Base heatmap layer
\item \code{geom_ideogram()} - Chromosome ideogram
\item \code{geom_annotation()} - Gene annotations
\item \code{geom_track()} - Genomic signal tracks
\item \code{geom_tad()} - TAD boundaries
\item \code{geom_loop()} - Chromatin loops
\item \code{geom_concatemer()} - Multi-way contacts
}
}
\examples{
\dontrun{
# === Basic Usage ===

# Load and visualize Hi-C data
cc <- ChromatinContacts("path/to/cooler.cool") |>
  import()
gghic(cc)

# Focus on specific region
cc["chr4:0-50000000"] |>
  gghic()

# === With Ideogram ===

# Add chromosome ideogram for context
gghic(cc, ideogram = TRUE, genome = "hg19")

# Customize ideogram appearance
gghic(cc,
  ideogram = TRUE,
  ideogram_width_ratio = 1/25,
  ideogram_colour = "blue",
  ideogram_fill = "#ADD8E680"
)

# === Adding Genomic Features ===

# Add TAD boundaries
tad_file <- "path/to/tads.bed"
gghic(cc, tad = TRUE, tad_path = tad_file, tad_colour = "darkgreen")

# Add chromatin loops
loop_file <- "path/to/loops.bedpe"
gghic(cc, loop = TRUE, loop_path = loop_file, loop_colour = "red")

# Add signal tracks (e.g., ChIP-seq)
track1 <- "path/to/track1.bw"
track2 <- "path/to/track2.bw"
tracks <- GRangesList(
  H3K27ac_rep1 = rtracklayer::import(track1),
  H3K27ac_rep2 = rtracklayer::import(track2)
)
features(cc, "tracks") <- tracks

gghic(cc, track = TRUE, track_fill = c("blue", "red"))

# === Axis Expansion ===

# Expand x-axis to show genomic context
gghic(
  cc,
  expand_xaxis = TRUE,
  expand_left = 1e6,   # Extend 1 Mb to the left
  expand_right = 1e6   # Extend 1 Mb to the right
)
}
}
\seealso{
\itemize{
\item \link{ChromatinContacts} - Main data class
\item \code{\link[=geom_hic]{geom_hic()}} - Base heatmap layer
\item \code{\link[=theme_hic]{theme_hic()}} - Default theme
\item \code{\link[=scaleData]{scaleData()}} - Data transformation
}
}
