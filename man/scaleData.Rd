% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gghic-methods.R
\name{scaleData}
\alias{scaleData}
\title{Scale and transform Hi-C interaction data for visualization}
\usage{
scaleData(data, scale_column, scale_method, remove_na = FALSE)
}
\arguments{
\item{data}{Input data in one of these formats:
\itemize{
\item ChromatinContacts object with imported interactions
\item GInteractions object with score metadata
\item data.frame or tibble with columns: seqnames1, start1, end1, seqnames2,
start2, end2, plus score column
}}

\item{scale_column}{Character. Name of column containing values to scale.
Common options:
\itemize{
\item \code{"balanced"}: ICE-normalized counts (recommended)
\item \code{"count"}: raw contact counts
\item Any other numeric metadata column
}}

\item{scale_method}{Function to apply for transformation. Common options:
\itemize{
\item \code{log10}: log10 transformation (default for most Hi-C data)
\item \code{log2}: log2 transformation
\item \code{log1p}: log(x + 1) transformation (handles zeros)
\item \code{identity} or \code{function(x) x}: no transformation
\item Custom function: any function that takes numeric vector and returns
numeric vector
}}

\item{remove_na}{Logical. Whether to remove rows with NA or infinite values
after scaling (default: FALSE). Set TRUE to remove missing data that could
cause visualization issues.}
}
\value{
Tibble (data frame) with standardized columns:
\itemize{
\item \code{seqnames1}, \code{start1}, \code{end1}: First anchor coordinates
\item \code{seqnames2}, \code{start2}, \code{end2}: Second anchor coordinates
\item \code{score}: Transformed and scaled values
}
}
\description{
Transforms and scales chromatin interaction data to prepare it for
visualization. Applies user-defined scaling functions (e.g., log
transformation) to interaction scores and handles missing values.
}
\details{
\subsection{Processing steps}{
\enumerate{
\item Convert input to tibble format
\item Apply \code{scale_method} function to \code{scale_column}
\item Create new \code{score} column with transformed values
\item Optionally remove NA/infinite values
\item Squish extreme outliers to prevent visualization artifacts
}
}

\subsection{Recommended scaling}{

For typical Hi-C data visualization:
\itemize{
\item Use \code{"balanced"} column with \code{log10} transformation
\item Set \code{remove_na = TRUE} to handle bins with no coverage
}
}

\subsection{Custom transformations}{

You can provide any function for scaling:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{# Square root transformation
scaleData(cc, "count", sqrt)

# Custom transformation
scaleData(cc, "balanced", function(x) log2(x + 0.1))
}\if{html}{\out{</div>}}
}
}
\examples{
\dontrun{
# Load Hi-C data
cc <- ChromatinContacts("file.cool") |> import()

# Standard log10 scaling of balanced data
scaled_data <- scaleData(cc, "balanced", log10)

# Raw counts without transformation
scaled_raw <- scaleData(cc, "count", function(x) x)

# Log2 scaling with NA removal
scaled_clean <- scaleData(cc, "balanced", log2, remove_na = TRUE)

# Use with plotting
library(ggplot2)
ggplot() +
  geom_hic(data = scaleData(cc, "balanced", log10),
           aes(seqnames1 = seqnames1, start1 = start1, end1 = end1,
               seqnames2 = seqnames2, start2 = start2, end2 = end2,
               fill = score))
}

}
\seealso{
\code{\link[=gghic]{gghic()}}, \code{\link[=geom_hic]{geom_hic()}}, \code{\link[=ChromatinContacts]{ChromatinContacts()}}
}
